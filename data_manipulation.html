<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="A side-by-side comparison of polars, R base, dplyr, tidyr and data.table packages.">

<title>Cookbook Polars for R - 2&nbsp; Data manipulation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./import_export.html" rel="next">
<link href="./first_steps.html" rel="prev">
<link href="./logo_cookbook_rpolars.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="custom.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./data_manipulation.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data manipulation</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./logo_cookbook_rpolars.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Cookbook Polars for R</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/ddotta/cookbook-rpolars/tree/main/book/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./first_steps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">First steps with Polars</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_manipulation.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data manipulation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./import_export.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Import/Export</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lazy_execution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Lazy execution</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./benchmarking.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Benchmarking</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction-to-methods" id="toc-introduction-to-methods" class="nav-link active" data-scroll-target="#introduction-to-methods"><span class="header-section-number">2.1</span> Introduction to methods</a></li>
  <li><a href="#conversion-between-seriesdataframes-and-vectordata.frames" id="toc-conversion-between-seriesdataframes-and-vectordata.frames" class="nav-link" data-scroll-target="#conversion-between-seriesdataframes-and-vectordata.frames"><span class="header-section-number">2.2</span> Conversion between Series/DataFrames and vector/data.frames</a>
  <ul class="collapse">
  <li><a href="#from-vectordata.frames-to-seriesdataframes" id="toc-from-vectordata.frames-to-seriesdataframes" class="nav-link" data-scroll-target="#from-vectordata.frames-to-seriesdataframes"><span class="header-section-number">2.2.1</span> From vector/data.frames to Series/DataFrames</a></li>
  <li><a href="#from-seriesdataframes-to-vectordata.frames" id="toc-from-seriesdataframes-to-vectordata.frames" class="nav-link" data-scroll-target="#from-seriesdataframes-to-vectordata.frames"><span class="header-section-number">2.2.2</span> From Series/DataFrames to vector/data.frames</a></li>
  </ul></li>
  <li><a href="#initial-informations-on-a-dataframe" id="toc-initial-informations-on-a-dataframe" class="nav-link" data-scroll-target="#initial-informations-on-a-dataframe"><span class="header-section-number">2.3</span> Initial informations on a DataFrame</a>
  <ul class="collapse">
  <li><a href="#get-the-schema" id="toc-get-the-schema" class="nav-link" data-scroll-target="#get-the-schema"><span class="header-section-number">2.3.1</span> Get the schema</a></li>
  <li><a href="#get-the-dimensions" id="toc-get-the-dimensions" class="nav-link" data-scroll-target="#get-the-dimensions"><span class="header-section-number">2.3.2</span> Get the dimensions</a></li>
  <li><a href="#get-columns-types" id="toc-get-columns-types" class="nav-link" data-scroll-target="#get-columns-types"><span class="header-section-number">2.3.3</span> Get columns types</a></li>
  <li><a href="#get-a-glimpse" id="toc-get-a-glimpse" class="nav-link" data-scroll-target="#get-a-glimpse"><span class="header-section-number">2.3.4</span> Get a glimpse</a></li>
  <li><a href="#get-summary-statistics" id="toc-get-summary-statistics" class="nav-link" data-scroll-target="#get-summary-statistics"><span class="header-section-number">2.3.5</span> Get summary statistics</a></li>
  <li><a href="#get-the-rows-number" id="toc-get-the-rows-number" class="nav-link" data-scroll-target="#get-the-rows-number"><span class="header-section-number">2.3.6</span> Get the rows number</a></li>
  <li><a href="#get-the-columns-number" id="toc-get-the-columns-number" class="nav-link" data-scroll-target="#get-the-columns-number"><span class="header-section-number">2.3.7</span> Get the columns number</a></li>
  <li><a href="#get-the-columns-names" id="toc-get-the-columns-names" class="nav-link" data-scroll-target="#get-the-columns-names"><span class="header-section-number">2.3.8</span> Get the columns names</a></li>
  <li><a href="#rename-columns" id="toc-rename-columns" class="nav-link" data-scroll-target="#rename-columns"><span class="header-section-number">2.3.9</span> Rename columns</a></li>
  <li><a href="#get-the-first-n-rows" id="toc-get-the-first-n-rows" class="nav-link" data-scroll-target="#get-the-first-n-rows"><span class="header-section-number">2.3.10</span> Get the first n rows</a></li>
  <li><a href="#count-values-in-a-dataframe" id="toc-count-values-in-a-dataframe" class="nav-link" data-scroll-target="#count-values-in-a-dataframe"><span class="header-section-number">2.3.11</span> Count values in a DataFrame</a></li>
  <li><a href="#count-na-over-columns-in-a-dataframe" id="toc-count-na-over-columns-in-a-dataframe" class="nav-link" data-scroll-target="#count-na-over-columns-in-a-dataframe"><span class="header-section-number">2.3.12</span> Count NA over columns in a DataFrame</a></li>
  </ul></li>
  <li><a href="#filter-rows" id="toc-filter-rows" class="nav-link" data-scroll-target="#filter-rows"><span class="header-section-number">2.4</span> Filter rows</a></li>
  <li><a href="#select-columns" id="toc-select-columns" class="nav-link" data-scroll-target="#select-columns"><span class="header-section-number">2.5</span> Select columns</a>
  <ul class="collapse">
  <li><a href="#selecting-by-name" id="toc-selecting-by-name" class="nav-link" data-scroll-target="#selecting-by-name"><span class="header-section-number">2.5.1</span> Selecting by name</a></li>
  <li><a href="#selecting-by-data-type" id="toc-selecting-by-data-type" class="nav-link" data-scroll-target="#selecting-by-data-type"><span class="header-section-number">2.5.2</span> Selecting by data type</a></li>
  <li><a href="#selecting-with-a-regex" id="toc-selecting-with-a-regex" class="nav-link" data-scroll-target="#selecting-with-a-regex"><span class="header-section-number">2.5.3</span> Selecting with a regex</a></li>
  <li><a href="#selecting---other-ways" id="toc-selecting---other-ways" class="nav-link" data-scroll-target="#selecting---other-ways"><span class="header-section-number">2.5.4</span> Selecting - other ways</a></li>
  </ul></li>
  <li><a href="#modifyadd-columns" id="toc-modifyadd-columns" class="nav-link" data-scroll-target="#modifyadd-columns"><span class="header-section-number">2.6</span> Modify/Add columns</a>
  <ul class="collapse">
  <li><a href="#modify-existing-column" id="toc-modify-existing-column" class="nav-link" data-scroll-target="#modify-existing-column"><span class="header-section-number">2.6.1</span> Modify existing column</a></li>
  <li><a href="#add-a-new-column" id="toc-add-a-new-column" class="nav-link" data-scroll-target="#add-a-new-column"><span class="header-section-number">2.6.2</span> Add a new column</a></li>
  <li><a href="#add-a-new-column-with-a-constant-value" id="toc-add-a-new-column-with-a-constant-value" class="nav-link" data-scroll-target="#add-a-new-column-with-a-constant-value"><span class="header-section-number">2.6.3</span> Add a new column with a constant value</a></li>
  <li><a href="#add-a-new-column-based-on-conditions" id="toc-add-a-new-column-based-on-conditions" class="nav-link" data-scroll-target="#add-a-new-column-based-on-conditions"><span class="header-section-number">2.6.4</span> Add a new column based on conditions</a></li>
  <li><a href="#add-a-new-column-by-group" id="toc-add-a-new-column-by-group" class="nav-link" data-scroll-target="#add-a-new-column-by-group"><span class="header-section-number">2.6.5</span> Add a new column by group</a></li>
  </ul></li>
  <li><a href="#rename-columns-1" id="toc-rename-columns-1" class="nav-link" data-scroll-target="#rename-columns-1"><span class="header-section-number">2.7</span> Rename columns</a></li>
  <li><a href="#remove-columns" id="toc-remove-columns" class="nav-link" data-scroll-target="#remove-columns"><span class="header-section-number">2.8</span> Remove columns</a>
  <ul class="collapse">
  <li><a href="#removing-by-name" id="toc-removing-by-name" class="nav-link" data-scroll-target="#removing-by-name"><span class="header-section-number">2.8.1</span> Removing by name</a></li>
  <li><a href="#removing-with-a-regex" id="toc-removing-with-a-regex" class="nav-link" data-scroll-target="#removing-with-a-regex"><span class="header-section-number">2.8.2</span> Removing with a regex</a></li>
  </ul></li>
  <li><a href="#aggregation-by-group" id="toc-aggregation-by-group" class="nav-link" data-scroll-target="#aggregation-by-group"><span class="header-section-number">2.9</span> Aggregation by group</a></li>
  <li><a href="#sort-a-dataframe" id="toc-sort-a-dataframe" class="nav-link" data-scroll-target="#sort-a-dataframe"><span class="header-section-number">2.10</span> Sort a DataFrame</a>
  <ul class="collapse">
  <li><a href="#simply-sort-a-dataframe" id="toc-simply-sort-a-dataframe" class="nav-link" data-scroll-target="#simply-sort-a-dataframe"><span class="header-section-number">2.10.1</span> Simply sort a DataFrame</a></li>
  <li><a href="#keep-unique-rows" id="toc-keep-unique-rows" class="nav-link" data-scroll-target="#keep-unique-rows"><span class="header-section-number">2.10.2</span> Keep unique rows</a></li>
  <li><a href="#keep-some-columns-from-sorted-dataframe" id="toc-keep-some-columns-from-sorted-dataframe" class="nav-link" data-scroll-target="#keep-some-columns-from-sorted-dataframe"><span class="header-section-number">2.10.3</span> Keep some columns from sorted DataFrame</a></li>
  </ul></li>
  <li><a href="#join-dataframes" id="toc-join-dataframes" class="nav-link" data-scroll-target="#join-dataframes"><span class="header-section-number">2.11</span> Join DataFrames</a></li>
  <li><a href="#concatenate-dataframes" id="toc-concatenate-dataframes" class="nav-link" data-scroll-target="#concatenate-dataframes"><span class="header-section-number">2.12</span> Concatenate DataFrames</a>
  <ul class="collapse">
  <li><a href="#vertical-concatenation" id="toc-vertical-concatenation" class="nav-link" data-scroll-target="#vertical-concatenation"><span class="header-section-number">2.12.1</span> Vertical concatenation</a></li>
  <li><a href="#horizontal-concatenation" id="toc-horizontal-concatenation" class="nav-link" data-scroll-target="#horizontal-concatenation"><span class="header-section-number">2.12.2</span> Horizontal concatenation</a></li>
  <li><a href="#diagonal-concatenation" id="toc-diagonal-concatenation" class="nav-link" data-scroll-target="#diagonal-concatenation"><span class="header-section-number">2.12.3</span> Diagonal concatenation</a></li>
  </ul></li>
  <li><a href="#pivot-a-dataframe" id="toc-pivot-a-dataframe" class="nav-link" data-scroll-target="#pivot-a-dataframe"><span class="header-section-number">2.13</span> Pivot a DataFrame</a>
  <ul class="collapse">
  <li><a href="#from-long-to-wide" id="toc-from-long-to-wide" class="nav-link" data-scroll-target="#from-long-to-wide"><span class="header-section-number">2.13.1</span> From long to wide</a></li>
  <li><a href="#from-wide-to-long" id="toc-from-wide-to-long" class="nav-link" data-scroll-target="#from-wide-to-long"><span class="header-section-number">2.13.2</span> From wide to long</a></li>
  </ul></li>
  <li><a href="#dealing-with-missing-values" id="toc-dealing-with-missing-values" class="nav-link" data-scroll-target="#dealing-with-missing-values"><span class="header-section-number">2.14</span> Dealing with missing values</a>
  <ul class="collapse">
  <li><a href="#check-if-series-has-missing-values" id="toc-check-if-series-has-missing-values" class="nav-link" data-scroll-target="#check-if-series-has-missing-values"><span class="header-section-number">2.14.1</span> Check if Series has missing values</a></li>
  <li><a href="#replace-missing-values-with-a-constant" id="toc-replace-missing-values-with-a-constant" class="nav-link" data-scroll-target="#replace-missing-values-with-a-constant"><span class="header-section-number">2.14.2</span> Replace missing values with a constant</a></li>
  <li><a href="#replace-missing-values-with-a-strategy" id="toc-replace-missing-values-with-a-strategy" class="nav-link" data-scroll-target="#replace-missing-values-with-a-strategy"><span class="header-section-number">2.14.3</span> Replace missing values with a strategy</a></li>
  <li><a href="#replace-missing-values-with-an-expression" id="toc-replace-missing-values-with-an-expression" class="nav-link" data-scroll-target="#replace-missing-values-with-an-expression"><span class="header-section-number">2.14.4</span> Replace missing values with an expression</a></li>
  <li><a href="#replace-missing-values-with-a-sequence-of-columns" id="toc-replace-missing-values-with-a-sequence-of-columns" class="nav-link" data-scroll-target="#replace-missing-values-with-a-sequence-of-columns"><span class="header-section-number">2.14.5</span> Replace missing values with a sequence of columns</a></li>
  </ul></li>
  <li><a href="#others-useful-methods" id="toc-others-useful-methods" class="nav-link" data-scroll-target="#others-useful-methods"><span class="header-section-number">2.15</span> Others useful methods</a>
  <ul class="collapse">
  <li><a href="#on-series" id="toc-on-series" class="nav-link" data-scroll-target="#on-series"><span class="header-section-number">2.15.1</span> On Series</a></li>
  <li><a href="#on-dataframes" id="toc-on-dataframes" class="nav-link" data-scroll-target="#on-dataframes"><span class="header-section-number">2.15.2</span> On DataFrames</a></li>
  </ul></li>
  <li><a href="#strings-methods" id="toc-strings-methods" class="nav-link" data-scroll-target="#strings-methods"><span class="header-section-number">2.16</span> Strings methods</a>
  <ul class="collapse">
  <li><a href="#get-substrings" id="toc-get-substrings" class="nav-link" data-scroll-target="#get-substrings"><span class="header-section-number">2.16.1</span> Get substrings</a></li>
  <li><a href="#check-if-string-values-start-with-a-substring" id="toc-check-if-string-values-start-with-a-substring" class="nav-link" data-scroll-target="#check-if-string-values-start-with-a-substring"><span class="header-section-number">2.16.2</span> Check if string values start with a substring</a></li>
  <li><a href="#check-if-string-values-end-with-a-substring" id="toc-check-if-string-values-end-with-a-substring" class="nav-link" data-scroll-target="#check-if-string-values-end-with-a-substring"><span class="header-section-number">2.16.3</span> Check if string values end with a substring</a></li>
  </ul></li>
  <li><a href="#create-your-methods" id="toc-create-your-methods" class="nav-link" data-scroll-target="#create-your-methods"><span class="header-section-number">2.17</span> Create your methods</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/ddotta/cookbook-rpolars/edit/main/book/data_manipulation.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/ddotta/cookbook-rpolars/issues/new" class="toc-action">Report an issue</a></p><p><a href="https://github.com/ddotta/cookbook-rpolars/blob/main/book/data_manipulation.qmd" class="toc-action">View source</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data manipulation</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Below is the code used to create the fake data needed to run code in this document. Click to expand it! 👇</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(polars)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidypolars)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(arrow)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>iris_dt <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(iris)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Creation of Series</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>mynumbers_serie <span class="ot">&lt;-</span> <span class="fu">as_polars_series</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>myletters_serie <span class="ot">&lt;-</span> <span class="fu">as_polars_series</span>(<span class="fu">c</span>(<span class="st">"a"</span>,<span class="st">"b"</span>,<span class="st">"c"</span>))</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Creation of mydf DataFrame </span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>mydf <span class="ot">&lt;-</span> pl<span class="sc">$</span><span class="fu">DataFrame</span>(</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">col1 =</span> mynumbers_serie,</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">col2 =</span> myletters_serie</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="introduction-to-methods" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="introduction-to-methods"><span class="header-section-number">2.1</span> Introduction to methods</h2>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Although some simple R functions work out of the box on polars objects, the added value of Polars consists in the <code>methods</code>. Thosepowerful methods are accessed using the <code>$</code> operator.</p>
<p>There are numerous <code>methods</code> designed to accomplish various tasks.</p>
<ul>
<li><p>One advantage of using <code>methods</code> is that many more operations are possible on Polars objects using <code>methods</code> than through base R functions.</p></li>
<li><p>A second advantage is <code>Methods Chaining</code>, a core part of the Polars workflow. If you are coming from one of the other popular data wrangling libraries in R, then you probably already have an innate sense of what this means. For instance:</p>
<ul>
<li>In dplyr we use a pipe operator, e.g.&nbsp;dat |&gt; filter(…) |&gt; select(…)<br>
-In data.table we use its indexing syntax, e.g.&nbsp;DT[i, j, by][…]</li>
</ul></li>
</ul>
<p>In polars our method chaining syntax takes the form <code>object$m1()$m2()</code>, where object is our data object, and $m1() and $m2() are appropriate <code>methods</code>.</p>
</div>
</div>
<ul>
<li>For <code>Series</code>, see <a href="#list-of-methods-to-apply-to-series">this section</a> for the methods available in {polars}.</li>
<li>For <code>DataFrames</code>, see <a href="#list-of-methods-to-apply-to-dataframe">this section</a> for the methods available in {polars}.</li>
</ul>
<p>Some examples with <code>Series</code>: Some examples with <code>Series</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To get a sum</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>mynumbers_serie<span class="sc">$</span><span class="fu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (1, 1)
┌─────┐
│     │
│ --- │
│ i32 │
╞═════╡
│ 6   │
└─────┘</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To sort</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>mynumbers_serie<span class="sc">$</span><span class="fu">sort</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 1)
┌─────┐
│     │
│ --- │
│ i32 │
╞═════╡
│ 1   │
│ 2   │
│ 3   │
└─────┘</code></pre>
</div>
</div>
<p>Some examples with <code>DataFrame</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To get a character vector of column names</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>mydf<span class="sc">$</span>columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "col1" "col2"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To get dimensions of DataFrame</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>mydf<span class="sc">$</span>shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We can mix standard R functions and methods</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(mydf<span class="sc">$</span>columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
<p>Polars includes a very useful chaining method in data manipulation operations. From this point of view, Polars is more like dplyr and data.table. This is how the chaining method is defined in the official documentation:</p>
<blockquote class="blockquote">
<p>In polars our method chaining syntax takes the form <code>object$m1()$m2()</code>, where object is our data <code>object</code>, and <code>m1()</code> and <code>m2()</code> are appropriate methods, like subsetting or aggregation expressions.</p>
</blockquote>
<p>Let’s see an example with the iris dataset:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">tidypolars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">dplyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris)<span class="sc">$</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Species"</span>)<span class="sc">$</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">median</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 5)
┌────────────┬──────────────┬─────────────┬──────────────┬─────────────┐
│ Species    ┆ Sepal.Length ┆ Sepal.Width ┆ Petal.Length ┆ Petal.Width │
│ ---        ┆ ---          ┆ ---         ┆ ---          ┆ ---         │
│ cat        ┆ f64          ┆ f64         ┆ f64          ┆ f64         │
╞════════════╪══════════════╪═════════════╪══════════════╪═════════════╡
│ setosa     ┆ 5.0          ┆ 3.4         ┆ 1.5          ┆ 0.2         │
│ virginica  ┆ 6.5          ┆ 3.0         ┆ 5.55         ┆ 2.0         │
│ versicolor ┆ 5.9          ┆ 2.8         ┆ 4.35         ┆ 1.3         │
└────────────┴──────────────┴─────────────┴──────────────┴─────────────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris) <span class="sc">|&gt;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Species) <span class="sc">|&gt;</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">everything</span>(),median))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 5)
┌────────────┬──────────────┬─────────────┬──────────────┬─────────────┐
│ Species    ┆ Sepal.Length ┆ Sepal.Width ┆ Petal.Length ┆ Petal.Width │
│ ---        ┆ ---          ┆ ---         ┆ ---          ┆ ---         │
│ cat        ┆ f64          ┆ f64         ┆ f64          ┆ f64         │
╞════════════╪══════════════╪═════════════╪══════════════╪═════════════╡
│ setosa     ┆ 5.0          ┆ 3.4         ┆ 1.5          ┆ 0.2         │
│ versicolor ┆ 5.9          ┆ 2.8         ┆ 4.35         ┆ 1.3         │
│ virginica  ┆ 6.5          ┆ 3.0         ┆ 5.55         ┆ 2.0         │
└────────────┴──────────────┴─────────────┴──────────────┴─────────────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(. <span class="sc">~</span> Species, iris, median)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Species Sepal.Length Sepal.Width Petal.Length Petal.Width
1     setosa          5.0         3.4         1.50         0.2
2 versicolor          5.9         2.8         4.35         1.3
3  virginica          6.5         3.0         5.55         2.0</code></pre>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Species) <span class="sc">|&gt;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">everything</span>(),median))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  Species    Sepal.Length Sepal.Width Petal.Length Petal.Width
  &lt;fct&gt;             &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
1 setosa              5           3.4         1.5          0.2
2 versicolor          5.9         2.8         4.35         1.3
3 virginica           6.5         3           5.55         2  </code></pre>
</div>
</div>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>iris_dt[, <span class="fu">lapply</span>(.SD, median), by <span class="ot">=</span> Species]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Species Sepal.Length Sepal.Width Petal.Length Petal.Width
       &lt;fctr&gt;        &lt;num&gt;       &lt;num&gt;        &lt;num&gt;       &lt;num&gt;
1:     setosa          5.0         3.4         1.50         0.2
2: versicolor          5.9         2.8         4.35         1.3
3:  virginica          6.5         3.0         5.55         2.0</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>In the Polars code used above, you will notice that we have introduced <strong>line breaks</strong>. We could have written the whole code on the same line but for the sake of readability I prefer to separate the methods used by line breaks.</p>
</div>
</div>
</section>
<section id="conversion-between-seriesdataframes-and-vectordata.frames" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="conversion-between-seriesdataframes-and-vectordata.frames"><span class="header-section-number">2.2</span> Conversion between Series/DataFrames and vector/data.frames</h2>
<section id="from-vectordata.frames-to-seriesdataframes" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="from-vectordata.frames-to-seriesdataframes"><span class="header-section-number">2.2.1</span> From vector/data.frames to Series/DataFrames</h3>
<p>These conversions have already been seen earlier in this book.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To convert vector to Polars Series</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>myvector <span class="ot">&lt;-</span> <span class="fu">as_polars_series</span>(<span class="fu">c</span>(<span class="st">"a"</span>,<span class="st">"b"</span>,<span class="st">"c"</span>))</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co"># To convert data.frames to DataFrames</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>iris_polars <span class="ot">&lt;-</span> <span class="fu">as_polars_df</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="from-seriesdataframes-to-vectordata.frames" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="from-seriesdataframes-to-vectordata.frames"><span class="header-section-number">2.2.2</span> From Series/DataFrames to vector/data.frames</h3>
<p>Here, we can use <code>as.vector()</code> and <code>as.data.frame()</code> functions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To convert Polars Series to a vector</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.vector</span>(myvector)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "a" "b" "c"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To convert Polars Series to a list</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.list</span>(myvector)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "a"

[[2]]
[1] "b"

[[3]]
[1] "c"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To convert DataFrames to data.frames</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(iris_polars<span class="sc">$</span><span class="fu">slice</span>(<span class="dv">1</span>,<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1          4.9         3.0          1.4         0.2  setosa
2          4.7         3.2          1.3         0.2  setosa
3          4.6         3.1          1.5         0.2  setosa
4          5.0         3.6          1.4         0.2  setosa
5          5.4         3.9          1.7         0.4  setosa</code></pre>
</div>
</div>
</section>
</section>
<section id="initial-informations-on-a-dataframe" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="initial-informations-on-a-dataframe"><span class="header-section-number">2.3</span> Initial informations on a DataFrame</h2>
<p>Here is a list of instructions that I frequently use to quickly get information about a <code>DataFrame</code>.</p>
<section id="get-the-schema" class="level3" data-number="2.3.1">
<h3 data-number="2.3.1" class="anchored" data-anchor-id="get-the-schema"><span class="header-section-number">2.3.1</span> Get the schema</h3>
<p>A <code>DataFrame</code> has a <code>schema</code> attribute which is a named list of DataTypes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>mydf<span class="sc">$</span>schema</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$col1
Int32

$col2
String</code></pre>
</div>
</div>
</section>
<section id="get-the-dimensions" class="level3" data-number="2.3.2">
<h3 data-number="2.3.2" class="anchored" data-anchor-id="get-the-dimensions"><span class="header-section-number">2.3.2</span> Get the dimensions</h3>
<p>A <code>DataFrame</code> has a <code>shape</code> attribute which is a two length numeric vector of c(nrows,ncols).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>mydf<span class="sc">$</span>shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3 2</code></pre>
</div>
</div>
</section>
<section id="get-columns-types" class="level3" data-number="2.3.3">
<h3 data-number="2.3.3" class="anchored" data-anchor-id="get-columns-types"><span class="header-section-number">2.3.3</span> Get columns types</h3>
<p>A <code>DataFrame</code> has a <code>dtypes</code> attribute which is a list of dtypes (for data type) for every column of the <code>DataFrame</code>.</p>
<p>Alternatively, the <code>dtype_strings()</code> method can be used to get columns types in a character/string vector.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With dtypes attribute (with a "s" and without parentheses)</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>mydf<span class="sc">$</span>dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
Int32

[[2]]
String</code></pre>
</div>
</div>
</section>
<section id="get-a-glimpse" class="level3" data-number="2.3.4">
<h3 data-number="2.3.4" class="anchored" data-anchor-id="get-a-glimpse"><span class="header-section-number">2.3.4</span> Get a glimpse</h3>
<p>You can access a dense preview of a <code>DataFrame</code> by using the <code>glimpse()</code> method. f The formatting is done one line per column, so wide <code>DataFrame</code> show nicely. Each line will show the column name, the dtypes attributes and the first few values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris)<span class="sc">$</span><span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 150
Columns: 5
$ Sepal.Length &lt;f64&gt;: 5.1, 4.9, 4.7, 4.6, 5.0, 5.4, 4.6, 5.0, 4.4, 4.9
$ Sepal.Width  &lt;f64&gt;: 3.5, 3.0, 3.2, 3.1, 3.6, 3.9, 3.4, 3.4, 2.9, 3.1
$ Petal.Length &lt;f64&gt;: 1.4, 1.4, 1.3, 1.5, 1.4, 1.7, 1.4, 1.5, 1.4, 1.5
$ Petal.Width  &lt;f64&gt;: 0.2, 0.2, 0.2, 0.2, 0.2, 0.4, 0.3, 0.2, 0.2, 0.1
$ Species      &lt;cat&gt;: setosa, setosa, setosa, setosa, setosa, setosa, setosa, setosa, setosa, setosa</code></pre>
</div>
</div>
</section>
<section id="get-summary-statistics" class="level3" data-number="2.3.5">
<h3 data-number="2.3.5" class="anchored" data-anchor-id="get-summary-statistics"><span class="header-section-number">2.3.5</span> Get summary statistics</h3>
<p>You can access some summary statistics from a <code>DataFrame</code> by using the <code>describe()</code> method.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris)<span class="sc">$</span><span class="fu">describe</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (9, 6)
┌────────────┬──────────────┬─────────────┬──────────────┬─────────────┬───────────┐
│ statistic  ┆ Sepal.Length ┆ Sepal.Width ┆ Petal.Length ┆ Petal.Width ┆ Species   │
│ ---        ┆ ---          ┆ ---         ┆ ---          ┆ ---         ┆ ---       │
│ str        ┆ f64          ┆ f64         ┆ f64          ┆ f64         ┆ str       │
╞════════════╪══════════════╪═════════════╪══════════════╪═════════════╪═══════════╡
│ count      ┆ 150.0        ┆ 150.0       ┆ 150.0        ┆ 150.0       ┆ 150       │
│ null_count ┆ 0.0          ┆ 0.0         ┆ 0.0          ┆ 0.0         ┆ 0         │
│ mean       ┆ 5.843333     ┆ 3.057333    ┆ 3.758        ┆ 1.199333    ┆ null      │
│ std        ┆ 0.828066     ┆ 0.435866    ┆ 1.765298     ┆ 0.762238    ┆ null      │
│ min        ┆ 4.3          ┆ 2.0         ┆ 1.0          ┆ 0.1         ┆ setosa    │
│ 25%        ┆ 5.1          ┆ 2.8         ┆ 1.6          ┆ 0.3         ┆ null      │
│ 50%        ┆ 5.8          ┆ 3.0         ┆ 4.4          ┆ 1.3         ┆ null      │
│ 75%        ┆ 6.4          ┆ 3.3         ┆ 5.1          ┆ 1.8         ┆ null      │
│ max        ┆ 7.9          ┆ 4.4         ┆ 6.9          ┆ 2.5         ┆ virginica │
└────────────┴──────────────┴─────────────┴──────────────┴─────────────┴───────────┘</code></pre>
</div>
</div>
</section>
<section id="get-the-rows-number" class="level3" data-number="2.3.6">
<h3 data-number="2.3.6" class="anchored" data-anchor-id="get-the-rows-number"><span class="header-section-number">2.3.6</span> Get the rows number</h3>
<p>A <code>DataFrame</code> has a <code>width</code> attribute which returns the width of the <code>DataFrame</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With width attribute</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>mydf<span class="sc">$</span>width</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
</section>
<section id="get-the-columns-number" class="level3" data-number="2.3.7">
<h3 data-number="2.3.7" class="anchored" data-anchor-id="get-the-columns-number"><span class="header-section-number">2.3.7</span> Get the columns number</h3>
<p>A <code>DataFrame</code> has a <code>height</code> attribute which returns the width of the <code>DataFrame</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With height attribute</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>mydf<span class="sc">$</span>height</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
</section>
<section id="get-the-columns-names" class="level3" data-number="2.3.8">
<h3 data-number="2.3.8" class="anchored" data-anchor-id="get-the-columns-names"><span class="header-section-number">2.3.8</span> Get the columns names</h3>
<p>A <code>DataFrame</code> has a <code>columns</code> attribute which returns the columns names of the <code>DataFrame</code> in a character vector.<br>
The <code>names()</code> method can be used to get the columns names.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>mydf<span class="sc">$</span>columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "col1" "col2"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With names() method</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mydf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "col1" "col2"</code></pre>
</div>
</div>
</section>
<section id="rename-columns" class="level3" data-number="2.3.9">
<h3 data-number="2.3.9" class="anchored" data-anchor-id="rename-columns"><span class="header-section-number">2.3.9</span> Rename columns</h3>
<p>A character vector can be passed to the <code>columns</code> attribute to rename the columns names of the <code>DataFrame</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>mydf<span class="sc">$</span><span class="fu">rename</span>(<span class="at">col1 =</span> <span class="st">"colA"</span>, <span class="at">col2 =</span> <span class="st">"colB"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 2)
┌──────┬──────┐
│ colA ┆ colB │
│ ---  ┆ ---  │
│ i32  ┆ str  │
╞══════╪══════╡
│ 1    ┆ a    │
│ 2    ┆ b    │
│ 3    ┆ c    │
└──────┴──────┘</code></pre>
</div>
</div>
</section>
<section id="get-the-first-n-rows" class="level3" data-number="2.3.10">
<h3 data-number="2.3.10" class="anchored" data-anchor-id="get-the-first-n-rows"><span class="header-section-number">2.3.10</span> Get the first n rows</h3>
<p>The <code>head()</code> method can be used to get the first n rows of a <code>DataFrame</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To get the 2 first rows</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>mydf<span class="sc">$</span><span class="fu">head</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (2, 2)
┌──────┬──────┐
│ col1 ┆ col2 │
│ ---  ┆ ---  │
│ i32  ┆ str  │
╞══════╪══════╡
│ 1    ┆ a    │
│ 2    ┆ b    │
└──────┴──────┘</code></pre>
</div>
</div>
</section>
<section id="count-values-in-a-dataframe" class="level3" data-number="2.3.11">
<h3 data-number="2.3.11" class="anchored" data-anchor-id="count-values-in-a-dataframe"><span class="header-section-number">2.3.11</span> Count values in a DataFrame</h3>
<p>The <code>value_counts()</code> method can be used to count the occurences of uniques values in a Series of a DataFrame. <code>value_counts()</code> works with a <code>Series</code>. It must therefore be supplied with the <code>select()</code> method. See <a href="#select-columns">here</a> to learn about it.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">tidypolars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">dplyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-5" role="tab" aria-controls="tabset-2-5" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris)<span class="sc">$</span><span class="fu">select</span>(pl<span class="sc">$</span><span class="fu">col</span>(<span class="st">"Species"</span>)<span class="sc">$</span><span class="fu">value_counts</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 1)
┌───────────────────┐
│ Species           │
│ ---               │
│ struct[2]         │
╞═══════════════════╡
│ {"versicolor",50} │
│ {"setosa",50}     │
│ {"virginica",50}  │
└───────────────────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris) <span class="sc">|&gt;</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 2)
┌────────────┬─────┐
│ Species    ┆ n   │
│ ---        ┆ --- │
│ cat        ┆ u32 │
╞════════════╪═════╡
│ setosa     ┆ 50  │
│ versicolor ┆ 50  │
│ virginica  ┆ 50  │
└────────────┴─────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(iris<span class="sc">$</span>Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    setosa versicolor  virginica 
        50         50         50 </code></pre>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Species  n
1     setosa 50
2 versicolor 50
3  virginica 50</code></pre>
</div>
</div>
</div>
<div id="tabset-2-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>iris_dt[, .N, by <span class="ot">=</span> Species]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Species     N
       &lt;fctr&gt; &lt;int&gt;
1:     setosa    50
2: versicolor    50
3:  virginica    50</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="count-na-over-columns-in-a-dataframe" class="level3" data-number="2.3.12">
<h3 data-number="2.3.12" class="anchored" data-anchor-id="count-na-over-columns-in-a-dataframe"><span class="header-section-number">2.3.12</span> Count NA over columns in a DataFrame</h3>
<p>The <code>null_count()</code> method can be used to count NA values of a DataFrame.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">tidypolars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false">dplyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-5" role="tab" aria-controls="tabset-3-5" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>mydfNA <span class="ot">&lt;-</span> pl<span class="sc">$</span><span class="fu">DataFrame</span>(</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">colA =</span> <span class="fu">c</span>(<span class="st">"a"</span>,<span class="cn">NA</span>,<span class="st">"c"</span>),</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">colB =</span> <span class="fu">c</span>(<span class="st">"d"</span>,<span class="cn">NA</span>,<span class="cn">NA</span>))</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>mydfNA<span class="sc">$</span><span class="fu">select</span>(pl<span class="sc">$</span><span class="fu">all</span>()<span class="sc">$</span><span class="fu">null_count</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (1, 2)
┌──────┬──────┐
│ colA ┆ colB │
│ ---  ┆ ---  │
│ u32  ┆ u32  │
╞══════╪══════╡
│ 1    ┆ 2    │
└──────┴──────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>mydfNA <span class="sc">|&gt;</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span><span class="fu">sum</span>(<span class="fu">is.na</span>(.x))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (1, 2)
┌──────┬──────┐
│ colA ┆ colB │
│ ---  ┆ ---  │
│ u32  ┆ u32  │
╞══════╪══════╡
│ 1    ┆ 2    │
└──────┴──────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>mydfNA <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">colA =</span> <span class="fu">c</span>(<span class="st">"a"</span>,<span class="cn">NA</span>,<span class="st">"c"</span>),</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">colB =</span> <span class="fu">c</span>(<span class="st">"d"</span>,<span class="cn">NA</span>,<span class="cn">NA</span>))</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(mydfNA, <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>colA colB 
   1    2 </code></pre>
</div>
</div>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>mydfNA <span class="sc">|&gt;</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span><span class="fu">sum</span>(<span class="fu">is.na</span>(.x))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  colA colB
1    1    2</code></pre>
</div>
</div>
</div>
<div id="tabset-3-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>mydfNA_dt <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(mydfNA)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>mydfNA_dt[, <span class="fu">lapply</span>(.SD, <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x))), .SDcols <span class="ot">=</span> <span class="fu">names</span>(mydfNA_dt)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    colA  colB
   &lt;int&gt; &lt;int&gt;
1:     1     2</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="filter-rows" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="filter-rows"><span class="header-section-number">2.4</span> Filter rows</h2>
<p>The first option to filter rows of a DataFrame is to use square brackets <code>[]</code> indexing (with integer row number).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="co"># The first four lines</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (4, 5)
┌──────────────┬─────────────┬──────────────┬─────────────┬─────────┐
│ Sepal.Length ┆ Sepal.Width ┆ Petal.Length ┆ Petal.Width ┆ Species │
│ ---          ┆ ---         ┆ ---          ┆ ---         ┆ ---     │
│ f64          ┆ f64         ┆ f64          ┆ f64         ┆ cat     │
╞══════════════╪═════════════╪══════════════╪═════════════╪═════════╡
│ 5.1          ┆ 3.5         ┆ 1.4          ┆ 0.2         ┆ setosa  │
│ 4.9          ┆ 3.0         ┆ 1.4          ┆ 0.2         ┆ setosa  │
│ 4.7          ┆ 3.2         ┆ 1.3          ┆ 0.2         ┆ setosa  │
│ 4.6          ┆ 3.1         ┆ 1.5          ┆ 0.2         ┆ setosa  │
└──────────────┴─────────────┴──────────────┴─────────────┴─────────┘</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The lines 1, 3 and 5</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris)[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 5)
┌──────────────┬─────────────┬──────────────┬─────────────┬─────────┐
│ Sepal.Length ┆ Sepal.Width ┆ Petal.Length ┆ Petal.Width ┆ Species │
│ ---          ┆ ---         ┆ ---          ┆ ---         ┆ ---     │
│ f64          ┆ f64         ┆ f64          ┆ f64         ┆ cat     │
╞══════════════╪═════════════╪══════════════╪═════════════╪═════════╡
│ 5.1          ┆ 3.5         ┆ 1.4          ┆ 0.2         ┆ setosa  │
│ 4.7          ┆ 3.2         ┆ 1.3          ┆ 0.2         ┆ setosa  │
│ 5.0          ┆ 3.6         ┆ 1.4          ┆ 0.2         ┆ setosa  │
└──────────────┴─────────────┴──────────────┴─────────────┴─────────┘</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>It’s convenient when you have to quickly inspect your data. But you’ll quickly be limited by the square brackets, as they don’t accept conditions with the expressions. For example <code>as_polars_df(iris)[Petal.Length &gt; 6]</code> doesn’t work.</p>
</div>
</div>
<p>The second and best option is to use the <code>filter()</code> method. It must be used with the <code>Polars expression</code>, here the <code>col()</code> method which allows to designate the columns on which the filter condition will be applied.</p>
<p>Let’s see in details what’s inside a <code>filter()</code> method with an example:</p>
<ul>
<li><code>pl$col("Petal.Length")</code>: this expression selects the <code>Petal.Length</code> column from iris;<br>
</li>
<li><code>&gt;6</code>: applies a Boolean condition to this expression (for all Petals that have a length &gt; 6).</li>
</ul>
<p>In the example below, we will use <code>&amp;</code> operator to apply multiple conditions in <code>filter()</code> method:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">tidypolars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false">dplyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-5" role="tab" aria-controls="tabset-4-5" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris)<span class="sc">$</span><span class="fu">filter</span>(</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  pl<span class="sc">$</span><span class="fu">col</span>(<span class="st">"Petal.Length"</span>) <span class="sc">&gt;</span> <span class="dv">6</span> <span class="sc">&amp;</span> pl<span class="sc">$</span><span class="fu">col</span>(<span class="st">"Petal.Width"</span>) <span class="sc">&lt;</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (2, 5)
┌──────────────┬─────────────┬──────────────┬─────────────┬───────────┐
│ Sepal.Length ┆ Sepal.Width ┆ Petal.Length ┆ Petal.Width ┆ Species   │
│ ---          ┆ ---         ┆ ---          ┆ ---         ┆ ---       │
│ f64          ┆ f64         ┆ f64          ┆ f64         ┆ cat       │
╞══════════════╪═════════════╪══════════════╪═════════════╪═══════════╡
│ 7.3          ┆ 2.9         ┆ 6.3          ┆ 1.8         ┆ virginica │
│ 7.4          ┆ 2.8         ┆ 6.1          ┆ 1.9         ┆ virginica │
└──────────────┴─────────────┴──────────────┴─────────────┴───────────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris) <span class="sc">|&gt;</span> </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Petal.Length <span class="sc">&gt;</span> <span class="dv">6</span> <span class="sc">&amp;</span> Petal.Width <span class="sc">&lt;</span> <span class="dv">2</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (2, 5)
┌──────────────┬─────────────┬──────────────┬─────────────┬───────────┐
│ Sepal.Length ┆ Sepal.Width ┆ Petal.Length ┆ Petal.Width ┆ Species   │
│ ---          ┆ ---         ┆ ---          ┆ ---         ┆ ---       │
│ f64          ┆ f64         ┆ f64          ┆ f64         ┆ cat       │
╞══════════════╪═════════════╪══════════════╪═════════════╪═══════════╡
│ 7.3          ┆ 2.9         ┆ 6.3          ┆ 1.8         ┆ virginica │
│ 7.4          ┆ 2.8         ┆ 6.1          ┆ 1.9         ┆ virginica │
└──────────────┴─────────────┴──────────────┴─────────────┴───────────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>iris[iris<span class="sc">$</span>Petal.Length <span class="sc">&gt;</span> <span class="dv">6</span> <span class="sc">&amp;</span> iris<span class="sc">$</span>Petal.Width <span class="sc">&lt;</span> <span class="dv">2</span>,] <span class="co"># here don't forget the comma</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Sepal.Length Sepal.Width Petal.Length Petal.Width   Species
108          7.3         2.9          6.3         1.8 virginica
131          7.4         2.8          6.1         1.9 virginica</code></pre>
</div>
</div>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Petal.Length <span class="sc">&gt;</span> <span class="dv">6</span> <span class="sc">&amp;</span> Petal.Width <span class="sc">&lt;</span> <span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width   Species
1          7.3         2.9          6.3         1.8 virginica
2          7.4         2.8          6.1         1.9 virginica</code></pre>
</div>
</div>
</div>
<div id="tabset-4-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>iris_dt[Petal.Length <span class="sc">&gt;</span> <span class="dv">6</span> <span class="sc">&amp;</span> Petal.Width <span class="sc">&lt;</span> <span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Sepal.Length Sepal.Width Petal.Length Petal.Width   Species
          &lt;num&gt;       &lt;num&gt;        &lt;num&gt;       &lt;num&gt;    &lt;fctr&gt;
1:          7.3         2.9          6.3         1.8 virginica
2:          7.4         2.8          6.1         1.9 virginica</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>The equivalent of <code>%in%</code> R operator is the <code>is_in()</code> method. It should be used in association with the <code>lit()</code> method.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>pl<span class="sc">$</span><span class="fu">DataFrame</span>(</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">colA =</span> <span class="fu">c</span>(<span class="st">"a"</span>,<span class="st">"b"</span>,<span class="st">"c"</span>)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">$</span><span class="fu">filter</span>(</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  pl<span class="sc">$</span><span class="fu">col</span>(<span class="st">"colA"</span>)<span class="sc">$</span><span class="fu">is_in</span>(pl<span class="sc">$</span><span class="fu">lit</span>(<span class="fu">c</span>(<span class="st">"a"</span>,<span class="st">"b"</span>)))</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (2, 1)
┌──────┐
│ colA │
│ ---  │
│ str  │
╞══════╡
│ a    │
│ b    │
└──────┘</code></pre>
</div>
</div>
</div>
</div>
<p>Another reason for using the <code>filter()</code> method is that filter expressions can be optimised in <a href="lazy_execution.html#introduction-to-lazy-mode">lazy mode</a> by the query optimiser. Square brackets <code>[]</code> can only be used in <strong>eager mode</strong>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>There is another way <strong>to speed up filter processing on rows</strong>: tell polars that the column(s) used to filter rows are already sorted! To do this, you can use the <code>set_sorted()</code> method.<br>
Here’s an example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>mydf <span class="ot">&lt;-</span> pl<span class="sc">$</span><span class="fu">DataFrame</span>(</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">col1 =</span> <span class="fu">sort</span>(<span class="fu">runif</span>(<span class="dv">10000000</span>))</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="fu">microbenchmark</span>(</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Without telling col1 is sorted"</span> <span class="ot">=</span> mydf<span class="sc">$</span><span class="fu">filter</span>(pl<span class="sc">$</span><span class="fu">col</span>(<span class="st">"col1"</span>) <span class="sc">&lt;</span> <span class="dv">100</span>),</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Telling col1 is sorted"</span> <span class="ot">=</span> mydf<span class="sc">$</span><span class="fu">with_columns</span>(pl<span class="sc">$</span><span class="fu">col</span>(<span class="st">"col1"</span>)<span class="sc">$</span><span class="fu">set_sorted</span>())<span class="sc">$</span><span class="fu">filter</span>(pl<span class="sc">$</span><span class="fu">col</span>(<span class="st">"col1"</span>) <span class="sc">&lt;</span> <span class="dv">100</span>)</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Unit: milliseconds
                           expr      min       lq     mean   median       uq
 Without telling col1 is sorted 5.366970 5.480199 5.618773 5.541145 5.620915
         Telling col1 is sorted 2.386035 2.485351 2.686778 2.557545 2.672003
      max neval
 9.586771   100
 7.175788   100</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="select-columns" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="select-columns"><span class="header-section-number">2.5</span> Select columns</h2>
<section id="selecting-by-name" class="level3" data-number="2.5.1">
<h3 data-number="2.5.1" class="anchored" data-anchor-id="selecting-by-name"><span class="header-section-number">2.5.1</span> Selecting by name</h3>
<p>The first option for selecting columns of a DataFrame is to use square brackets <code>[]</code>.<br>
The second option is to use the <code>select()</code> method. In this case, it must be used with the <code>col()</code> method which allows to designate the columns to be selected with a character vector.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">tidypolars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false">dplyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-5" role="tab" aria-controls="tabset-5-5" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1st option : with square brackets syntax</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="fu">c</span>(<span class="st">"Petal.Length"</span>,<span class="st">"Petal.Width"</span>)] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 2)
┌──────────────┬─────────────┐
│ Petal.Length ┆ Petal.Width │
│ ---          ┆ ---         │
│ f64          ┆ f64         │
╞══════════════╪═════════════╡
│ 1.4          ┆ 0.2         │
│ 1.4          ┆ 0.2         │
│ 1.3          ┆ 0.2         │
└──────────────┴─────────────┘</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2nd option : with select() method</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris)<span class="sc">$</span><span class="fu">select</span>(</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  pl<span class="sc">$</span><span class="fu">col</span>(<span class="st">"Petal.Length"</span>,<span class="st">"Petal.Width"</span>)</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>)<span class="sc">$</span><span class="fu">head</span>(<span class="dv">3</span>) <span class="co"># display the first 3 lines</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 2)
┌──────────────┬─────────────┐
│ Petal.Length ┆ Petal.Width │
│ ---          ┆ ---         │
│ f64          ┆ f64         │
╞══════════════╪═════════════╡
│ 1.4          ┆ 0.2         │
│ 1.4          ┆ 0.2         │
│ 1.3          ┆ 0.2         │
└──────────────┴─────────────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris) <span class="sc">|&gt;</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Petal.Length,Petal.Width) <span class="sc">|&gt;</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 2)
┌──────────────┬─────────────┐
│ Petal.Length ┆ Petal.Width │
│ ---          ┆ ---         │
│ f64          ┆ f64         │
╞══════════════╪═════════════╡
│ 1.4          ┆ 0.2         │
│ 1.4          ┆ 0.2         │
│ 1.3          ┆ 0.2         │
└──────────────┴─────────────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>iris[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="fu">c</span>(<span class="st">"Petal.Length"</span>,<span class="st">"Petal.Width"</span>)] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Petal.Length Petal.Width
1          1.4         0.2
2          1.4         0.2
3          1.3         0.2</code></pre>
</div>
</div>
</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Petal.Length,Petal.Width) <span class="sc">|&gt;</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Petal.Length Petal.Width
1          1.4         0.2
2          1.4         0.2
3          1.3         0.2</code></pre>
</div>
</div>
</div>
<div id="tabset-5-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>iris_dt[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,.(Petal.Length,Petal.Width)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Petal.Length Petal.Width
          &lt;num&gt;       &lt;num&gt;
1:          1.4         0.2
2:          1.4         0.2
3:          1.3         0.2</code></pre>
</div>
</div>
</div>
</div>
</div>
<p><strong>Keep in mind that when:</strong><br>
- Square brackets are used:<br>
- <strong>Selecting only one column</strong> from a <code>DataFrame</code>, the output is a <code>Series</code>;<br>
- Whereas <strong>if there is more than one column selected</strong>, the output is a <code>DataFrame</code>.<br>
- <code>select()</code> method is used:<br>
- <strong>The output is always a <code>DataFrame</code></strong> rather than a <code>Series</code> even if one column is selected.<br>
=&gt; If you need a <code>Series</code> you can use the <code>to_series()</code> method. See <a href="#get-series-from-dataFrame">here</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">inherits</span>(<span class="fu">as_polars_df</span>(iris)[,<span class="st">"Petal.Length"</span>],<span class="st">"Series"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">inherits</span>(<span class="fu">as_polars_df</span>(iris)[,<span class="st">"Petal.Length"</span>],<span class="st">"DataFrame"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">inherits</span>(<span class="fu">as_polars_df</span>(iris)[,<span class="fu">c</span>(<span class="st">"Petal.Length"</span>,<span class="st">"Petal.Width"</span>)],<span class="st">"DataFrame"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">inherits</span>(<span class="fu">as_polars_df</span>(iris)[,<span class="fu">c</span>(<span class="st">"Petal.Length"</span>,<span class="st">"Petal.Width"</span>)],<span class="st">"Series"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<p>With Polars if you want to obtain a result in an R data.frame, you can simply use the function <code>as.data.frame()</code>. See <a href="#from-seriesdataframes-to-vectordata.frames">here</a> for examples.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Beyond the minor differences discussed above, there are <strong>two major reasons why you should use the <code>select()</code> method over the syntax with square brackets:</strong><br>
- When you select and transform multiple columns with <code>select()</code> method, Polars will run these selections <strong>in parallel</strong>;<br>
- Expressions used in <code>select()</code> method can be optimised in <a href="lazy_execution.html#introduction-to-lazy-mode">lazy mode</a> by the query optimizer.</p>
</div>
</div>
</section>
<section id="selecting-by-data-type" class="level3" data-number="2.5.2">
<h3 data-number="2.5.2" class="anchored" data-anchor-id="selecting-by-data-type"><span class="header-section-number">2.5.2</span> Selecting by data type</h3>
<p>To select columns by data type from a <code>DataFrame</code>, you can pass a data type to <code>pl$col</code> expression. For example:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">tidypolars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-4" role="tab" aria-controls="tabset-6-4" aria-selected="false">dplyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-5" role="tab" aria-controls="tabset-6-5" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select only Float64 columns</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris)<span class="sc">$</span><span class="fu">select</span>(pl<span class="sc">$</span><span class="fu">col</span>(pl<span class="sc">$</span>Float64))<span class="sc">$</span><span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 4)
┌──────────────┬─────────────┬──────────────┬─────────────┐
│ Sepal.Length ┆ Sepal.Width ┆ Petal.Length ┆ Petal.Width │
│ ---          ┆ ---         ┆ ---          ┆ ---         │
│ f64          ┆ f64         ┆ f64          ┆ f64         │
╞══════════════╪═════════════╪══════════════╪═════════════╡
│ 5.1          ┆ 3.5         ┆ 1.4          ┆ 0.2         │
│ 4.9          ┆ 3.0         ┆ 1.4          ┆ 0.2         │
│ 4.7          ┆ 3.2         ┆ 1.3          ┆ 0.2         │
└──────────────┴─────────────┴──────────────┴─────────────┘</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select only numeric columns</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris)<span class="sc">$</span><span class="fu">select</span>(cs<span class="sc">$</span><span class="fu">numeric</span>())<span class="sc">$</span><span class="fu">head</span>(<span class="dv">3</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 4)
┌──────────────┬─────────────┬──────────────┬─────────────┐
│ Sepal.Length ┆ Sepal.Width ┆ Petal.Length ┆ Petal.Width │
│ ---          ┆ ---         ┆ ---          ┆ ---         │
│ f64          ┆ f64         ┆ f64          ┆ f64         │
╞══════════════╪═════════════╪══════════════╪═════════════╡
│ 5.1          ┆ 3.5         ┆ 1.4          ┆ 0.2         │
│ 4.9          ┆ 3.0         ┆ 1.4          ┆ 0.2         │
│ 4.7          ┆ 3.2         ┆ 1.3          ┆ 0.2         │
└──────────────┴─────────────┴──────────────┴─────────────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select only numeric columns</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris) <span class="sc">%&gt;%</span> </span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span> </span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 4)
┌──────────────┬─────────────┬──────────────┬─────────────┐
│ Sepal.Length ┆ Sepal.Width ┆ Petal.Length ┆ Petal.Width │
│ ---          ┆ ---         ┆ ---          ┆ ---         │
│ f64          ┆ f64         ┆ f64          ┆ f64         │
╞══════════════╪═════════════╪══════════════╪═════════════╡
│ 5.1          ┆ 3.5         ┆ 1.4          ┆ 0.2         │
│ 4.9          ┆ 3.0         ┆ 1.4          ┆ 0.2         │
│ 4.7          ┆ 3.2         ┆ 1.3          ┆ 0.2         │
└──────────────┴─────────────┴──────────────┴─────────────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select only factor columns</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(iris[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="fu">sapply</span>(iris, is.factor)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  iris[1:3, sapply(iris, is.factor)]
1                             setosa
2                             setosa
3                             setosa</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select only numeric columns</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>iris[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="fu">sapply</span>(iris, is.numeric)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width
1          5.1         3.5          1.4         0.2
2          4.9         3.0          1.4         0.2
3          4.7         3.2          1.3         0.2</code></pre>
</div>
</div>
</div>
<div id="tabset-6-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select only factor columns</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span> </span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_if</span>(is.factor) <span class="sc">%&gt;%</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Species
1  setosa
2  setosa
3  setosa</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select only numeric columns</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span> </span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_if</span>(is.numeric) <span class="sc">%&gt;%</span></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width
1          5.1         3.5          1.4         0.2
2          4.9         3.0          1.4         0.2
3          4.7         3.2          1.3         0.2</code></pre>
</div>
</div>
</div>
<div id="tabset-6-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select only factor columns</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>iris_dt[, .SD, .SDcols <span class="ot">=</span> is.factor][<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Species
    &lt;fctr&gt;
1:  setosa
2:  setosa
3:  setosa</code></pre>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select only numeric columns</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>iris_dt[, .SD, .SDcols <span class="ot">=</span> is.numeric][<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Sepal.Length Sepal.Width Petal.Length Petal.Width
          &lt;num&gt;       &lt;num&gt;        &lt;num&gt;       &lt;num&gt;
1:          5.1         3.5          1.4         0.2
2:          4.9         3.0          1.4         0.2
3:          4.7         3.2          1.3         0.2</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>You can also select columns from a DataFrame using a name pattern. See <a href="#removing-by-name-pattern">an example by removing a column</a></p>
</div>
</div>
</section>
<section id="selecting-with-a-regex" class="level3" data-number="2.5.3">
<h3 data-number="2.5.3" class="anchored" data-anchor-id="selecting-with-a-regex"><span class="header-section-number">2.5.3</span> Selecting with a regex</h3>
<p>To select columns with a regex from a <code>DataFrame</code>, you can pass it in <code>pl$col</code> expression. For example, to select all columns that starts with “Sepal” in iris dataset:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">tidypolars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-4" role="tab" aria-controls="tabset-7-4" aria-selected="false">dplyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-5" role="tab" aria-controls="tabset-7-5" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris)<span class="sc">$</span><span class="fu">select</span>(</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>  pl<span class="sc">$</span><span class="fu">col</span>(<span class="st">"^Sepal.*$"</span>)</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>)<span class="sc">$</span><span class="fu">head</span>(<span class="dv">3</span>) <span class="co"># display the first 3 lines</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 2)
┌──────────────┬─────────────┐
│ Sepal.Length ┆ Sepal.Width │
│ ---          ┆ ---         │
│ f64          ┆ f64         │
╞══════════════╪═════════════╡
│ 5.1          ┆ 3.5         │
│ 4.9          ┆ 3.0         │
│ 4.7          ┆ 3.2         │
└──────────────┴─────────────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris) <span class="sc">%&gt;%</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"Sepal"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 2)
┌──────────────┬─────────────┐
│ Sepal.Length ┆ Sepal.Width │
│ ---          ┆ ---         │
│ f64          ┆ f64         │
╞══════════════╪═════════════╡
│ 5.1          ┆ 3.5         │
│ 4.9          ┆ 3.0         │
│ 4.7          ┆ 3.2         │
└──────────────┴─────────────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>iris[, <span class="fu">grep</span>(<span class="st">"^Sepal.*$"</span>, <span class="fu">colnames</span>(iris))]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Sepal.Length Sepal.Width
1            5.1         3.5
2            4.9         3.0
3            4.7         3.2
4            4.6         3.1
5            5.0         3.6
6            5.4         3.9
7            4.6         3.4
8            5.0         3.4
9            4.4         2.9
10           4.9         3.1
11           5.4         3.7
12           4.8         3.4
13           4.8         3.0
14           4.3         3.0
15           5.8         4.0
16           5.7         4.4
17           5.4         3.9
18           5.1         3.5
19           5.7         3.8
20           5.1         3.8
21           5.4         3.4
22           5.1         3.7
23           4.6         3.6
24           5.1         3.3
25           4.8         3.4
26           5.0         3.0
27           5.0         3.4
28           5.2         3.5
29           5.2         3.4
30           4.7         3.2
31           4.8         3.1
32           5.4         3.4
33           5.2         4.1
34           5.5         4.2
35           4.9         3.1
36           5.0         3.2
37           5.5         3.5
38           4.9         3.6
39           4.4         3.0
40           5.1         3.4
41           5.0         3.5
42           4.5         2.3
43           4.4         3.2
44           5.0         3.5
45           5.1         3.8
46           4.8         3.0
47           5.1         3.8
48           4.6         3.2
49           5.3         3.7
50           5.0         3.3
51           7.0         3.2
52           6.4         3.2
53           6.9         3.1
54           5.5         2.3
55           6.5         2.8
56           5.7         2.8
57           6.3         3.3
58           4.9         2.4
59           6.6         2.9
60           5.2         2.7
61           5.0         2.0
62           5.9         3.0
63           6.0         2.2
64           6.1         2.9
65           5.6         2.9
66           6.7         3.1
67           5.6         3.0
68           5.8         2.7
69           6.2         2.2
70           5.6         2.5
71           5.9         3.2
72           6.1         2.8
73           6.3         2.5
74           6.1         2.8
75           6.4         2.9
76           6.6         3.0
77           6.8         2.8
78           6.7         3.0
79           6.0         2.9
80           5.7         2.6
81           5.5         2.4
82           5.5         2.4
83           5.8         2.7
84           6.0         2.7
85           5.4         3.0
86           6.0         3.4
87           6.7         3.1
88           6.3         2.3
89           5.6         3.0
90           5.5         2.5
91           5.5         2.6
92           6.1         3.0
93           5.8         2.6
94           5.0         2.3
95           5.6         2.7
96           5.7         3.0
97           5.7         2.9
98           6.2         2.9
99           5.1         2.5
100          5.7         2.8
101          6.3         3.3
102          5.8         2.7
103          7.1         3.0
104          6.3         2.9
105          6.5         3.0
106          7.6         3.0
107          4.9         2.5
108          7.3         2.9
109          6.7         2.5
110          7.2         3.6
111          6.5         3.2
112          6.4         2.7
113          6.8         3.0
114          5.7         2.5
115          5.8         2.8
116          6.4         3.2
117          6.5         3.0
118          7.7         3.8
119          7.7         2.6
120          6.0         2.2
121          6.9         3.2
122          5.6         2.8
123          7.7         2.8
124          6.3         2.7
125          6.7         3.3
126          7.2         3.2
127          6.2         2.8
128          6.1         3.0
129          6.4         2.8
130          7.2         3.0
131          7.4         2.8
132          7.9         3.8
133          6.4         2.8
134          6.3         2.8
135          6.1         2.6
136          7.7         3.0
137          6.3         3.4
138          6.4         3.1
139          6.0         3.0
140          6.9         3.1
141          6.7         3.1
142          6.9         3.1
143          5.8         2.7
144          6.8         3.2
145          6.7         3.3
146          6.7         3.0
147          6.3         2.5
148          6.5         3.0
149          6.2         3.4
150          5.9         3.0</code></pre>
</div>
</div>
</div>
<div id="tabset-7-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"Sepal"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width
1          5.1         3.5
2          4.9         3.0
3          4.7         3.2</code></pre>
</div>
</div>
</div>
<div id="tabset-7-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>iris_dt[, .SD, .SDcols <span class="ot">=</span> <span class="fu">grep</span>(<span class="st">"^Sepal"</span>, <span class="fu">colnames</span>(iris_dt))][<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Sepal.Length Sepal.Width
          &lt;num&gt;       &lt;num&gt;
1:          5.1         3.5
2:          4.9         3.0
3:          4.7         3.2</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="selecting---other-ways" class="level3" data-number="2.5.4">
<h3 data-number="2.5.4" class="anchored" data-anchor-id="selecting---other-ways"><span class="header-section-number">2.5.4</span> Selecting - other ways</h3>
<p>The selectors API of polars enables to use other methods to select columns.<br>
Here’s a few examples selecting the first and last column of a <code>DataFrame</code> respectively with <code>first()</code> and <code>last()</code> methods:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select the first column</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris)<span class="sc">$</span><span class="fu">select</span>(</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>  pl<span class="sc">$</span><span class="fu">first</span>()</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>)<span class="sc">$</span><span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 1)
┌──────────────┐
│ Sepal.Length │
│ ---          │
│ f64          │
╞══════════════╡
│ 5.1          │
│ 4.9          │
│ 4.7          │
└──────────────┘</code></pre>
</div>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select the last column</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris)<span class="sc">$</span><span class="fu">select</span>(</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>  pl<span class="sc">$</span><span class="fu">last</span>()</span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>)<span class="sc">$</span><span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 1)
┌─────────┐
│ Species │
│ ---     │
│ cat     │
╞═════════╡
│ setosa  │
│ setosa  │
│ setosa  │
└─────────┘</code></pre>
</div>
</div>
</section>
</section>
<section id="modifyadd-columns" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="modifyadd-columns"><span class="header-section-number">2.6</span> Modify/Add columns</h2>
<section id="modify-existing-column" class="level3" data-number="2.6.1">
<h3 data-number="2.6.1" class="anchored" data-anchor-id="modify-existing-column"><span class="header-section-number">2.6.1</span> Modify existing column</h3>
<p>Similar to the dplyr package, the <code>select()</code> method can also be used to <strong>modify existing data</strong>. However, the result will exclude any columns that were not specified in the expression.</p>
<p>For example, if we want to get in the data.frame iris the <code>Petal.Length</code> column rounded without decimals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris)<span class="sc">$</span><span class="fu">select</span>(</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>  pl<span class="sc">$</span><span class="fu">col</span>(<span class="st">"Petal.Length"</span>)<span class="sc">$</span><span class="fu">round</span>(<span class="at">decimals =</span> <span class="dv">0</span>)</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>)<span class="sc">$</span><span class="fu">head</span>(<span class="dv">3</span>) <span class="co"># display the first 3 lines</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 1)
┌──────────────┐
│ Petal.Length │
│ ---          │
│ f64          │
╞══════════════╡
│ 1.0          │
│ 1.0          │
│ 1.0          │
└──────────────┘</code></pre>
</div>
</div>
<p>The problem here is that we would like to keep all the iris columns and not just <code>Petal.Length</code>.</p>
<p>Again, let’s look at the official documentation:</p>
<blockquote class="blockquote">
<p>To modify or add some columns—whilst preserving all others in the dataset—it is therefore better to use the <code>with_columns()</code> method.</p>
</blockquote>
<p>Note that the <code>with_columns()</code> method only accepts expressions. Let’s use it in an example:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">tidypolars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-4" role="tab" aria-controls="tabset-8-4" aria-selected="false">dplyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-5" role="tab" aria-controls="tabset-8-5" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris)<span class="sc">$</span><span class="fu">with_columns</span>(</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>  pl<span class="sc">$</span><span class="fu">col</span>(<span class="st">"Petal.Length"</span>)<span class="sc">$</span><span class="fu">round</span>(<span class="at">decimals =</span> <span class="dv">0</span>)</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>)<span class="sc">$</span><span class="fu">head</span>(<span class="dv">3</span>) <span class="co"># display the first 3 lines</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 5)
┌──────────────┬─────────────┬──────────────┬─────────────┬─────────┐
│ Sepal.Length ┆ Sepal.Width ┆ Petal.Length ┆ Petal.Width ┆ Species │
│ ---          ┆ ---         ┆ ---          ┆ ---         ┆ ---     │
│ f64          ┆ f64         ┆ f64          ┆ f64         ┆ cat     │
╞══════════════╪═════════════╪══════════════╪═════════════╪═════════╡
│ 5.1          ┆ 3.5         ┆ 1.0          ┆ 0.2         ┆ setosa  │
│ 4.9          ┆ 3.0         ┆ 1.0          ┆ 0.2         ┆ setosa  │
│ 4.7          ┆ 3.2         ┆ 1.0          ┆ 0.2         ┆ setosa  │
└──────────────┴─────────────┴──────────────┴─────────────┴─────────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris) <span class="sc">|&gt;</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Petal.Length =</span> <span class="fu">round</span>(Petal.Length,<span class="dv">0</span>)) <span class="sc">|&gt;</span></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 5)
┌──────────────┬─────────────┬──────────────┬─────────────┬─────────┐
│ Sepal.Length ┆ Sepal.Width ┆ Petal.Length ┆ Petal.Width ┆ Species │
│ ---          ┆ ---         ┆ ---          ┆ ---         ┆ ---     │
│ f64          ┆ f64         ┆ f64          ┆ f64         ┆ cat     │
╞══════════════╪═════════════╪══════════════╪═════════════╪═════════╡
│ 5.1          ┆ 3.5         ┆ 1.0          ┆ 0.2         ┆ setosa  │
│ 4.9          ┆ 3.0         ┆ 1.0          ┆ 0.2         ┆ setosa  │
│ 4.7          ┆ 3.2         ┆ 1.0          ┆ 0.2         ┆ setosa  │
└──────────────┴─────────────┴──────────────┴─────────────┴─────────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>iris<span class="sc">$</span>Petal.Length <span class="ot">&lt;-</span> <span class="fu">round</span>(iris<span class="sc">$</span>Petal.Length, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>iris[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1          5.1         3.5            1         0.2  setosa
2          4.9         3.0            1         0.2  setosa
3          4.7         3.2            1         0.2  setosa</code></pre>
</div>
</div>
</div>
<div id="tabset-8-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span></span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Petal.Length =</span> <span class="fu">round</span>(Petal.Length,<span class="dv">0</span>)) <span class="sc">|&gt;</span></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1          5.1         3.5            1         0.2  setosa
2          4.9         3.0            1         0.2  setosa
3          4.7         3.2            1         0.2  setosa</code></pre>
</div>
</div>
</div>
<div id="tabset-8-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>iris_dt[,Petal.Length <span class="sc">:</span><span class="er">=</span> <span class="fu">round</span>(Petal.Length, <span class="at">digits =</span> <span class="dv">0</span>)]</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>iris_dt[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
          &lt;num&gt;       &lt;num&gt;        &lt;num&gt;       &lt;num&gt;  &lt;fctr&gt;
1:          5.1         3.5            1         0.2  setosa
2:          4.9         3.0            1         0.2  setosa
3:          4.7         3.2            1         0.2  setosa</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="add-a-new-column" class="level3" data-number="2.6.2">
<h3 data-number="2.6.2" class="anchored" data-anchor-id="add-a-new-column"><span class="header-section-number">2.6.2</span> Add a new column</h3>
<p>If you want to add a column to a data.frame, you use the same syntax as above with <code>with_columns()</code>. Simply use the <code>alias()</code> method to specify the name of the newly created column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris)<span class="sc">$</span><span class="fu">with_columns</span>(</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>  pl<span class="sc">$</span><span class="fu">col</span>(<span class="st">"Petal.Length"</span>)<span class="sc">$</span><span class="fu">round</span>(<span class="at">decimals =</span> <span class="dv">0</span>)<span class="sc">$</span><span class="fu">alias</span>(<span class="st">"Petal.Length.rounded"</span>)</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>)<span class="sc">$</span><span class="fu">head</span>(<span class="dv">3</span>) <span class="co"># display the first 3 lines</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 6)
┌──────────────┬─────────────┬──────────────┬─────────────┬─────────┬──────────────────────┐
│ Sepal.Length ┆ Sepal.Width ┆ Petal.Length ┆ Petal.Width ┆ Species ┆ Petal.Length.rounded │
│ ---          ┆ ---         ┆ ---          ┆ ---         ┆ ---     ┆ ---                  │
│ f64          ┆ f64         ┆ f64          ┆ f64         ┆ cat     ┆ f64                  │
╞══════════════╪═════════════╪══════════════╪═════════════╪═════════╪══════════════════════╡
│ 5.1          ┆ 3.5         ┆ 1.4          ┆ 0.2         ┆ setosa  ┆ 1.0                  │
│ 4.9          ┆ 3.0         ┆ 1.4          ┆ 0.2         ┆ setosa  ┆ 1.0                  │
│ 4.7          ┆ 3.2         ┆ 1.3          ┆ 0.2         ┆ setosa  ┆ 1.0                  │
└──────────────┴─────────────┴──────────────┴─────────────┴─────────┴──────────────────────┘</code></pre>
</div>
</div>
</section>
<section id="add-a-new-column-with-a-constant-value" class="level3" data-number="2.6.3">
<h3 data-number="2.6.3" class="anchored" data-anchor-id="add-a-new-column-with-a-constant-value"><span class="header-section-number">2.6.3</span> Add a new column with a constant value</h3>
<p>If you need to <strong>create a new column with a constant value</strong> (i.e.&nbsp;the same value for all the rows in your DataFrame), you can use the literal <code>lit()</code> method. It works with the main types of Polars.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris)<span class="sc">$</span><span class="fu">with_columns</span>(</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>  pl<span class="sc">$</span><span class="fu">lit</span>(<span class="st">"toto"</span>)<span class="sc">$</span><span class="fu">alias</span>(<span class="st">"mynewcolumn"</span>)</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>)<span class="sc">$</span><span class="fu">head</span>(<span class="dv">3</span>) <span class="co"># display the first 3 lines</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 6)
┌──────────────┬─────────────┬──────────────┬─────────────┬─────────┬─────────────┐
│ Sepal.Length ┆ Sepal.Width ┆ Petal.Length ┆ Petal.Width ┆ Species ┆ mynewcolumn │
│ ---          ┆ ---         ┆ ---          ┆ ---         ┆ ---     ┆ ---         │
│ f64          ┆ f64         ┆ f64          ┆ f64         ┆ cat     ┆ str         │
╞══════════════╪═════════════╪══════════════╪═════════════╪═════════╪═════════════╡
│ 5.1          ┆ 3.5         ┆ 1.4          ┆ 0.2         ┆ setosa  ┆ toto        │
│ 4.9          ┆ 3.0         ┆ 1.4          ┆ 0.2         ┆ setosa  ┆ toto        │
│ 4.7          ┆ 3.2         ┆ 1.3          ┆ 0.2         ┆ setosa  ┆ toto        │
└──────────────┴─────────────┴──────────────┴─────────────┴─────────┴─────────────┘</code></pre>
</div>
</div>
</section>
<section id="add-a-new-column-based-on-conditions" class="level3" data-number="2.6.4">
<h3 data-number="2.6.4" class="anchored" data-anchor-id="add-a-new-column-based-on-conditions"><span class="header-section-number">2.6.4</span> Add a new column based on conditions</h3>
<p>To add new columns based on conditions, the <code>when-then-otherwise</code> expression must be used.</p>
<p>Here’s the syntax:</p>
<pre><code>pl$when(**Boolean Expression**)$
  then(**Value if True**)$
  otherwise(**Value if False)$
  alias(**New Column Name**)</code></pre>
<p>Here’s an example with equivalent syntax to help you understand:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false">tidypolars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-4" role="tab" aria-controls="tabset-9-4" aria-selected="false">dplyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-5" role="tab" aria-controls="tabset-9-5" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris)<span class="sc">$</span><span class="fu">with_columns</span>(</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>  pl<span class="sc">$</span><span class="fu">when</span>(pl<span class="sc">$</span><span class="fu">col</span>(<span class="st">"Petal.Length"</span>) <span class="sc">&lt;=</span> <span class="dv">2</span>)<span class="sc">$</span><span class="fu">then</span>(pl<span class="sc">$</span><span class="fu">lit</span>(<span class="st">"&lt;=2"</span>))<span class="sc">$</span></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">when</span>(pl<span class="sc">$</span><span class="fu">col</span>(<span class="st">"Petal.Length"</span>) <span class="sc">&lt;=</span> <span class="dv">5</span>)<span class="sc">$</span><span class="fu">then</span>(pl<span class="sc">$</span><span class="fu">lit</span>(<span class="st">"&lt;=5"</span>))<span class="sc">$</span></span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">otherwise</span>(pl<span class="sc">$</span><span class="fu">lit</span>(<span class="st">"&gt;5"</span>))<span class="sc">$</span></span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">alias</span>(<span class="st">"mygroups"</span>))<span class="sc">$</span></span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># we only need to display 2 variables to check that it's OK</span></span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"Petal.Length"</span>,<span class="st">"mygroups"</span>))[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">59</span>,<span class="dv">150</span>),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (4, 2)
┌──────────────┬──────────┐
│ Petal.Length ┆ mygroups │
│ ---          ┆ ---      │
│ f64          ┆ str      │
╞══════════════╪══════════╡
│ 1.4          ┆ &lt;=2      │
│ 1.4          ┆ &lt;=2      │
│ 4.6          ┆ &lt;=5      │
│ 5.1          ┆ &gt;5       │
└──────────────┴──────────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>iris<span class="sc">$</span>mygroups <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(iris<span class="sc">$</span>Petal.Length <span class="sc">&lt;=</span> <span class="dv">2</span>, <span class="st">"&lt;=2"</span>,</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">ifelse</span>(iris<span class="sc">$</span>Petal.Length <span class="sc">&lt;=</span> <span class="dv">5</span>, <span class="st">"&lt;=5"</span>, <span class="st">"&gt;5"</span>))</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a><span class="co"># we only need to display 2 variables to check that it's OK</span></span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>iris[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">59</span>,<span class="dv">150</span>), <span class="fu">c</span>(<span class="st">"Petal.Length"</span>, <span class="st">"mygroups"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Petal.Length mygroups
1            1.4      &lt;=2
2            1.4      &lt;=2
59           4.6      &lt;=5
150          5.1       &gt;5</code></pre>
</div>
</div>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris) <span class="sc">%&gt;%</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">mygroups =</span> <span class="fu">case_when</span>(</span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>      Petal.Length <span class="sc">&lt;=</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"&lt;=2"</span>,</span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>      Petal.Length <span class="sc">&lt;=</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"&lt;=5"</span>,</span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"&gt;5"</span>          <span class="co"># équivalent de .default</span></span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Petal.Length, mygroups) <span class="sc">%&gt;%</span></span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 2)
┌──────────────┬──────────┐
│ Petal.Length ┆ mygroups │
│ ---          ┆ ---      │
│ f64          ┆ str      │
╞══════════════╪══════════╡
│ 1.4          ┆ &lt;=2      │
│ 1.4          ┆ &lt;=2      │
│ 1.3          ┆ &lt;=2      │
└──────────────┴──────────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-9-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">mygroups =</span> <span class="fu">case_when</span>(</span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>      Petal.Length <span class="sc">&lt;=</span><span class="dv">2</span> <span class="sc">~</span> <span class="st">"&lt;=2"</span>,</span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a>      Petal.Length <span class="sc">&lt;=</span><span class="dv">5</span> <span class="sc">~</span> <span class="st">"&lt;=5"</span>,</span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">.default =</span> <span class="st">"&gt;5"</span>)</span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># we only need to display 2 variables  to check that it's OK</span></span>
<span id="cb164-9"><a href="#cb164-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Petal.Length,mygroups) <span class="sc">|&gt;</span></span>
<span id="cb164-10"><a href="#cb164-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">59</span>,<span class="dv">150</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Petal.Length mygroups
1          1.4      &lt;=2
2          1.4      &lt;=2
3          4.6      &lt;=5
4          5.1       &gt;5</code></pre>
</div>
</div>
</div>
<div id="tabset-9-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>iris_dt[, mygroups <span class="sc">:</span><span class="er">=</span> <span class="fu">case_when</span>(</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>  Petal.Length <span class="sc">&lt;=</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"&lt;=2"</span>,</span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>  Petal.Length <span class="sc">&lt;=</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"&lt;=5"</span>,</span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"&gt;5"</span></span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a>)]</span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a><span class="co"># we only need to display 2 variables to check that it's OK</span></span>
<span id="cb166-7"><a href="#cb166-7" aria-hidden="true" tabindex="-1"></a>iris_dt[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">59</span>,<span class="dv">150</span>), .(Petal.Length, mygroups)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Petal.Length mygroups
          &lt;num&gt;   &lt;char&gt;
1:            1      &lt;=2
2:            1      &lt;=2
3:            5      &lt;=5
4:            5      &lt;=5</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="add-a-new-column-by-group" class="level3" data-number="2.6.5">
<h3 data-number="2.6.5" class="anchored" data-anchor-id="add-a-new-column-by-group"><span class="header-section-number">2.6.5</span> Add a new column by group</h3>
<p>To add new columns by group, the <code>over</code> expression must be used. This expression is similar to performing a groupby aggregation and joining the result back into the original dataframe. Here’s an example with equivalent syntax to help you understand:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">c</span>(<span class="st">"X"</span>,<span class="st">"X"</span>,<span class="st">"Y"</span>,<span class="st">"Y"</span>,<span class="st">"Z"</span>,<span class="st">"Z"</span>),</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">adress =</span> <span class="fu">c</span>(<span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"C"</span>,<span class="st">"D"</span>,<span class="st">"E"</span>,<span class="st">"F"</span>),</span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">col2 =</span> <span class="fu">c</span>(2L,4L,1L,3L,4L,2L),</span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">col3 =</span> <span class="fu">c</span>(5L,19L,17L,12L,11L,15L)</span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  name adress col2 col3
1    X      A    2    5
2    X      B    4   19
3    Y      C    1   17
4    Y      D    3   12
5    Z      E    4   11
6    Z      F    2   15</code></pre>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-3" role="tab" aria-controls="tabset-10-3" aria-selected="false">dplyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-4" role="tab" aria-controls="tabset-10-4" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(df)<span class="sc">$</span><span class="fu">with_columns</span>(</span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>  pl<span class="sc">$</span><span class="fu">col</span>(<span class="st">"col3"</span>)<span class="sc">$</span><span class="fu">max</span>()<span class="sc">$</span><span class="fu">over</span>(<span class="st">"name"</span>)<span class="sc">$</span>name<span class="sc">$</span><span class="fu">suffix</span>(<span class="st">"_max"</span>)</span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (6, 5)
┌──────┬────────┬──────┬──────┬──────────┐
│ name ┆ adress ┆ col2 ┆ col3 ┆ col3_max │
│ ---  ┆ ---    ┆ ---  ┆ ---  ┆ ---      │
│ str  ┆ str    ┆ i32  ┆ i32  ┆ i32      │
╞══════╪════════╪══════╪══════╪══════════╡
│ X    ┆ A      ┆ 2    ┆ 5    ┆ 19       │
│ X    ┆ B      ┆ 4    ┆ 19   ┆ 19       │
│ Y    ┆ C      ┆ 1    ┆ 17   ┆ 17       │
│ Y    ┆ D      ┆ 3    ┆ 12   ┆ 17       │
│ Z    ┆ E      ┆ 4    ┆ 11   ┆ 15       │
│ Z    ┆ F      ┆ 2    ┆ 15   ┆ 15       │
└──────┴────────┴──────┴──────┴──────────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(col3 <span class="sc">~</span> name, <span class="at">data =</span> df, <span class="at">FUN =</span> max)</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(result) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"name"</span>, <span class="st">"col3_max"</span>)</span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a><span class="fu">merge</span>(df, result, <span class="at">by =</span> <span class="st">"name"</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  name adress col2 col3 col3_max
1    X      A    2    5       19
2    X      B    4   19       19
3    Y      C    1   17       17
4    Y      D    3   12       17
5    Z      E    4   11       15
6    Z      F    2   15       15</code></pre>
</div>
</div>
</div>
<div id="tabset-10-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">|&gt;</span></span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">col3_max =</span> <span class="fu">max</span>(col3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
# Groups:   name [3]
  name  adress  col2  col3 col3_max
  &lt;chr&gt; &lt;chr&gt;  &lt;int&gt; &lt;int&gt;    &lt;int&gt;
1 X     A          2     5       19
2 X     B          4    19       19
3 Y     C          1    17       17
4 Y     D          3    12       17
5 Z     E          4    11       15
6 Z     F          2    15       15</code></pre>
</div>
</div>
</div>
<div id="tabset-10-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(df)</span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>dt[, col3_max <span class="sc">:</span><span class="er">=</span> <span class="fu">max</span>(col3), by <span class="ot">=</span> name]</span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>dt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     name adress  col2  col3 col3_max
   &lt;char&gt; &lt;char&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;
1:      X      A     2     5       19
2:      X      B     4    19       19
3:      Y      C     1    17       17
4:      Y      D     3    12       17
5:      Z      E     4    11       15
6:      Z      F     2    15       15</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you need to pass multiple column names in the <code>over</code> expression, you can either list them like this <code>over("name","adress")</code> or - more conveniently - use a character vector <code>over(c("name","adress"))</code>.</p>
</div>
</div>
</section>
</section>
<section id="rename-columns-1" class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="rename-columns-1"><span class="header-section-number">2.7</span> Rename columns</h2>
<p>Similar to the dplyr package, the <code>rename()</code> method can also be used to rename existing column.<br>
The renaming logic is NOT identical to that of <code>dplyr</code>, and is performed as follows: <code>old_name="new_name"</code>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note the double quotes <code>""</code> surrounding the name of the old variable to be renamed which does not exist with <code>dplyr</code> (see examples below).</p>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-3" role="tab" aria-controls="tabset-11-3" aria-selected="false">dplyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-4" role="tab" aria-controls="tabset-11-4" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris)<span class="sc">$</span></span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sepal.Length =</span> <span class="st">"sepal_length"</span>, </span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sepal.Width =</span> <span class="st">"sepal_width"</span>,</span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Petal.Length =</span> <span class="st">"length of petal"</span>,</span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Petal.Width =</span> <span class="st">"width of petal"</span>,</span>
<span id="cb178-8"><a href="#cb178-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Species =</span> <span class="st">"species"</span></span>
<span id="cb178-9"><a href="#cb178-9" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">$</span>columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "sepal_length"    "sepal_width"     "length of petal" "width of petal" 
[5] "species"        </code></pre>
</div>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(iris) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"sepal_length"</span>,<span class="st">"sepal_width"</span>,<span class="st">"length of petal"</span>,<span class="st">"width of petal"</span>,<span class="st">"species"</span>)</span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "sepal_length"    "sepal_width"     "length of petal" "width of petal" 
[5] "species"        </code></pre>
</div>
</div>
</div>
<div id="tabset-11-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span></span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">sepal_length =</span> Sepal.Length, </span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sepal_width =</span> Sepal.Width,</span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">length of petal</span><span class="st">`</span> <span class="ot">=</span> Petal.Length,</span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">width of petal</span><span class="st">`</span> <span class="ot">=</span> Petal.Width,</span>
<span id="cb182-8"><a href="#cb182-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">species =</span> Species</span>
<span id="cb182-9"><a href="#cb182-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb182-10"><a href="#cb182-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "sepal_length"    "sepal_width"     "length of petal" "width of petal" 
[5] "species"        </code></pre>
</div>
</div>
</div>
<div id="tabset-11-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setnames</span>(iris_dt, </span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">old =</span> <span class="fu">c</span>(<span class="st">"Sepal.Length"</span>, <span class="st">"Sepal.Width"</span>, <span class="st">"Petal.Length"</span>, <span class="st">"Petal.Width"</span>, <span class="st">"Species"</span>),</span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">new =</span> <span class="fu">c</span>(<span class="st">"sepal_length"</span>, <span class="st">"sepal_width"</span>, <span class="st">"length_of_petal"</span>, <span class="st">"width_of_petal"</span>, <span class="st">"species"</span>))</span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(iris_dt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "sepal_length"    "sepal_width"     "length_of_petal" "width_of_petal" 
[5] "species"         "mygroups"       </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="remove-columns" class="level2" data-number="2.8">
<h2 data-number="2.8" class="anchored" data-anchor-id="remove-columns"><span class="header-section-number">2.8</span> Remove columns</h2>
<section id="removing-by-name" class="level3" data-number="2.8.1">
<h3 data-number="2.8.1" class="anchored" data-anchor-id="removing-by-name"><span class="header-section-number">2.8.1</span> Removing by name</h3>
<p>To remove columns from a DataFrame, the <code>drop</code> method must be used.<br>
Here’s an example with equivalent syntax:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-3" role="tab" aria-controls="tabset-12-3" aria-selected="false">dplyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-4" role="tab" aria-controls="tabset-12-4" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris)<span class="sc">$</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop</span>(<span class="fu">c</span>(<span class="st">"Petal.Width"</span>,<span class="st">"Sepal.Length"</span>,<span class="st">"Sepal.Width"</span>))<span class="sc">$</span></span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 2)
┌──────────────┬─────────┐
│ Petal.Length ┆ Species │
│ ---          ┆ ---     │
│ f64          ┆ cat     │
╞══════════════╪═════════╡
│ 1.4          ┆ setosa  │
│ 1.4          ┆ setosa  │
│ 1.3          ┆ setosa  │
└──────────────┴─────────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>iris[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="sc">!</span>(<span class="fu">names</span>(iris) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Petal.Width"</span>,<span class="st">"Sepal.Length"</span>,<span class="st">"Sepal.Width"</span>))]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Petal.Length Species
1          1.4  setosa
2          1.4  setosa
3          1.3  setosa</code></pre>
</div>
</div>
</div>
<div id="tabset-12-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Petal.Width,Sepal.Length,Sepal.Width)) <span class="sc">|&gt;</span></span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Petal.Length Species
1          1.4  setosa
2          1.4  setosa
3          1.3  setosa</code></pre>
</div>
</div>
</div>
<div id="tabset-12-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>iris_dt[, <span class="fu">c</span>(<span class="st">"Petal.Width"</span>,<span class="st">"Sepal.Length"</span>,<span class="st">"Sepal.Width"</span>) <span class="sc">:</span><span class="er">=</span> <span class="cn">NULL</span>][<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Petal.Length Species
          &lt;num&gt;  &lt;fctr&gt;
1:          1.4  setosa
2:          1.4  setosa
3:          1.3  setosa</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="removing-with-a-regex" class="level3" data-number="2.8.2">
<h3 data-number="2.8.2" class="anchored" data-anchor-id="removing-with-a-regex"><span class="header-section-number">2.8.2</span> Removing with a regex</h3>
<p>To remove columns with a regex from a DataFrame, the <code>drop</code> expression must be used.<br>
Let’s see an example where you want to drop columns whose names starts with “Petal” in <code>iris</code>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-3" role="tab" aria-controls="tabset-13-3" aria-selected="false">dplyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-4" role="tab" aria-controls="tabset-13-4" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>num_to_drop <span class="ot">&lt;-</span> <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"^Petal"</span>,<span class="fu">as_polars_df</span>(iris)<span class="sc">$</span>columns)</span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>col_to_drop <span class="ot">&lt;-</span> <span class="fu">as_polars_df</span>(iris)<span class="sc">$</span>columns[num_to_drop]</span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris)<span class="sc">$</span></span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop</span>(col_to_drop)<span class="sc">$</span></span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 2)
┌──────────────┬─────────────┐
│ Petal.Length ┆ Petal.Width │
│ ---          ┆ ---         │
│ f64          ┆ f64         │
╞══════════════╪═════════════╡
│ 1.4          ┆ 0.2         │
│ 1.4          ┆ 0.2         │
│ 1.3          ┆ 0.2         │
└──────────────┴─────────────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>iris[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"^Petal"</span>,<span class="fu">names</span>(iris))]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Species
1          5.1         3.5  setosa
2          4.9         3.0  setosa
3          4.7         3.2  setosa</code></pre>
</div>
</div>
</div>
<div id="tabset-13-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">starts_with</span>(<span class="st">"Petal"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Species
1          5.1         3.5  setosa
2          4.9         3.0  setosa
3          4.7         3.2  setosa</code></pre>
</div>
</div>
</div>
<div id="tabset-13-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>iris_dt[, <span class="fu">which</span>(<span class="fu">grepl</span>(<span class="st">"^Petal$"</span>, <span class="fu">names</span>(iris_dt)))<span class="sc">:</span><span class="er">=</span><span class="cn">NULL</span>][<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Petal.Length Species
          &lt;num&gt;  &lt;fctr&gt;
1:          1.4  setosa
2:          1.4  setosa
3:          1.3  setosa</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>All the ways we’ve seen in the section about selecting columns from a <code>DataFrame</code> (by name, data type and with a list) also work with <code>drop()</code> method!</p>
</div>
</div>
</section>
</section>
<section id="aggregation-by-group" class="level2" data-number="2.9">
<h2 data-number="2.9" class="anchored" data-anchor-id="aggregation-by-group"><span class="header-section-number">2.9</span> Aggregation by group</h2>
<p>Another frequently used data manipulation is the aggregation of data by group. To do this, we indicate in the <code>group_by()</code> method which column will be used to group the data.frame. And the <code>agg()</code> method which specifies the expression to aggregate.</p>
<p>The methods available for the <code>agg()</code> method are (in each group):</p>
<ul>
<li><code>first()</code> get the first element</li>
<li><code>last()</code> get the last element</li>
<li><code>n_unique()</code> get the number of unique elements</li>
<li><code>count()</code> get the number of elements</li>
<li><code>sum()</code> sum the elements</li>
<li><code>min()</code> get the smallest element</li>
<li><code>max()</code> get the largest element</li>
<li><code>mean()</code> get the average of elements</li>
<li><code>median()</code> get the median</li>
<li><code>quantile()</code> calculate quantiles</li>
</ul>
<p>Here’s a minimal example with <code>sum</code> and <code>mean</code> applied to 2 different columns:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-3" role="tab" aria-controls="tabset-14-3" aria-selected="false">dplyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-4" role="tab" aria-controls="tabset-14-4" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris)<span class="sc">$</span></span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">"Species"</span>)<span class="sc">$</span></span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">agg</span>(pl<span class="sc">$</span><span class="fu">sum</span>(<span class="st">"Petal.Length"</span>),pl<span class="sc">$</span><span class="fu">col</span>(<span class="st">"Petal.Width"</span>)<span class="sc">$</span><span class="fu">mean</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 3)
┌────────────┬──────────────┬─────────────┐
│ Species    ┆ Petal.Length ┆ Petal.Width │
│ ---        ┆ ---          ┆ ---         │
│ cat        ┆ f64          ┆ f64         │
╞════════════╪══════════════╪═════════════╡
│ virginica  ┆ 277.6        ┆ 2.026       │
│ versicolor ┆ 213.0        ┆ 1.326       │
│ setosa     ┆ 73.1         ┆ 0.246       │
└────────────┴──────────────┴─────────────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(Petal.Length <span class="sc">~</span> Species, <span class="at">data =</span> iris, <span class="at">FUN =</span> sum)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Species Petal.Length
1     setosa         73.1
2 versicolor        213.0
3  virginica        277.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(Petal.Width <span class="sc">~</span> Species, <span class="at">data =</span> iris, <span class="at">FUN =</span> mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Species Petal.Width
1     setosa       0.246
2 versicolor       1.326
3  virginica       2.026</code></pre>
</div>
</div>
</div>
<div id="tabset-14-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Species) <span class="sc">%&gt;%</span></span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb208-5"><a href="#cb208-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Petal.Length_sum =</span> <span class="fu">sum</span>(Petal.Length),</span>
<span id="cb208-6"><a href="#cb208-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Petal.Width_mean =</span> <span class="fu">mean</span>(Petal.Width)</span>
<span id="cb208-7"><a href="#cb208-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  Species    Petal.Length_sum Petal.Width_mean
  &lt;fct&gt;                 &lt;dbl&gt;            &lt;dbl&gt;
1 setosa                 73.1            0.246
2 versicolor            213              1.33 
3 virginica             278.             2.03 </code></pre>
</div>
</div>
</div>
<div id="tabset-14-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>iris_dt <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(iris)</span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a>iris_dt[, .(<span class="at">Petal.Length =</span> <span class="fu">sum</span>(Petal.Length), <span class="at">Petal.Width =</span> <span class="fu">mean</span>(Petal.Width)), by <span class="ot">=</span> Species]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Species Petal.Length Petal.Width
       &lt;fctr&gt;        &lt;num&gt;       &lt;num&gt;
1:     setosa         73.1       0.246
2: versicolor        213.0       1.326
3:  virginica        277.6       2.026</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Be careful! <strong>Calling multiple aggregations on the same column produces columns of the same name</strong> which generates an error with R.</p>
<p>You can use the <code>alias()</code> or <code>suffix()</code> method to ensure column names are unique. For example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris)<span class="sc">$</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">"Species"</span>)<span class="sc">$</span></span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">agg</span>(</span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># With alias()</span></span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a>    pl<span class="sc">$</span><span class="fu">col</span>(<span class="fu">c</span>(<span class="st">"Petal.Length"</span>))<span class="sc">$</span><span class="fu">sum</span>()<span class="sc">$</span><span class="fu">alias</span>(<span class="st">"Petal.Length_Sum"</span>),</span>
<span id="cb212-6"><a href="#cb212-6" aria-hidden="true" tabindex="-1"></a>    pl<span class="sc">$</span><span class="fu">col</span>(<span class="fu">c</span>(<span class="st">"Petal.Length"</span>))<span class="sc">$</span><span class="fu">mean</span>()<span class="sc">$</span><span class="fu">alias</span>(<span class="st">"Petal.Length_Mean"</span>),</span>
<span id="cb212-7"><a href="#cb212-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># With suffix()</span></span>
<span id="cb212-8"><a href="#cb212-8" aria-hidden="true" tabindex="-1"></a>    pl<span class="sc">$</span><span class="fu">col</span>(<span class="fu">c</span>(<span class="st">"Petal.Width"</span>))<span class="sc">$</span><span class="fu">sum</span>()<span class="sc">$</span>name<span class="sc">$</span><span class="fu">suffix</span>(<span class="st">"_Sum"</span>),</span>
<span id="cb212-9"><a href="#cb212-9" aria-hidden="true" tabindex="-1"></a>    pl<span class="sc">$</span><span class="fu">col</span>(<span class="fu">c</span>(<span class="st">"Petal.Width"</span>))<span class="sc">$</span><span class="fu">mean</span>()<span class="sc">$</span>name<span class="sc">$</span><span class="fu">suffix</span>(<span class="st">"_Mean"</span>)</span>
<span id="cb212-10"><a href="#cb212-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 5)
┌────────────┬──────────────────┬───────────────────┬─────────────────┬──────────────────┐
│ Species    ┆ Petal.Length_Sum ┆ Petal.Length_Mean ┆ Petal.Width_Sum ┆ Petal.Width_Mean │
│ ---        ┆ ---              ┆ ---               ┆ ---             ┆ ---              │
│ cat        ┆ f64              ┆ f64               ┆ f64             ┆ f64              │
╞════════════╪══════════════════╪═══════════════════╪═════════════════╪══════════════════╡
│ virginica  ┆ 277.6            ┆ 5.552             ┆ 101.3           ┆ 2.026            │
│ versicolor ┆ 213.0            ┆ 4.26              ┆ 66.3            ┆ 1.326            │
│ setosa     ┆ 73.1             ┆ 1.462             ┆ 12.3            ┆ 0.246            │
└────────────┴──────────────────┴───────────────────┴─────────────────┴──────────────────┘</code></pre>
</div>
</div>
</div>
</div>
<p>You can perform more advanced aggregations, for example <strong>calculate the sum of all the floating point columns</strong> in iris:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-3" role="tab" aria-controls="tabset-15-3" aria-selected="false">dplyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-4" role="tab" aria-controls="tabset-15-4" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris)<span class="sc">$</span></span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">"Species"</span>)<span class="sc">$</span></span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">agg</span>(pl<span class="sc">$</span><span class="fu">col</span>(pl<span class="sc">$</span>Float64)<span class="sc">$</span><span class="fu">sum</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 5)
┌────────────┬──────────────┬─────────────┬──────────────┬─────────────┐
│ Species    ┆ Sepal.Length ┆ Sepal.Width ┆ Petal.Length ┆ Petal.Width │
│ ---        ┆ ---          ┆ ---         ┆ ---          ┆ ---         │
│ cat        ┆ f64          ┆ f64         ┆ f64          ┆ f64         │
╞════════════╪══════════════╪═════════════╪══════════════╪═════════════╡
│ virginica  ┆ 329.4        ┆ 148.7       ┆ 277.6        ┆ 101.3       │
│ setosa     ┆ 250.3        ┆ 171.4       ┆ 73.1         ┆ 12.3        │
│ versicolor ┆ 296.8        ┆ 138.5       ┆ 213.0        ┆ 66.3        │
└────────────┴──────────────┴─────────────┴──────────────┴─────────────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a>iris_sum_by_species_base <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(iris[, <span class="fu">sapply</span>(iris, is.numeric)], <span class="at">by =</span> <span class="fu">list</span>(<span class="at">Species =</span> iris<span class="sc">$</span>Species), <span class="at">FUN =</span> sum)</span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>iris_sum_by_species_base</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Species Sepal.Length Sepal.Width Petal.Length Petal.Width
1     setosa        250.3       171.4         73.1        12.3
2 versicolor        296.8       138.5        213.0        66.3
3  virginica        329.4       148.7        277.6       101.3</code></pre>
</div>
</div>
</div>
<div id="tabset-15-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span></span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Species) <span class="sc">%&gt;%</span></span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), sum))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  Species    Sepal.Length Sepal.Width Petal.Length Petal.Width
  &lt;fct&gt;             &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
1 setosa             250.        171.         73.1        12.3
2 versicolor         297.        138.        213          66.3
3 virginica          329.        149.        278.        101. </code></pre>
</div>
</div>
</div>
<div id="tabset-15-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a>iris_dt <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(iris)</span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>iris_sum_by_species_dt <span class="ot">&lt;-</span> iris_dt[, <span class="fu">lapply</span>(.SD, sum), by <span class="ot">=</span> Species, .SDcols <span class="ot">=</span> <span class="fu">sapply</span>(iris_dt, is.numeric)]</span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>iris_sum_by_species_dt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Species Sepal.Length Sepal.Width Petal.Length Petal.Width
       &lt;fctr&gt;        &lt;num&gt;       &lt;num&gt;        &lt;num&gt;       &lt;num&gt;
1:     setosa        250.3       171.4         73.1        12.3
2: versicolor        296.8       138.5        213.0        66.3
3:  virginica        329.4       148.7        277.6       101.3</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="sort-a-dataframe" class="level2" data-number="2.10">
<h2 data-number="2.10" class="anchored" data-anchor-id="sort-a-dataframe"><span class="header-section-number">2.10</span> Sort a DataFrame</h2>
<section id="simply-sort-a-dataframe" class="level3" data-number="2.10.1">
<h3 data-number="2.10.1" class="anchored" data-anchor-id="simply-sort-a-dataframe"><span class="header-section-number">2.10.1</span> Simply sort a DataFrame</h3>
<p>The <code>sort()</code> method with a character vector can be used to sort a <code>DataFrame</code>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-16-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-1" role="tab" aria-controls="tabset-16-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-2" role="tab" aria-controls="tabset-16-2" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-3" role="tab" aria-controls="tabset-16-3" aria-selected="false">dplyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-4" role="tab" aria-controls="tabset-16-4" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-16-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-16-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort by one column</span></span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris)<span class="sc">$</span></span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sort</span>(<span class="st">"Species"</span>)<span class="sc">$</span></span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 5)
┌──────────────┬─────────────┬──────────────┬─────────────┬─────────┐
│ Sepal.Length ┆ Sepal.Width ┆ Petal.Length ┆ Petal.Width ┆ Species │
│ ---          ┆ ---         ┆ ---          ┆ ---         ┆ ---     │
│ f64          ┆ f64         ┆ f64          ┆ f64         ┆ cat     │
╞══════════════╪═════════════╪══════════════╪═════════════╪═════════╡
│ 5.1          ┆ 3.5         ┆ 1.4          ┆ 0.2         ┆ setosa  │
│ 4.9          ┆ 3.0         ┆ 1.4          ┆ 0.2         ┆ setosa  │
│ 4.7          ┆ 3.2         ┆ 1.3          ┆ 0.2         ┆ setosa  │
└──────────────┴─────────────┴──────────────┴─────────────┴─────────┘</code></pre>
</div>
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort by two columns</span></span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris)<span class="sc">$</span></span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sort</span>(<span class="fu">c</span>(<span class="st">"Species"</span>,<span class="st">"Petal.Length"</span>))<span class="sc">$</span></span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 5)
┌──────────────┬─────────────┬──────────────┬─────────────┬─────────┐
│ Sepal.Length ┆ Sepal.Width ┆ Petal.Length ┆ Petal.Width ┆ Species │
│ ---          ┆ ---         ┆ ---          ┆ ---         ┆ ---     │
│ f64          ┆ f64         ┆ f64          ┆ f64         ┆ cat     │
╞══════════════╪═════════════╪══════════════╪═════════════╪═════════╡
│ 4.6          ┆ 3.6         ┆ 1.0          ┆ 0.2         ┆ setosa  │
│ 4.3          ┆ 3.0         ┆ 1.1          ┆ 0.1         ┆ setosa  │
│ 5.0          ┆ 3.2         ┆ 1.2          ┆ 0.2         ┆ setosa  │
└──────────────┴─────────────┴──────────────┴─────────────┴─────────┘</code></pre>
</div>
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort by two columns one in a decreasing manner and the other in an increasing manner</span></span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris)<span class="sc">$</span></span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sort</span>(pl<span class="sc">$</span><span class="fu">col</span>(<span class="st">"Species"</span>)<span class="sc">$</span><span class="fu">sort</span>(<span class="at">descending =</span> <span class="cn">TRUE</span>),pl<span class="sc">$</span><span class="fu">col</span>(<span class="st">"Petal.Length"</span>)<span class="sc">$</span><span class="fu">sort</span>(<span class="at">descending =</span> <span class="cn">FALSE</span>))<span class="sc">$</span></span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 5)
┌──────────────┬─────────────┬──────────────┬─────────────┬───────────┐
│ Sepal.Length ┆ Sepal.Width ┆ Petal.Length ┆ Petal.Width ┆ Species   │
│ ---          ┆ ---         ┆ ---          ┆ ---         ┆ ---       │
│ f64          ┆ f64         ┆ f64          ┆ f64         ┆ cat       │
╞══════════════╪═════════════╪══════════════╪═════════════╪═══════════╡
│ 6.3          ┆ 3.3         ┆ 6.0          ┆ 2.5         ┆ virginica │
│ 5.8          ┆ 2.7         ┆ 5.1          ┆ 1.9         ┆ virginica │
│ 7.1          ┆ 3.0         ┆ 5.9          ┆ 2.1         ┆ virginica │
└──────────────┴─────────────┴──────────────┴─────────────┴───────────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-16-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort by one column</span></span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a>iris[<span class="fu">order</span>(iris<span class="sc">$</span>Species),][<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1          5.1         3.5          1.4         0.2  setosa
2          4.9         3.0          1.4         0.2  setosa
3          4.7         3.2          1.3         0.2  setosa</code></pre>
</div>
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort by two columns</span></span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a>iris[<span class="fu">order</span>(iris<span class="sc">$</span>Species,iris<span class="sc">$</span>Petal.Length),][<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
23          4.6         3.6          1.0         0.2  setosa
14          4.3         3.0          1.1         0.1  setosa
15          5.8         4.0          1.2         0.2  setosa</code></pre>
</div>
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort by two columns one in a decreasing manner and the other in an increasing manner</span></span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a>iris[<span class="fu">order</span>(<span class="fu">rev</span>(iris<span class="sc">$</span>Species),iris<span class="sc">$</span>Petal.Length),][<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Sepal.Length Sepal.Width Petal.Length Petal.Width   Species
107          4.9         2.5          4.5         1.7 virginica
127          6.2         2.8          4.8         1.8 virginica
139          6.0         3.0          4.8         1.8 virginica</code></pre>
</div>
</div>
</div>
<div id="tabset-16-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort by one column</span></span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span></span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Species) <span class="sc">|&gt;</span></span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1          5.1         3.5          1.4         0.2  setosa
2          4.9         3.0          1.4         0.2  setosa
3          4.7         3.2          1.3         0.2  setosa</code></pre>
</div>
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort by two columns</span></span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span></span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Species, Petal.Length) <span class="sc">|&gt;</span></span>
<span id="cb236-4"><a href="#cb236-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1          4.6         3.6          1.0         0.2  setosa
2          4.3         3.0          1.1         0.1  setosa
3          5.8         4.0          1.2         0.2  setosa</code></pre>
</div>
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort by two columns one in a decreasing manner and the other in an increasing manner</span></span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span></span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Species), Petal.Length) <span class="sc">|&gt;</span></span>
<span id="cb238-4"><a href="#cb238-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width   Species
1          4.9         2.5          4.5         1.7 virginica
2          6.2         2.8          4.8         1.8 virginica
3          6.0         3.0          4.8         1.8 virginica</code></pre>
</div>
</div>
</div>
<div id="tabset-16-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort by one column</span></span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a>iris_dt[<span class="fu">order</span>(Species)][<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
          &lt;num&gt;       &lt;num&gt;        &lt;num&gt;       &lt;num&gt;  &lt;fctr&gt;
1:          5.1         3.5          1.4         0.2  setosa
2:          4.9         3.0          1.4         0.2  setosa
3:          4.7         3.2          1.3         0.2  setosa</code></pre>
</div>
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort by two columns</span></span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a>iris_dt[<span class="fu">order</span>(Species,Petal.Length)][<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
          &lt;num&gt;       &lt;num&gt;        &lt;num&gt;       &lt;num&gt;  &lt;fctr&gt;
1:          4.6         3.6          1.0         0.2  setosa
2:          4.3         3.0          1.1         0.1  setosa
3:          5.8         4.0          1.2         0.2  setosa</code></pre>
</div>
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort by two columns one in a decreasing manner and the other in an increasing manner</span></span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a>iris_dt[<span class="fu">order</span>(<span class="sc">-</span>Species,Petal.Length)][<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Sepal.Length Sepal.Width Petal.Length Petal.Width   Species
          &lt;num&gt;       &lt;num&gt;        &lt;num&gt;       &lt;num&gt;    &lt;fctr&gt;
1:          4.9         2.5          4.5         1.7 virginica
2:          6.2         2.8          4.8         1.8 virginica
3:          6.0         3.0          4.8         1.8 virginica</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="keep-unique-rows" class="level3" data-number="2.10.2">
<h3 data-number="2.10.2" class="anchored" data-anchor-id="keep-unique-rows"><span class="header-section-number">2.10.2</span> Keep unique rows</h3>
<p>If you want to keep unique/distinct rows from a <code>DataFrame</code>, you can use the <code>unique()</code> method:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-17-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-1" role="tab" aria-controls="tabset-17-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-2" role="tab" aria-controls="tabset-17-2" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-3" role="tab" aria-controls="tabset-17-3" aria-selected="false">dplyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-4" role="tab" aria-controls="tabset-17-4" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-17-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-17-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With one column</span></span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris)<span class="sc">$</span><span class="fu">unique</span>(</span>
<span id="cb246-3"><a href="#cb246-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">subset =</span> <span class="st">"Species"</span></span>
<span id="cb246-4"><a href="#cb246-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: ! The `subset` argument of `$unique()` is deprecated and replaced by `...` as
of polars 1.1.0.
This warning is displayed once every 8 hours.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 5)
┌──────────────┬─────────────┬──────────────┬─────────────┬────────────┐
│ Sepal.Length ┆ Sepal.Width ┆ Petal.Length ┆ Petal.Width ┆ Species    │
│ ---          ┆ ---         ┆ ---          ┆ ---         ┆ ---        │
│ f64          ┆ f64         ┆ f64          ┆ f64         ┆ cat        │
╞══════════════╪═════════════╪══════════════╪═════════════╪════════════╡
│ 5.1          ┆ 3.5         ┆ 1.4          ┆ 0.2         ┆ setosa     │
│ 7.0          ┆ 3.2         ┆ 4.7          ┆ 1.4         ┆ versicolor │
│ 6.3          ┆ 3.3         ┆ 6.0          ┆ 2.5         ┆ virginica  │
└──────────────┴─────────────┴──────────────┴─────────────┴────────────┘</code></pre>
</div>
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With one column keeping last entry</span></span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris)<span class="sc">$</span><span class="fu">unique</span>(</span>
<span id="cb249-3"><a href="#cb249-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">subset =</span> <span class="st">"Species"</span>,</span>
<span id="cb249-4"><a href="#cb249-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">keep =</span> <span class="st">"last"</span></span>
<span id="cb249-5"><a href="#cb249-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 5)
┌──────────────┬─────────────┬──────────────┬─────────────┬────────────┐
│ Sepal.Length ┆ Sepal.Width ┆ Petal.Length ┆ Petal.Width ┆ Species    │
│ ---          ┆ ---         ┆ ---          ┆ ---         ┆ ---        │
│ f64          ┆ f64         ┆ f64          ┆ f64         ┆ cat        │
╞══════════════╪═════════════╪══════════════╪═════════════╪════════════╡
│ 5.0          ┆ 3.3         ┆ 1.4          ┆ 0.2         ┆ setosa     │
│ 5.7          ┆ 2.8         ┆ 4.1          ┆ 1.3         ┆ versicolor │
│ 5.9          ┆ 3.0         ┆ 5.1          ┆ 1.8         ┆ virginica  │
└──────────────┴─────────────┴──────────────┴─────────────┴────────────┘</code></pre>
</div>
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With two colums, keeping last entry and maintaining the same order</span></span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a>pl<span class="sc">$</span><span class="fu">DataFrame</span>(</span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(1L, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, 3L),</span>
<span id="cb251-4"><a href="#cb251-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(1L, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, 3L),</span>
<span id="cb251-5"><a href="#cb251-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">z =</span> <span class="fu">c</span>(1L, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, 4L)</span>
<span id="cb251-6"><a href="#cb251-6" aria-hidden="true" tabindex="-1"></a>)<span class="sc">$</span><span class="fu">unique</span>(</span>
<span id="cb251-7"><a href="#cb251-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">subset =</span> <span class="fu">c</span>(<span class="st">"x"</span>,<span class="st">"y"</span>),</span>
<span id="cb251-8"><a href="#cb251-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">keep =</span> <span class="st">"last"</span>,</span>
<span id="cb251-9"><a href="#cb251-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">maintain_order =</span> <span class="cn">TRUE</span></span>
<span id="cb251-10"><a href="#cb251-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 3)
┌─────┬─────┬─────┐
│ x   ┆ y   ┆ z   │
│ --- ┆ --- ┆ --- │
│ i32 ┆ i32 ┆ i32 │
╞═════╪═════╪═════╡
│ 1   ┆ 1   ┆ 1   │
│ 2   ┆ 2   ┆ 2   │
│ 3   ┆ 3   ┆ 4   │
└─────┴─────┴─────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-17-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb253"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With one column</span></span>
<span id="cb253-2"><a href="#cb253-2" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(. <span class="sc">~</span> Species, <span class="at">data =</span> iris, <span class="at">FUN =</span> head, <span class="at">N =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Species Sepal.Length.1 Sepal.Length.2 Sepal.Length.3 Sepal.Length.4
1     setosa            5.1            4.9            4.7            4.6
2 versicolor            7.0            6.4            6.9            5.5
3  virginica            6.3            5.8            7.1            6.3
  Sepal.Length.5 Sepal.Length.6 Sepal.Width.1 Sepal.Width.2 Sepal.Width.3
1            5.0            5.4           3.5           3.0           3.2
2            6.5            5.7           3.2           3.2           3.1
3            6.5            7.6           3.3           2.7           3.0
  Sepal.Width.4 Sepal.Width.5 Sepal.Width.6 Petal.Length.1 Petal.Length.2
1           3.1           3.6           3.9            1.4            1.4
2           2.3           2.8           2.8            4.7            4.5
3           2.9           3.0           3.0            6.0            5.1
  Petal.Length.3 Petal.Length.4 Petal.Length.5 Petal.Length.6 Petal.Width.1
1            1.3            1.5            1.4            1.7           0.2
2            4.9            4.0            4.6            4.5           1.4
3            5.9            5.6            5.8            6.6           2.5
  Petal.Width.2 Petal.Width.3 Petal.Width.4 Petal.Width.5 Petal.Width.6
1           0.2           0.2           0.2           0.2           0.4
2           1.5           1.5           1.3           1.5           1.3
3           1.9           2.1           1.8           2.2           2.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With one column keeping last entry</span></span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(. <span class="sc">~</span> Species, <span class="at">data =</span> iris, <span class="at">FUN =</span> tail, <span class="at">n =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Species Sepal.Length Sepal.Width Petal.Length Petal.Width
1     setosa          5.0         3.3          1.4         0.2
2 versicolor          5.7         2.8          4.1         1.3
3  virginica          5.9         3.0          5.1         1.8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb257"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With two colums, keeping last entry and maintaining the same order</span></span>
<span id="cb257-2"><a href="#cb257-2" aria-hidden="true" tabindex="-1"></a>mytest <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb257-3"><a href="#cb257-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(1L, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, 3L),</span>
<span id="cb257-4"><a href="#cb257-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(1L, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, 3L),</span>
<span id="cb257-5"><a href="#cb257-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">z =</span> <span class="fu">c</span>(1L, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, 4L)</span>
<span id="cb257-6"><a href="#cb257-6" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb257-7"><a href="#cb257-7" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(. <span class="sc">~</span> x <span class="sc">+</span> y, <span class="at">data =</span> mytest, <span class="at">FUN =</span> tail, <span class="at">n =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  x y z
1 1 1 1
2 2 2 2
3 3 3 4</code></pre>
</div>
</div>
</div>
<div id="tabset-17-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With one column</span></span>
<span id="cb259-2"><a href="#cb259-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span></span>
<span id="cb259-3"><a href="#cb259-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Species, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
1          5.1         3.5          1.4         0.2     setosa
2          7.0         3.2          4.7         1.4 versicolor
3          6.3         3.3          6.0         2.5  virginica</code></pre>
</div>
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With one column keeping last entry</span></span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span></span>
<span id="cb261-3"><a href="#cb261-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Species) <span class="sc">|&gt;</span></span>
<span id="cb261-4"><a href="#cb261-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_tail</span>() <span class="sc">|&gt;</span></span>
<span id="cb261-5"><a href="#cb261-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  Sepal.Length Sepal.Width Petal.Length Petal.Width Species   
         &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;     
1          5           3.3          1.4         0.2 setosa    
2          5.7         2.8          4.1         1.3 versicolor
3          5.9         3            5.1         1.8 virginica </code></pre>
</div>
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With two colums, keeping last entry and maintaining the same order</span></span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(1L, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, 3L),</span>
<span id="cb263-4"><a href="#cb263-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(1L, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, 3L),</span>
<span id="cb263-5"><a href="#cb263-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">z =</span> <span class="fu">c</span>(1L, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, 4L)</span>
<span id="cb263-6"><a href="#cb263-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb263-7"><a href="#cb263-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(x,y) <span class="sc">|&gt;</span></span>
<span id="cb263-8"><a href="#cb263-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_tail</span>() <span class="sc">|&gt;</span></span>
<span id="cb263-9"><a href="#cb263-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
      x     y     z
  &lt;int&gt; &lt;int&gt; &lt;int&gt;
1     1     1     1
2     2     2     2
3     3     3     4</code></pre>
</div>
</div>
</div>
<div id="tabset-17-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With one column</span></span>
<span id="cb265-2"><a href="#cb265-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(iris_dt, <span class="at">by =</span> <span class="st">"Species"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
          &lt;num&gt;       &lt;num&gt;        &lt;num&gt;       &lt;num&gt;     &lt;fctr&gt;
1:          5.1         3.5          1.4         0.2     setosa
2:          7.0         3.2          4.7         1.4 versicolor
3:          6.3         3.3          6.0         2.5  virginica</code></pre>
</div>
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With one column keeping last entry</span></span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(iris_dt, <span class="at">by =</span> <span class="st">"Species"</span>, <span class="at">fromLast =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
          &lt;num&gt;       &lt;num&gt;        &lt;num&gt;       &lt;num&gt;     &lt;fctr&gt;
1:          5.0         3.3          1.4         0.2     setosa
2:          5.7         2.8          4.1         1.3 versicolor
3:          5.9         3.0          5.1         1.8  virginica</code></pre>
</div>
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With two colums, keeping last entry and maintaining the same order</span></span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a>mytest_dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb269-3"><a href="#cb269-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(1L, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, 3L),</span>
<span id="cb269-4"><a href="#cb269-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(1L, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, 3L),</span>
<span id="cb269-5"><a href="#cb269-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">z =</span> <span class="fu">c</span>(1L, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, 4L)</span>
<span id="cb269-6"><a href="#cb269-6" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb269-7"><a href="#cb269-7" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(mytest_dt, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"x"</span>,<span class="st">"y"</span>), <span class="at">fromLast =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       x     y     z
   &lt;int&gt; &lt;int&gt; &lt;int&gt;
1:     1     1     1
2:     2     2     2
3:     3     3     4</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="keep-some-columns-from-sorted-dataframe" class="level3" data-number="2.10.3">
<h3 data-number="2.10.3" class="anchored" data-anchor-id="keep-some-columns-from-sorted-dataframe"><span class="header-section-number">2.10.3</span> Keep some columns from sorted DataFrame</h3>
<p>If you want to keep only some columns from a sorted <code>DataFrame</code>, you can use the <code>sort_by()</code> method with the <code>select()</code> method.<br>
In details, <code>sort_by()</code> can sort a column by the ordering of another column, or multiple other columns.<br>
It’s the equivalent of <code>order()</code> method of R base.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-18-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-1" role="tab" aria-controls="tabset-18-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-2" role="tab" aria-controls="tabset-18-2" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-3" role="tab" aria-controls="tabset-18-3" aria-selected="false">dplyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-4" role="tab" aria-controls="tabset-18-4" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-18-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-18-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris)<span class="sc">$</span></span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(pl<span class="sc">$</span><span class="fu">col</span>(<span class="st">"Petal.Length"</span>)<span class="sc">$</span></span>
<span id="cb271-3"><a href="#cb271-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sort_by</span>(<span class="st">"Petal.Width"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (150, 1)
┌──────────────┐
│ Petal.Length │
│ ---          │
│ f64          │
╞══════════════╡
│ 1.5          │
│ 1.4          │
│ 1.1          │
│ 1.5          │
│ 1.4          │
│ …            │
│ 5.6          │
│ 5.6          │
│ 6.0          │
│ 6.1          │
│ 5.7          │
└──────────────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-18-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true" tabindex="-1"></a>iris[<span class="fu">order</span>(iris<span class="sc">$</span>Petal.Width), <span class="st">"Petal.Length"</span>, drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Petal.Length
10           1.5
13           1.4
14           1.1
33           1.5
38           1.4
1            1.4
2            1.4
3            1.3
4            1.5
5            1.4
8            1.5
9            1.4
11           1.5
12           1.6
15           1.2
21           1.7
23           1.0
25           1.9
26           1.6
28           1.5
29           1.4
30           1.6
31           1.6
34           1.4
35           1.5
36           1.2
37           1.3
39           1.3
40           1.5
43           1.3
47           1.6
48           1.4
49           1.5
50           1.4
7            1.4
18           1.4
19           1.7
20           1.5
41           1.3
42           1.3
46           1.4
6            1.7
16           1.5
17           1.3
22           1.5
27           1.6
32           1.5
45           1.9
24           1.7
44           1.6
58           3.3
61           3.5
63           4.0
68           4.1
80           3.5
82           3.7
94           3.3
70           3.9
81           3.8
99           3.0
74           4.7
83           3.9
91           4.4
93           4.0
96           4.2
54           4.0
56           4.5
59           4.6
65           3.6
72           4.0
75           4.3
88           4.4
89           4.1
90           4.0
95           4.2
97           4.2
98           4.3
100          4.1
51           4.7
60           3.9
64           4.7
66           4.4
76           4.4
77           4.8
92           4.6
135          5.6
52           4.5
53           4.9
55           4.6
62           4.2
67           4.5
69           4.5
73           4.9
79           4.5
85           4.5
87           4.7
120          5.0
134          5.1
57           4.7
84           5.1
86           4.5
130          5.8
78           5.0
107          4.5
71           4.8
104          5.6
108          6.3
109          5.8
117          5.5
124          4.9
126          6.0
127          4.8
128          4.9
138          5.5
139          4.8
150          5.1
102          5.1
112          5.3
131          6.1
143          5.1
147          5.0
111          5.1
114          5.0
122          4.9
123          6.7
132          6.4
148          5.2
103          5.9
106          6.6
113          5.5
125          5.7
129          5.6
140          5.4
105          5.8
118          6.7
133          5.6
116          5.3
119          6.9
121          5.7
136          6.1
142          5.1
144          5.9
146          5.2
149          5.4
115          5.1
137          5.6
141          5.6
101          6.0
110          6.1
145          5.7</code></pre>
</div>
</div>
</div>
<div id="tabset-18-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span></span>
<span id="cb275-3"><a href="#cb275-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Petal.Width) <span class="sc">|&gt;</span></span>
<span id="cb275-4"><a href="#cb275-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Petal.Length)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Petal.Length
1            1.5
2            1.4
3            1.1
4            1.5
5            1.4
6            1.4
7            1.4
8            1.3
9            1.5
10           1.4
11           1.5
12           1.4
13           1.5
14           1.6
15           1.2
16           1.7
17           1.0
18           1.9
19           1.6
20           1.5
21           1.4
22           1.6
23           1.6
24           1.4
25           1.5
26           1.2
27           1.3
28           1.3
29           1.5
30           1.3
31           1.6
32           1.4
33           1.5
34           1.4
35           1.4
36           1.4
37           1.7
38           1.5
39           1.3
40           1.3
41           1.4
42           1.7
43           1.5
44           1.3
45           1.5
46           1.6
47           1.5
48           1.9
49           1.7
50           1.6
51           3.3
52           3.5
53           4.0
54           4.1
55           3.5
56           3.7
57           3.3
58           3.9
59           3.8
60           3.0
61           4.7
62           3.9
63           4.4
64           4.0
65           4.2
66           4.0
67           4.5
68           4.6
69           3.6
70           4.0
71           4.3
72           4.4
73           4.1
74           4.0
75           4.2
76           4.2
77           4.3
78           4.1
79           4.7
80           3.9
81           4.7
82           4.4
83           4.4
84           4.8
85           4.6
86           5.6
87           4.5
88           4.9
89           4.6
90           4.2
91           4.5
92           4.5
93           4.9
94           4.5
95           4.5
96           4.7
97           5.0
98           5.1
99           4.7
100          5.1
101          4.5
102          5.8
103          5.0
104          4.5
105          4.8
106          5.6
107          6.3
108          5.8
109          5.5
110          4.9
111          6.0
112          4.8
113          4.9
114          5.5
115          4.8
116          5.1
117          5.1
118          5.3
119          6.1
120          5.1
121          5.0
122          5.1
123          5.0
124          4.9
125          6.7
126          6.4
127          5.2
128          5.9
129          6.6
130          5.5
131          5.7
132          5.6
133          5.4
134          5.8
135          6.7
136          5.6
137          5.3
138          6.9
139          5.7
140          6.1
141          5.1
142          5.9
143          5.2
144          5.4
145          5.1
146          5.6
147          5.6
148          6.0
149          6.1
150          5.7</code></pre>
</div>
</div>
</div>
<div id="tabset-18-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb277"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb277-2"><a href="#cb277-2" aria-hidden="true" tabindex="-1"></a>iris_dt <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(iris)</span>
<span id="cb277-3"><a href="#cb277-3" aria-hidden="true" tabindex="-1"></a>iris_dt[<span class="fu">order</span>(Petal.Width)][,.(Petal.Length)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Petal.Length
            &lt;num&gt;
  1:          1.5
  2:          1.4
  3:          1.1
  4:          1.5
  5:          1.4
 ---             
146:          5.6
147:          5.6
148:          6.0
149:          6.1
150:          5.7</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you want to use multiple columns/expressions, you can pass it in a <code>list</code> like this for example <code>sort_by(list("Petal.Width","Sepal.Width"))</code> or <code>sort_by(list("Petal.Width", pl$col("Sepal.Width")))</code></p>
</div>
</div>
</section>
</section>
<section id="join-dataframes" class="level2" data-number="2.11">
<h2 data-number="2.11" class="anchored" data-anchor-id="join-dataframes"><span class="header-section-number">2.11</span> Join DataFrames</h2>
<p>To perform joins, the <code>join()</code> method must be used.</p>
<p>Multiple strategies are available:</p>
<ul>
<li><code>"inner"</code>: returns row with matching keys in both frames. Non-matching rows in either the left or right frame are discarded.<br>
</li>
<li><code>"left"</code>: returns all rows in the left dataframe, whether or not a match in the right-frame is found. Non-matching rows have their right columns null-filled.<br>
</li>
<li><code>"outer"</code>: returns all rows from both the left and right dataframe. If no match is found in one frame, columns from the other frame are null-filled.<br>
</li>
<li><code>"semi"</code>: returns all rows from the left frame in which the join key is also present in the right frame.<br>
</li>
<li><code>"anti"</code>: returns all rows from the left frame in which the join key is not present in the right frame.<br>
</li>
<li><code>"cross"</code>: returns the cartesian product of all rows from the left frame with all rows from the right frame. Duplicates rows are retained. The table length of A cross-joined with B is always len(A) × len(B).</li>
</ul>
<p>The main arguments are: - <code>on</code>: name(s) of the join columns in both <code>DataFrames</code>.<br>
- <code>how</code>: join strategy.<br>
- <code>suffix</code>: suffix to append to columns with a duplicate name.</p>
<p>Let’s see a simple example:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-19-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-1" role="tab" aria-controls="tabset-19-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-2" role="tab" aria-controls="tabset-19-2" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-3" role="tab" aria-controls="tabset-19-3" aria-selected="false">dplyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-4" role="tab" aria-controls="tabset-19-4" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-19-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-19-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb279"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First, creation of colors_species Polars DataFrame</span></span>
<span id="cb279-2"><a href="#cb279-2" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> pl<span class="sc">$</span><span class="fu">DataFrame</span>(</span>
<span id="cb279-3"><a href="#cb279-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Surname =</span> <span class="fu">c</span>(<span class="st">"toto"</span>,<span class="st">"titi"</span>,<span class="st">"tata"</span>),</span>
<span id="cb279-4"><a href="#cb279-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Color =</span> <span class="fu">c</span>(<span class="st">"blue"</span>,<span class="st">"red"</span>,<span class="st">"yellow"</span>)</span>
<span id="cb279-5"><a href="#cb279-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb279-6"><a href="#cb279-6" aria-hidden="true" tabindex="-1"></a>values <span class="ot">&lt;-</span> pl<span class="sc">$</span><span class="fu">DataFrame</span>(</span>
<span id="cb279-7"><a href="#cb279-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Surname =</span> <span class="fu">c</span>(<span class="st">"toto"</span>,<span class="st">"titi"</span>,<span class="st">"tata"</span>),</span>
<span id="cb279-8"><a href="#cb279-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>)</span>
<span id="cb279-9"><a href="#cb279-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb279-10"><a href="#cb279-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's join !</span></span>
<span id="cb279-11"><a href="#cb279-11" aria-hidden="true" tabindex="-1"></a>colors<span class="sc">$</span><span class="fu">join</span>(</span>
<span id="cb279-12"><a href="#cb279-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">other =</span> values,</span>
<span id="cb279-13"><a href="#cb279-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">on =</span> <span class="st">"Surname"</span>,</span>
<span id="cb279-14"><a href="#cb279-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">how =</span> <span class="st">"left"</span></span>
<span id="cb279-15"><a href="#cb279-15" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 3)
┌─────────┬────────┬───────┐
│ Surname ┆ Color  ┆ value │
│ ---     ┆ ---    ┆ ---   │
│ str     ┆ str    ┆ f64   │
╞═════════╪════════╪═══════╡
│ toto    ┆ blue   ┆ 10.0  │
│ titi    ┆ red    ┆ 20.0  │
│ tata    ┆ yellow ┆ 30.0  │
└─────────┴────────┴───────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-19-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb281"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a>colors_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb281-2"><a href="#cb281-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Surname =</span> <span class="fu">c</span>(<span class="st">"toto"</span>,<span class="st">"titi"</span>,<span class="st">"tata"</span>),</span>
<span id="cb281-3"><a href="#cb281-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Color =</span> <span class="fu">c</span>(<span class="st">"blue"</span>,<span class="st">"red"</span>,<span class="st">"yellow"</span>)</span>
<span id="cb281-4"><a href="#cb281-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb281-5"><a href="#cb281-5" aria-hidden="true" tabindex="-1"></a>values_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb281-6"><a href="#cb281-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Surname =</span> <span class="fu">c</span>(<span class="st">"toto"</span>,<span class="st">"titi"</span>,<span class="st">"tata"</span>),</span>
<span id="cb281-7"><a href="#cb281-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>)</span>
<span id="cb281-8"><a href="#cb281-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb281-9"><a href="#cb281-9" aria-hidden="true" tabindex="-1"></a><span class="fu">merge</span>(colors_df, values_df, <span class="at">by =</span> <span class="st">"Surname"</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Surname  Color value
1    tata yellow    30
2    titi    red    20
3    toto   blue    10</code></pre>
</div>
</div>
</div>
<div id="tabset-19-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb283"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a>colors_df <span class="sc">|&gt;</span></span>
<span id="cb283-2"><a href="#cb283-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(values_df,</span>
<span id="cb283-3"><a href="#cb283-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="st">"Surname"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Surname  Color value
1    toto   blue    10
2    titi    red    20
3    tata yellow    30</code></pre>
</div>
</div>
</div>
<div id="tabset-19-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb285"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="fu">merge</span>(<span class="fu">as.data.table</span>(colors_df), </span>
<span id="cb285-2"><a href="#cb285-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.data.table</span>(values_df), </span>
<span id="cb285-3"><a href="#cb285-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">by =</span> <span class="st">"Surname"</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Key: &lt;Surname&gt;
   Surname  Color value
    &lt;char&gt; &lt;char&gt; &lt;num&gt;
1:    tata yellow    30
2:    titi    red    20
3:    toto   blue    10</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>If join columns have different names in both <code>DataFrames</code>, you can use arguments <code>"left_on"</code> and <code>"right_on"</code>.<br>
Here’s an example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb287"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a>values2 <span class="ot">&lt;-</span> values<span class="sc">$</span><span class="fu">rename</span>(<span class="at">Surname =</span> <span class="st">"Surname2"</span>)</span>
<span id="cb287-2"><a href="#cb287-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-3"><a href="#cb287-3" aria-hidden="true" tabindex="-1"></a>colors<span class="sc">$</span><span class="fu">join</span>(</span>
<span id="cb287-4"><a href="#cb287-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">other =</span> values2,</span>
<span id="cb287-5"><a href="#cb287-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">left_on =</span> <span class="st">"Surname"</span>,</span>
<span id="cb287-6"><a href="#cb287-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">right_on =</span> <span class="st">"Surname2"</span>,</span>
<span id="cb287-7"><a href="#cb287-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">how =</span> <span class="st">"left"</span></span>
<span id="cb287-8"><a href="#cb287-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 3)
┌─────────┬────────┬───────┐
│ Surname ┆ Color  ┆ value │
│ ---     ┆ ---    ┆ ---   │
│ str     ┆ str    ┆ f64   │
╞═════════╪════════╪═══════╡
│ toto    ┆ blue   ┆ 10.0  │
│ titi    ┆ red    ┆ 20.0  │
│ tata    ┆ yellow ┆ 30.0  │
└─────────┴────────┴───────┘</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>When we join on <strong>integer</strong> columns that are <strong>sorted</strong> polars uses <strong>a fast-track algorithm</strong>.</p>
<p>To use the fast-track algorithm polars needs to know the join columns are sorted. See the tip <a href="#filter-rows">in this section</a> for an example with <code>filter()</code> method.</p>
<p><strong>Polars can’t use the fast-track algorithm for joining string columns</strong> as the algorithm works on integers.</p>
<p>=&gt; <strong>To use the fast-track algorithm</strong> the string column must be cast to <strong>categorical dtype</strong>. See an example <a href="#cast">here</a>.</p>
</div>
</div>
</section>
<section id="concatenate-dataframes" class="level2" data-number="2.12">
<h2 data-number="2.12" class="anchored" data-anchor-id="concatenate-dataframes"><span class="header-section-number">2.12</span> Concatenate DataFrames</h2>
<p>To perform concatenations, the <code>concat()</code> method must be used.<br>
In this section, we will see <strong>vertical</strong>, <strong>horizontal</strong> and <strong>diagonal</strong> concatenation.</p>
<p>Before we need to create some datasets to run our examples. Click to expand it! 👇</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb289"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a>dfup <span class="ot">&lt;-</span> pl<span class="sc">$</span><span class="fu">DataFrame</span>(</span>
<span id="cb289-2"><a href="#cb289-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">col1 =</span> <span class="fu">c</span>(<span class="st">"a"</span>),</span>
<span id="cb289-3"><a href="#cb289-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">col2 =</span> <span class="fu">c</span>(<span class="st">"b"</span>),</span>
<span id="cb289-4"><a href="#cb289-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">col3 =</span> <span class="fu">c</span>(<span class="st">"c"</span>)</span>
<span id="cb289-5"><a href="#cb289-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb289-6"><a href="#cb289-6" aria-hidden="true" tabindex="-1"></a>dfdown <span class="ot">&lt;-</span> pl<span class="sc">$</span><span class="fu">DataFrame</span>(</span>
<span id="cb289-7"><a href="#cb289-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">col1 =</span> <span class="fu">c</span>(<span class="st">"x"</span>),</span>
<span id="cb289-8"><a href="#cb289-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">col2 =</span> <span class="fu">c</span>(<span class="st">"y"</span>),</span>
<span id="cb289-9"><a href="#cb289-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">col3 =</span> <span class="fu">c</span>(<span class="st">"z"</span>)</span>
<span id="cb289-10"><a href="#cb289-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb289-11"><a href="#cb289-11" aria-hidden="true" tabindex="-1"></a>dfleft <span class="ot">&lt;-</span> pl<span class="sc">$</span><span class="fu">DataFrame</span>(<span class="at">col1 =</span> <span class="fu">c</span>(<span class="st">"a"</span>,<span class="st">"b"</span>,<span class="st">"c"</span>))</span>
<span id="cb289-12"><a href="#cb289-12" aria-hidden="true" tabindex="-1"></a>dfright <span class="ot">&lt;-</span> pl<span class="sc">$</span><span class="fu">DataFrame</span>(<span class="at">col2 =</span> <span class="fu">c</span>(<span class="st">"x"</span>,<span class="st">"y"</span>,<span class="st">"z"</span>))</span>
<span id="cb289-13"><a href="#cb289-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-14"><a href="#cb289-14" aria-hidden="true" tabindex="-1"></a>dfup_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(dfup)</span>
<span id="cb289-15"><a href="#cb289-15" aria-hidden="true" tabindex="-1"></a>dfdown_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(dfdown)</span>
<span id="cb289-16"><a href="#cb289-16" aria-hidden="true" tabindex="-1"></a>dfleft_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(dfleft)</span>
<span id="cb289-17"><a href="#cb289-17" aria-hidden="true" tabindex="-1"></a>dfright_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(dfright)</span>
<span id="cb289-18"><a href="#cb289-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-19"><a href="#cb289-19" aria-hidden="true" tabindex="-1"></a>dfup_dt <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(dfup)</span>
<span id="cb289-20"><a href="#cb289-20" aria-hidden="true" tabindex="-1"></a>dfdown_dt <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(dfdown)</span>
<span id="cb289-21"><a href="#cb289-21" aria-hidden="true" tabindex="-1"></a>dfleft_dt <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(dfleft)</span>
<span id="cb289-22"><a href="#cb289-22" aria-hidden="true" tabindex="-1"></a>dfright_dt <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(dfright)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="vertical-concatenation" class="level3" data-number="2.12.1">
<h3 data-number="2.12.1" class="anchored" data-anchor-id="vertical-concatenation"><span class="header-section-number">2.12.1</span> Vertical concatenation</h3>
<p>To concatenate multiple <code>DataFrames</code> vertically (=by row), you can use the <code>concat()</code> method and the argument <code>how = "vertical"</code>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-20-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-1" role="tab" aria-controls="tabset-20-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-2" role="tab" aria-controls="tabset-20-2" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-3" role="tab" aria-controls="tabset-20-3" aria-selected="false">dplyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-4" role="tab" aria-controls="tabset-20-4" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-20-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-20-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb290"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a>pl<span class="sc">$</span><span class="fu">concat</span>(dfup,dfdown,<span class="at">how =</span> <span class="st">"vertical"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (2, 3)
┌──────┬──────┬──────┐
│ col1 ┆ col2 ┆ col3 │
│ ---  ┆ ---  ┆ ---  │
│ str  ┆ str  ┆ str  │
╞══════╪══════╪══════╡
│ a    ┆ b    ┆ c    │
│ x    ┆ y    ┆ z    │
└──────┴──────┴──────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-20-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb292"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(dfup_df,dfdown_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  col1 col2 col3
1    a    b    c
2    x    y    z</code></pre>
</div>
</div>
</div>
<div id="tabset-20-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb294"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(<span class="fu">list</span>(dfup_df,dfdown_df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  col1 col2 col3
1    a    b    c
2    x    y    z</code></pre>
</div>
</div>
</div>
<div id="tabset-20-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb296"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbindlist</span>(<span class="fu">list</span>(dfup_dt, dfdown_dt))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     col1   col2   col3
   &lt;char&gt; &lt;char&gt; &lt;char&gt;
1:      a      b      c
2:      x      y      z</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="horizontal-concatenation" class="level3" data-number="2.12.2">
<h3 data-number="2.12.2" class="anchored" data-anchor-id="horizontal-concatenation"><span class="header-section-number">2.12.2</span> Horizontal concatenation</h3>
<p>To concatenate multiple <code>DataFrames</code> horizontally (=by col), you can use the <code>concat()</code> method and the argument <code>how = "horizontal"</code>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-21-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-1" role="tab" aria-controls="tabset-21-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-2" role="tab" aria-controls="tabset-21-2" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-3" role="tab" aria-controls="tabset-21-3" aria-selected="false">dplyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-4" role="tab" aria-controls="tabset-21-4" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-21-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-21-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb298"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a>pl<span class="sc">$</span><span class="fu">concat</span>(dfleft,dfright,<span class="at">how =</span> <span class="st">"horizontal"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 2)
┌──────┬──────┐
│ col1 ┆ col2 │
│ ---  ┆ ---  │
│ str  ┆ str  │
╞══════╪══════╡
│ a    ┆ x    │
│ b    ┆ y    │
│ c    ┆ z    │
└──────┴──────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-21-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb300"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(dfleft_df,dfright_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  col1 col2
1    a    x
2    b    y
3    c    z</code></pre>
</div>
</div>
</div>
<div id="tabset-21-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb302"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="fu">list</span>(dfleft_df,dfright_df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]        
[1,] data.frame,1
[2,] data.frame,1</code></pre>
</div>
</div>
</div>
<div id="tabset-21-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb304"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.table</span>(dfleft_dt, dfright_dt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     col1   col2
   &lt;char&gt; &lt;char&gt;
1:      a      x
2:      b      y
3:      c      z</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="diagonal-concatenation" class="level3" data-number="2.12.3">
<h3 data-number="2.12.3" class="anchored" data-anchor-id="diagonal-concatenation"><span class="header-section-number">2.12.3</span> Diagonal concatenation</h3>
<p>To concatenate multiple <code>DataFrames</code> diagonally, you can use the <code>concat()</code> method and the argument <code>how = "diagonal"</code>.<br>
Diagonal concatenation is useful when the column names are not identical in initial <code>DataFrames</code>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-22-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-1" role="tab" aria-controls="tabset-22-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-2" role="tab" aria-controls="tabset-22-2" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-3" role="tab" aria-controls="tabset-22-3" aria-selected="false">dplyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-4" role="tab" aria-controls="tabset-22-4" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-22-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-22-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb306"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a>dfup <span class="ot">&lt;-</span> dfup<span class="sc">$</span><span class="fu">rename</span>(<span class="at">col3=</span><span class="st">"col4"</span>)</span>
<span id="cb306-2"><a href="#cb306-2" aria-hidden="true" tabindex="-1"></a>pl<span class="sc">$</span><span class="fu">concat</span>(dfup,dfdown,<span class="at">how =</span> <span class="st">"diagonal"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (2, 4)
┌──────┬──────┬──────┬──────┐
│ col1 ┆ col2 ┆ col4 ┆ col3 │
│ ---  ┆ ---  ┆ ---  ┆ ---  │
│ str  ┆ str  ┆ str  ┆ str  │
╞══════╪══════╪══════╪══════╡
│ a    ┆ b    ┆ c    ┆ null │
│ x    ┆ y    ┆ null ┆ z    │
└──────┴──────┴──────┴──────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-22-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb308"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a>dfup_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(dfup)</span>
<span id="cb308-2"><a href="#cb308-2" aria-hidden="true" tabindex="-1"></a>dfup_df[<span class="fu">setdiff</span>(<span class="fu">names</span>(dfdown_df), <span class="fu">names</span>(dfup_df))] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb308-3"><a href="#cb308-3" aria-hidden="true" tabindex="-1"></a>dfdown_df[<span class="fu">setdiff</span>(<span class="fu">names</span>(dfup_df), <span class="fu">names</span>(dfdown_df))] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb308-4"><a href="#cb308-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(dfup_df,dfdown_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  col1 col2 col4 col3
1    a    b    c &lt;NA&gt;
2    x    y &lt;NA&gt;    z</code></pre>
</div>
</div>
</div>
<div id="tabset-22-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb310"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true" tabindex="-1"></a>dfup_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(dfup)</span>
<span id="cb310-2"><a href="#cb310-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(<span class="fu">list</span>(dfup_df,dfdown_df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  col1 col2 col4 col3
1    a    b    c &lt;NA&gt;
2    x    y &lt;NA&gt;    z</code></pre>
</div>
</div>
</div>
<div id="tabset-22-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb312"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a>dfup_dt <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(dfup)</span>
<span id="cb312-2"><a href="#cb312-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rbindlist</span>(<span class="fu">list</span>(dfup_dt, dfdown_dt),<span class="at">fill =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     col1   col2   col4   col3
   &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt;
1:      a      b      c   &lt;NA&gt;
2:      x      y   &lt;NA&gt;      z</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="pivot-a-dataframe" class="level2" data-number="2.13">
<h2 data-number="2.13" class="anchored" data-anchor-id="pivot-a-dataframe"><span class="header-section-number">2.13</span> Pivot a DataFrame</h2>
<section id="from-long-to-wide" class="level3" data-number="2.13.1">
<h3 data-number="2.13.1" class="anchored" data-anchor-id="from-long-to-wide"><span class="header-section-number">2.13.1</span> From long to wide</h3>
<p>The <code>pivot()</code> method can be used to pivot a <code>DataFrame</code> from long to wide.</p>
<p>Let’s go for a first example :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb314"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb314-1"><a href="#cb314-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb314-2"><a href="#cb314-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">country =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"France"</span>,<span class="dv">3</span>),<span class="fu">rep</span>(<span class="st">"Italy"</span>,<span class="st">"3"</span>)),</span>
<span id="cb314-3"><a href="#cb314-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">city =</span> <span class="fu">c</span>(<span class="st">"Paris"</span>, <span class="st">"Lille"</span>, <span class="st">"Nice"</span>, <span class="st">"Roma"</span>, <span class="st">"Milan"</span>, <span class="st">"Napoli"</span>),</span>
<span id="cb314-4"><a href="#cb314-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">location =</span> <span class="fu">c</span>(<span class="st">"North"</span>,<span class="st">"North"</span>,<span class="st">"South"</span>,<span class="st">"South"</span>,<span class="st">"North"</span>,<span class="st">"South"</span>),</span>
<span id="cb314-5"><a href="#cb314-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">population =</span> <span class="fu">c</span>(<span class="fl">2.1</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">2.8</span>, <span class="fl">1.4</span>, <span class="fl">3.0</span>)</span>
<span id="cb314-6"><a href="#cb314-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb314-7"><a href="#cb314-7" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  country   city location population
1  France  Paris    North        2.1
2  France  Lille    North        0.2
3  France   Nice    South        0.4
4   Italy   Roma    South        2.8
5   Italy  Milan    North        1.4
6   Italy Napoli    South        3.0</code></pre>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-23-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-1" role="tab" aria-controls="tabset-23-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-2" role="tab" aria-controls="tabset-23-2" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-3" role="tab" aria-controls="tabset-23-3" aria-selected="false">tidyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-4" role="tab" aria-controls="tabset-23-4" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-23-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-23-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb316"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb316-1"><a href="#cb316-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(df)<span class="sc">$</span><span class="fu">pivot</span>(</span>
<span id="cb316-2"><a href="#cb316-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">on =</span> <span class="st">"city"</span>,</span>
<span id="cb316-3"><a href="#cb316-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">index =</span> <span class="st">"country"</span>, </span>
<span id="cb316-4"><a href="#cb316-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">values =</span> <span class="st">"population"</span>, </span>
<span id="cb316-5"><a href="#cb316-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (2, 7)
┌─────────┬───────┬───────┬──────┬──────┬───────┬────────┐
│ country ┆ Paris ┆ Lille ┆ Nice ┆ Roma ┆ Milan ┆ Napoli │
│ ---     ┆ ---   ┆ ---   ┆ ---  ┆ ---  ┆ ---   ┆ ---    │
│ str     ┆ f64   ┆ f64   ┆ f64  ┆ f64  ┆ f64   ┆ f64    │
╞═════════╪═══════╪═══════╪══════╪══════╪═══════╪════════╡
│ France  ┆ 2.1   ┆ 0.2   ┆ 0.4  ┆ null ┆ null  ┆ null   │
│ Italy   ┆ null  ┆ null  ┆ null ┆ 2.8  ┆ 1.4   ┆ 3.0    │
└─────────┴───────┴───────┴──────┴──────┴───────┴────────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-23-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb318"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true" tabindex="-1"></a><span class="fu">reshape</span>(df[,<span class="sc">-</span><span class="fu">which</span>(<span class="fu">names</span>(df) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"location"</span>))], </span>
<span id="cb318-2"><a href="#cb318-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">idvar =</span> <span class="st">"country"</span>, </span>
<span id="cb318-3"><a href="#cb318-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">timevar =</span> <span class="st">"city"</span>, </span>
<span id="cb318-4"><a href="#cb318-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">direction =</span> <span class="st">"wide"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  country population.Paris population.Lille population.Nice population.Roma
1  France              2.1              0.2             0.4              NA
4   Italy               NA               NA              NA             2.8
  population.Milan population.Napoli
1               NA                NA
4              1.4                 3</code></pre>
</div>
</div>
</div>
<div id="tabset-23-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb320"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb320-1"><a href="#cb320-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb320-2"><a href="#cb320-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb320-3"><a href="#cb320-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">id_cols =</span> country,</span>
<span id="cb320-4"><a href="#cb320-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> city,</span>
<span id="cb320-5"><a href="#cb320-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> population</span>
<span id="cb320-6"><a href="#cb320-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 7
  country Paris Lille  Nice  Roma Milan Napoli
  &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 France    2.1   0.2   0.4  NA    NA       NA
2 Italy    NA    NA    NA     2.8   1.4      3</code></pre>
</div>
</div>
</div>
<div id="tabset-23-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb322"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb322-1"><a href="#cb322-1" aria-hidden="true" tabindex="-1"></a>df_dt <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(df)</span>
<span id="cb322-2"><a href="#cb322-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dcast</span>(df_dt, country <span class="sc">~</span> city, <span class="at">value.var =</span> <span class="st">"population"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Key: &lt;country&gt;
   country Lille Milan Napoli  Nice Paris  Roma
    &lt;char&gt; &lt;num&gt; &lt;num&gt;  &lt;num&gt; &lt;num&gt; &lt;num&gt; &lt;num&gt;
1:  France   0.2    NA     NA   0.4   2.1    NA
2:   Italy    NA   1.4      3    NA    NA   2.8</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>You can also aggregate the results using a function that you enter in the argument <code>aggregate_function</code> in <code>pivot()</code> method.</p>
<p>In this case, the <code>aggregate_function</code> argument of <code>pivot()</code> is the equivalent of <code>values_fn</code> of <code>pivot_wider()</code> from <code>{tidyr}</code> and <code>fun.aggregate</code> of <code>dcast()</code> from <code>{data.table}</code>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-24-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-1" role="tab" aria-controls="tabset-24-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-2" role="tab" aria-controls="tabset-24-2" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-3" role="tab" aria-controls="tabset-24-3" aria-selected="false">tidyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-4" role="tab" aria-controls="tabset-24-4" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-24-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-24-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb324"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(df)<span class="sc">$</span><span class="fu">pivot</span>(</span>
<span id="cb324-2"><a href="#cb324-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">on =</span> <span class="st">"location"</span>,</span>
<span id="cb324-3"><a href="#cb324-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">index =</span> <span class="st">"country"</span>, </span>
<span id="cb324-4"><a href="#cb324-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">values =</span> <span class="st">"population"</span>,</span>
<span id="cb324-5"><a href="#cb324-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">aggregate_function =</span> <span class="st">"mean"</span></span>
<span id="cb324-6"><a href="#cb324-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (2, 3)
┌─────────┬───────┬───────┐
│ country ┆ North ┆ South │
│ ---     ┆ ---   ┆ ---   │
│ str     ┆ f64   ┆ f64   │
╞═════════╪═══════╪═══════╡
│ France  ┆ 1.15  ┆ 0.4   │
│ Italy   ┆ 1.4   ┆ 2.9   │
└─────────┴───────┴───────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-24-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-24-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb326"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a>df_summary <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(population <span class="sc">~</span> country <span class="sc">+</span> location, <span class="at">data =</span> df, <span class="at">FUN =</span> mean)</span>
<span id="cb326-2"><a href="#cb326-2" aria-hidden="true" tabindex="-1"></a>df_final <span class="ot">&lt;-</span> <span class="fu">reshape</span>(df_summary, <span class="at">idvar =</span> <span class="st">"country"</span>, <span class="at">timevar =</span> <span class="st">"location"</span>, <span class="at">direction =</span> <span class="st">"wide"</span>)</span>
<span id="cb326-3"><a href="#cb326-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_final) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"country"</span>, <span class="st">"North"</span>, <span class="st">"South"</span>)</span>
<span id="cb326-4"><a href="#cb326-4" aria-hidden="true" tabindex="-1"></a>df_final</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  country North South
1  France  1.15   0.4
2   Italy  1.40   2.9</code></pre>
</div>
</div>
</div>
<div id="tabset-24-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-24-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb328"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb328-2"><a href="#cb328-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> country,</span>
<span id="cb328-3"><a href="#cb328-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_from =</span> location, </span>
<span id="cb328-4"><a href="#cb328-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> population, </span>
<span id="cb328-5"><a href="#cb328-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_fn =</span> mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  country North South
  &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;
1 France   1.15   0.4
2 Italy    1.4    2.9</code></pre>
</div>
</div>
</div>
<div id="tabset-24-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-24-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb330"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb330-1"><a href="#cb330-1" aria-hidden="true" tabindex="-1"></a>df_dt <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(df)</span>
<span id="cb330-2"><a href="#cb330-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dcast</span>(df_dt, country <span class="sc">~</span> location, <span class="at">value.var =</span> <span class="st">"population"</span>, <span class="at">fun.aggregate =</span> mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Key: &lt;country&gt;
   country North South
    &lt;char&gt; &lt;num&gt; &lt;num&gt;
1:  France  1.15   0.4
2:   Italy  1.40   2.9</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>However with <code>{polars}</code>, we can also run an expression as an aggregation function.<br>
With <code>{tidyr}</code> and <code>{data.table}</code>, you need to calculate this in advance.<br>
For example:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-25-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-1" role="tab" aria-controls="tabset-25-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-25-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-2" role="tab" aria-controls="tabset-25-2" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-25-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-3" role="tab" aria-controls="tabset-25-3" aria-selected="false">tidyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-25-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-4" role="tab" aria-controls="tabset-25-4" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-25-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-25-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb332"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(df)<span class="sc">$</span><span class="fu">pivot</span>(</span>
<span id="cb332-2"><a href="#cb332-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">on =</span> <span class="st">"location"</span>,</span>
<span id="cb332-3"><a href="#cb332-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">index =</span> <span class="st">"country"</span>, </span>
<span id="cb332-4"><a href="#cb332-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">values =</span> <span class="st">"population"</span>,</span>
<span id="cb332-5"><a href="#cb332-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">aggregate_function =</span> pl<span class="sc">$</span><span class="fu">element</span>()<span class="sc">$</span><span class="fu">sum</span>()<span class="sc">$</span><span class="fu">sqrt</span>()</span>
<span id="cb332-6"><a href="#cb332-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (2, 3)
┌─────────┬──────────┬──────────┐
│ country ┆ North    ┆ South    │
│ ---     ┆ ---      ┆ ---      │
│ str     ┆ f64      ┆ f64      │
╞═════════╪══════════╪══════════╡
│ France  ┆ 1.516575 ┆ 0.632456 │
│ Italy   ┆ 1.183216 ┆ 2.408319 │
└─────────┴──────────┴──────────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-25-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-25-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb334"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true" tabindex="-1"></a>df_summarized <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(population <span class="sc">~</span> country <span class="sc">+</span> location, df, <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">sqrt</span>(<span class="fu">sum</span>(x)))</span>
<span id="cb334-2"><a href="#cb334-2" aria-hidden="true" tabindex="-1"></a>df_final <span class="ot">&lt;-</span> <span class="fu">reshape</span>(df_summarized, <span class="at">idvar =</span> <span class="st">"country"</span>, <span class="at">timevar =</span> <span class="st">"location"</span>, <span class="at">direction =</span> <span class="st">"wide"</span>)</span>
<span id="cb334-3"><a href="#cb334-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_final) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"country"</span>, <span class="st">"North"</span>, <span class="st">"South"</span>)</span>
<span id="cb334-4"><a href="#cb334-4" aria-hidden="true" tabindex="-1"></a>df_final</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  country    North     South
1  France 1.516575 0.6324555
2   Italy 1.183216 2.4083189</code></pre>
</div>
</div>
</div>
<div id="tabset-25-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-25-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb336"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb336-2"><a href="#cb336-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country, location) <span class="sc">|&gt;</span></span>
<span id="cb336-3"><a href="#cb336-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">population_sum =</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(population))) <span class="sc">|&gt;</span></span>
<span id="cb336-4"><a href="#cb336-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> location, <span class="at">values_from =</span> population_sum)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
# Groups:   country [2]
  country North South
  &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;
1 France   1.52 0.632
2 Italy    1.18 2.41 </code></pre>
</div>
</div>
</div>
<div id="tabset-25-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-25-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb338"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb338-1"><a href="#cb338-1" aria-hidden="true" tabindex="-1"></a>dt_final <span class="ot">&lt;-</span> df_dt[, .(<span class="at">population_sum =</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(population))), by <span class="ot">=</span> .(country, location)]</span>
<span id="cb338-2"><a href="#cb338-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dcast</span>(dt_final, country <span class="sc">~</span> location, <span class="at">value.var =</span> <span class="st">"population_sum"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Key: &lt;country&gt;
   country    North     South
    &lt;char&gt;    &lt;num&gt;     &lt;num&gt;
1:  France 1.516575 0.6324555
2:   Italy 1.183216 2.4083189</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="from-wide-to-long" class="level3" data-number="2.13.2">
<h3 data-number="2.13.2" class="anchored" data-anchor-id="from-wide-to-long"><span class="header-section-number">2.13.2</span> From wide to long</h3>
<p>The <code>unpivot()</code> method can be used to pivot a <code>DataFrame</code> from wide to long.</p>
<p>Let’s see with an example :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb340"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb340-1"><a href="#cb340-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb340-2"><a href="#cb340-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">country =</span> <span class="fu">c</span>(<span class="st">"France"</span>,<span class="st">"Italy"</span>),</span>
<span id="cb340-3"><a href="#cb340-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">North =</span> <span class="fu">c</span>(<span class="fl">1.1</span>,<span class="fl">1.4</span>),</span>
<span id="cb340-4"><a href="#cb340-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">South =</span> <span class="fu">c</span>(<span class="fl">0.4</span>,<span class="fl">2.9</span>)</span>
<span id="cb340-5"><a href="#cb340-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-26-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-1" role="tab" aria-controls="tabset-26-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-2" role="tab" aria-controls="tabset-26-2" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-3" role="tab" aria-controls="tabset-26-3" aria-selected="false">tidyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-4" role="tab" aria-controls="tabset-26-4" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-26-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-26-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb341"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(df)<span class="sc">$</span><span class="fu">unpivot</span>(</span>
<span id="cb341-2"><a href="#cb341-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">index =</span> <span class="st">"country"</span>,</span>
<span id="cb341-3"><a href="#cb341-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">on =</span> <span class="fu">c</span>(<span class="st">"North"</span>,<span class="st">"South"</span>)</span>
<span id="cb341-4"><a href="#cb341-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (4, 3)
┌─────────┬──────────┬───────┐
│ country ┆ variable ┆ value │
│ ---     ┆ ---      ┆ ---   │
│ str     ┆ str      ┆ f64   │
╞═════════╪══════════╪═══════╡
│ France  ┆ North    ┆ 1.1   │
│ Italy   ┆ North    ┆ 1.4   │
│ France  ┆ South    ┆ 0.4   │
│ Italy   ┆ South    ┆ 2.9   │
└─────────┴──────────┴───────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-26-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-26-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb343"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true" tabindex="-1"></a>melted_df  <span class="ot">&lt;-</span> <span class="fu">reshape</span>(df, </span>
<span id="cb343-2"><a href="#cb343-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">varying =</span> <span class="fu">c</span>(<span class="st">"North"</span>, <span class="st">"South"</span>), </span>
<span id="cb343-3"><a href="#cb343-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">v.names =</span> <span class="st">"value"</span>, </span>
<span id="cb343-4"><a href="#cb343-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">idvar =</span> <span class="st">"country"</span>, </span>
<span id="cb343-5"><a href="#cb343-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">times =</span> <span class="fu">c</span>(<span class="st">"North"</span>, <span class="st">"South"</span>), </span>
<span id="cb343-6"><a href="#cb343-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">timevar =</span> <span class="st">"variable"</span>, </span>
<span id="cb343-7"><a href="#cb343-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">direction =</span> <span class="st">"long"</span>)</span>
<span id="cb343-8"><a href="#cb343-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(melted_df) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb343-9"><a href="#cb343-9" aria-hidden="true" tabindex="-1"></a>melted_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  country variable value
1  France    North   1.1
2   Italy    North   1.4
3  France    South   0.4
4   Italy    South   2.9</code></pre>
</div>
</div>
</div>
<div id="tabset-26-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-26-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb345"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb345-2"><a href="#cb345-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb345-3"><a href="#cb345-3" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span>country,</span>
<span id="cb345-4"><a href="#cb345-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"variable"</span>,</span>
<span id="cb345-5"><a href="#cb345-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"value"</span></span>
<span id="cb345-6"><a href="#cb345-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  country variable value
  &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt;
1 France  North      1.1
2 France  South      0.4
3 Italy   North      1.4
4 Italy   South      2.9</code></pre>
</div>
</div>
</div>
<div id="tabset-26-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-26-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb347"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true" tabindex="-1"></a>df_dt <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(df)</span>
<span id="cb347-2"><a href="#cb347-2" aria-hidden="true" tabindex="-1"></a><span class="fu">melt</span>(df_dt, <span class="at">id.vars =</span> <span class="st">"country"</span>, <span class="at">variable.name =</span> <span class="st">"variable"</span>, <span class="at">value.name =</span> <span class="st">"value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   country variable value
    &lt;char&gt;   &lt;fctr&gt; &lt;num&gt;
1:  France    North   1.1
2:   Italy    North   1.4
3:  France    South   0.4
4:   Italy    South   2.9</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="dealing-with-missing-values" class="level2" data-number="2.14">
<h2 data-number="2.14" class="anchored" data-anchor-id="dealing-with-missing-values"><span class="header-section-number">2.14</span> Dealing with missing values</h2>
<p>We have already introduced missing values in <a href="first_steps.html#missing-values">here</a>. In this section, we will go further and understand how to deal with missing values with polars and R.</p>
<section id="check-if-series-has-missing-values" class="level3" data-number="2.14.1">
<h3 data-number="2.14.1" class="anchored" data-anchor-id="check-if-series-has-missing-values"><span class="header-section-number">2.14.1</span> Check if Series has missing values</h3>
<p>The <code>is_null()</code> and <code>is_not_null()</code> methods can be used to check if <code>Series</code> has missing values.<br>
Theses methods are the equivalent of <code>is.na()</code> and <code>!is.na()</code> of R base.</p>
<p>Let’s see two examples combining thes methods with <code>select()</code> and <code>filter()</code> methods:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-27-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-1" role="tab" aria-controls="tabset-27-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-27-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-2" role="tab" aria-controls="tabset-27-2" aria-selected="false">R base</a></li></ul>
<div class="tab-content">
<div id="tabset-27-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-27-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb349"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true" tabindex="-1"></a>mydfNA <span class="ot">&lt;-</span> pl<span class="sc">$</span><span class="fu">DataFrame</span>(</span>
<span id="cb349-2"><a href="#cb349-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">colA =</span> <span class="fu">c</span>(<span class="st">"a"</span>,<span class="cn">NA</span>,<span class="st">"c"</span>),</span>
<span id="cb349-3"><a href="#cb349-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">colB =</span> <span class="fu">c</span>(<span class="st">"d"</span>,<span class="cn">NA</span>,<span class="cn">NA</span>)</span>
<span id="cb349-4"><a href="#cb349-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb349-5"><a href="#cb349-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-6"><a href="#cb349-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Find null values</span></span>
<span id="cb349-7"><a href="#cb349-7" aria-hidden="true" tabindex="-1"></a>mydfNA<span class="sc">$</span></span>
<span id="cb349-8"><a href="#cb349-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb349-9"><a href="#cb349-9" aria-hidden="true" tabindex="-1"></a>    pl<span class="sc">$</span><span class="fu">col</span>(<span class="st">"colA"</span>),</span>
<span id="cb349-10"><a href="#cb349-10" aria-hidden="true" tabindex="-1"></a>    pl<span class="sc">$</span><span class="fu">col</span>(<span class="st">"colA"</span>)<span class="sc">$</span><span class="fu">is_null</span>()<span class="sc">$</span><span class="fu">alias</span>(<span class="st">"is_null"</span>),</span>
<span id="cb349-11"><a href="#cb349-11" aria-hidden="true" tabindex="-1"></a>    pl<span class="sc">$</span><span class="fu">col</span>(<span class="st">"colA"</span>)<span class="sc">$</span><span class="fu">is_not_null</span>()<span class="sc">$</span><span class="fu">alias</span>(<span class="st">"is_not_null"</span>)</span>
<span id="cb349-12"><a href="#cb349-12" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 3)
┌──────┬─────────┬─────────────┐
│ colA ┆ is_null ┆ is_not_null │
│ ---  ┆ ---     ┆ ---         │
│ str  ┆ bool    ┆ bool        │
╞══════╪═════════╪═════════════╡
│ a    ┆ false   ┆ true        │
│ null ┆ true    ┆ false       │
│ c    ┆ false   ┆ true        │
└──────┴─────────┴─────────────┘</code></pre>
</div>
<div class="sourceCode cell-code" id="cb351"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter by null values</span></span>
<span id="cb351-2"><a href="#cb351-2" aria-hidden="true" tabindex="-1"></a>mydfNA<span class="sc">$</span></span>
<span id="cb351-3"><a href="#cb351-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb351-4"><a href="#cb351-4" aria-hidden="true" tabindex="-1"></a>    pl<span class="sc">$</span><span class="fu">col</span>(<span class="st">"colA"</span>)<span class="sc">$</span><span class="fu">is_not_null</span>() <span class="sc">&amp;</span> pl<span class="sc">$</span><span class="fu">col</span>(<span class="st">"colB"</span>)<span class="sc">$</span><span class="fu">is_not_null</span>()</span>
<span id="cb351-5"><a href="#cb351-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (1, 2)
┌──────┬──────┐
│ colA ┆ colB │
│ ---  ┆ ---  │
│ str  ┆ str  │
╞══════╪══════╡
│ a    ┆ d    │
└──────┴──────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-27-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-27-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb353"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a>mydfNA2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(mydfNA)</span>
<span id="cb353-2"><a href="#cb353-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-3"><a href="#cb353-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Find null values</span></span>
<span id="cb353-4"><a href="#cb353-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb353-5"><a href="#cb353-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">colA =</span> mydfNA2<span class="sc">$</span>colA,</span>
<span id="cb353-6"><a href="#cb353-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">is_null =</span> <span class="fu">is.na</span>(mydfNA2<span class="sc">$</span>colA),</span>
<span id="cb353-7"><a href="#cb353-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">is_not_null =</span> <span class="sc">!</span><span class="fu">is.na</span>(mydfNA2<span class="sc">$</span>colA)</span>
<span id="cb353-8"><a href="#cb353-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  colA is_null is_not_null
1    a   FALSE        TRUE
2 &lt;NA&gt;    TRUE       FALSE
3    c   FALSE        TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb355"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter by null values</span></span>
<span id="cb355-2"><a href="#cb355-2" aria-hidden="true" tabindex="-1"></a>mydfNA2[<span class="sc">!</span><span class="fu">is.na</span>(mydfNA2<span class="sc">$</span>colA) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(mydfNA2<span class="sc">$</span>colB), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  colA colB
1    a    d</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="replace-missing-values-with-a-constant" class="level3" data-number="2.14.2">
<h3 data-number="2.14.2" class="anchored" data-anchor-id="replace-missing-values-with-a-constant"><span class="header-section-number">2.14.2</span> Replace missing values with a constant</h3>
<p>The <code>fill_null()</code> method can be used to replace missing values in a <code>Series</code> with a constant.</p>
<p>Here’s some examples where I replace missing values from all columns of a <code>DataFrame</code>:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-28-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-28-1" role="tab" aria-controls="tabset-28-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-28-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-28-2" role="tab" aria-controls="tabset-28-2" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-28-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-28-3" role="tab" aria-controls="tabset-28-3" aria-selected="false">dplyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-28-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-28-4" role="tab" aria-controls="tabset-28-4" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-28-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-28-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb357"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb357-1"><a href="#cb357-1" aria-hidden="true" tabindex="-1"></a>mydfNA <span class="ot">&lt;-</span> pl<span class="sc">$</span><span class="fu">DataFrame</span>(</span>
<span id="cb357-2"><a href="#cb357-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">colA =</span> <span class="fu">c</span>(<span class="st">"a"</span>,<span class="cn">NA</span>,<span class="st">"c"</span>),</span>
<span id="cb357-3"><a href="#cb357-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">colB =</span> <span class="fu">c</span>(<span class="st">"d"</span>,<span class="cn">NA</span>,<span class="cn">NA</span>)</span>
<span id="cb357-4"><a href="#cb357-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb357-5"><a href="#cb357-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-6"><a href="#cb357-6" aria-hidden="true" tabindex="-1"></a><span class="co"># In the same columns</span></span>
<span id="cb357-7"><a href="#cb357-7" aria-hidden="true" tabindex="-1"></a>mydfNA<span class="sc">$</span></span>
<span id="cb357-8"><a href="#cb357-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with_columns</span>(</span>
<span id="cb357-9"><a href="#cb357-9" aria-hidden="true" tabindex="-1"></a>  pl<span class="sc">$</span><span class="fu">all</span>()<span class="sc">$</span><span class="fu">fill_null</span>(<span class="st">"missing"</span>)</span>
<span id="cb357-10"><a href="#cb357-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 2)
┌─────────┬─────────┐
│ colA    ┆ colB    │
│ ---     ┆ ---     │
│ str     ┆ str     │
╞═════════╪═════════╡
│ a       ┆ d       │
│ missing ┆ missing │
│ c       ┆ missing │
└─────────┴─────────┘</code></pre>
</div>
<div class="sourceCode cell-code" id="cb359"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="co"># In new columns suffixed by "_corrected"</span></span>
<span id="cb359-2"><a href="#cb359-2" aria-hidden="true" tabindex="-1"></a>mydfNA<span class="sc">$</span></span>
<span id="cb359-3"><a href="#cb359-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with_columns</span>(</span>
<span id="cb359-4"><a href="#cb359-4" aria-hidden="true" tabindex="-1"></a>  pl<span class="sc">$</span><span class="fu">all</span>()<span class="sc">$</span><span class="fu">fill_null</span>(<span class="st">"missing"</span>)<span class="sc">$</span>name<span class="sc">$</span><span class="fu">suffix</span>(<span class="st">"_corrected"</span>)</span>
<span id="cb359-5"><a href="#cb359-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 4)
┌──────┬──────┬────────────────┬────────────────┐
│ colA ┆ colB ┆ colA_corrected ┆ colB_corrected │
│ ---  ┆ ---  ┆ ---            ┆ ---            │
│ str  ┆ str  ┆ str            ┆ str            │
╞══════╪══════╪════════════════╪════════════════╡
│ a    ┆ d    ┆ a              ┆ d              │
│ null ┆ null ┆ missing        ┆ missing        │
│ c    ┆ null ┆ c              ┆ missing        │
└──────┴──────┴────────────────┴────────────────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-28-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-28-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb361"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true" tabindex="-1"></a>mydfNA2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(mydfNA)</span>
<span id="cb361-2"><a href="#cb361-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-3"><a href="#cb361-3" aria-hidden="true" tabindex="-1"></a><span class="co"># In the same columns</span></span>
<span id="cb361-4"><a href="#cb361-4" aria-hidden="true" tabindex="-1"></a>mydfNA2[<span class="fu">is.na</span>(mydfNA2)] <span class="ot">&lt;-</span> <span class="st">"missing"</span></span>
<span id="cb361-5"><a href="#cb361-5" aria-hidden="true" tabindex="-1"></a>mydfNA2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     colA    colB
1       a       d
2 missing missing
3       c missing</code></pre>
</div>
<div class="sourceCode cell-code" id="cb363"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="co"># In new columns suffixed by "_corrected"</span></span>
<span id="cb363-2"><a href="#cb363-2" aria-hidden="true" tabindex="-1"></a>mydfNA2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(mydfNA)</span>
<span id="cb363-3"><a href="#cb363-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-4"><a href="#cb363-4" aria-hidden="true" tabindex="-1"></a><span class="fu">transform</span>(mydfNA2,</span>
<span id="cb363-5"><a href="#cb363-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">colA_corrected =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(colA), <span class="st">"missing"</span>, colA),</span>
<span id="cb363-6"><a href="#cb363-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">colB_corrected =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(colB), <span class="st">"missing"</span>, colB))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  colA colB colA_corrected colB_corrected
1    a    d              a              d
2 &lt;NA&gt; &lt;NA&gt;        missing        missing
3    c &lt;NA&gt;              c        missing</code></pre>
</div>
</div>
</div>
<div id="tabset-28-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-28-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb365"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true" tabindex="-1"></a>mydfNA2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(mydfNA)</span>
<span id="cb365-2"><a href="#cb365-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-3"><a href="#cb365-3" aria-hidden="true" tabindex="-1"></a><span class="co"># In the same columns</span></span>
<span id="cb365-4"><a href="#cb365-4" aria-hidden="true" tabindex="-1"></a>mydfNA2 <span class="sc">%&gt;%</span></span>
<span id="cb365-5"><a href="#cb365-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span><span class="fu">ifelse</span>(<span class="fu">is.na</span>(.), <span class="st">"missing"</span>, .)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     colA    colB
1       a       d
2 missing missing
3       c missing</code></pre>
</div>
<div class="sourceCode cell-code" id="cb367"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true" tabindex="-1"></a><span class="co"># In new columns suffixed by "_corrected"</span></span>
<span id="cb367-2"><a href="#cb367-2" aria-hidden="true" tabindex="-1"></a>mydfNA2 <span class="sc">%&gt;%</span></span>
<span id="cb367-3"><a href="#cb367-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(colA, colB), <span class="sc">~</span><span class="fu">ifelse</span>(<span class="fu">is.na</span>(.), <span class="st">"missing"</span>, .), <span class="at">.names =</span> <span class="st">"{col}_corrected"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  colA colB colA_corrected colB_corrected
1    a    d              a              d
2 &lt;NA&gt; &lt;NA&gt;        missing        missing
3    c &lt;NA&gt;              c        missing</code></pre>
</div>
</div>
</div>
<div id="tabset-28-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-28-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb369"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true" tabindex="-1"></a>mydfNA2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(mydfNA)</span>
<span id="cb369-2"><a href="#cb369-2" aria-hidden="true" tabindex="-1"></a>mydfNA2_dt <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(mydfNA2)</span>
<span id="cb369-3"><a href="#cb369-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-4"><a href="#cb369-4" aria-hidden="true" tabindex="-1"></a><span class="co"># In the same columns</span></span>
<span id="cb369-5"><a href="#cb369-5" aria-hidden="true" tabindex="-1"></a>mydfNA2_dt[<span class="fu">is.na</span>(mydfNA2_dt)] <span class="ot">&lt;-</span> <span class="st">"missing"</span></span>
<span id="cb369-6"><a href="#cb369-6" aria-hidden="true" tabindex="-1"></a>mydfNA2_dt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      colA    colB
    &lt;char&gt;  &lt;char&gt;
1:       a       d
2: missing missing
3:       c missing</code></pre>
</div>
<div class="sourceCode cell-code" id="cb371"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb371-1"><a href="#cb371-1" aria-hidden="true" tabindex="-1"></a><span class="co"># In new columns suffixed by "_corrected"</span></span>
<span id="cb371-2"><a href="#cb371-2" aria-hidden="true" tabindex="-1"></a>mydfNA2_dt[,</span>
<span id="cb371-3"><a href="#cb371-3" aria-hidden="true" tabindex="-1"></a>           <span class="fu">c</span>(<span class="st">"colA_corrected"</span>, <span class="st">"colB_corrected"</span>) <span class="sc">:</span><span class="er">=</span> <span class="fu">lapply</span>(.SD, <span class="cf">function</span>(x) <span class="fu">ifelse</span>(<span class="fu">is.na</span>(x), <span class="st">"missing"</span>, x)),</span>
<span id="cb371-4"><a href="#cb371-4" aria-hidden="true" tabindex="-1"></a>           .SDcols <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"colA"</span>, <span class="st">"colB"</span>)]</span>
<span id="cb371-5"><a href="#cb371-5" aria-hidden="true" tabindex="-1"></a>mydfNA2_dt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      colA    colB colA_corrected colB_corrected
    &lt;char&gt;  &lt;char&gt;         &lt;char&gt;         &lt;char&gt;
1:       a       d              a              d
2: missing missing        missing        missing
3:       c missing              c        missing</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Be careful, <strong>the <code>fill_null()</code> method can in some cases modify data types like <code>cast()</code>.</strong> This can happen, for example, when you’re working on an integer column and you want to replace the missing values with a string =&gt; the column will then has a string dtype!</p>
</div>
</div>
</section>
<section id="replace-missing-values-with-a-strategy" class="level3" data-number="2.14.3">
<h3 data-number="2.14.3" class="anchored" data-anchor-id="replace-missing-values-with-a-strategy"><span class="header-section-number">2.14.3</span> Replace missing values with a strategy</h3>
<p>The <code>fill_null()</code> method of polars has a <code>strategy</code> argument for replacing missing values:</p>
<ul>
<li><code>forward</code>: replace with the previous non-null value in the <code>Series</code></li>
<li><code>backward</code>: replace with the next non-null value in the <code>Series</code></li>
<li><code>min</code>: replace with the smallest value in the <code>Series</code></li>
<li><code>max</code>: replace with the largest value in the <code>Series</code></li>
<li><code>mean</code>: replace with the median value in the <code>Series</code></li>
<li><code>zero</code>: replace with <code>0</code></li>
<li><code>one</code>: replace with <code>1</code></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>We can set a limit on how many rows to fill-forward or backward with <code>limit</code></p>
</div>
</div>
<p>Here’s some examples :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb373"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb373-1"><a href="#cb373-1" aria-hidden="true" tabindex="-1"></a><span class="co"># In the same columns</span></span>
<span id="cb373-2"><a href="#cb373-2" aria-hidden="true" tabindex="-1"></a>mydfNA <span class="ot">&lt;-</span> pl<span class="sc">$</span><span class="fu">DataFrame</span>(</span>
<span id="cb373-3"><a href="#cb373-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">colA =</span> <span class="fu">c</span>(<span class="st">"a"</span>,<span class="cn">NA</span>,<span class="st">"c"</span>),</span>
<span id="cb373-4"><a href="#cb373-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">colB =</span> <span class="fu">c</span>(<span class="st">"d"</span>,<span class="cn">NA</span>,<span class="cn">NA</span>),</span>
<span id="cb373-5"><a href="#cb373-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">colC =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="cn">NA</span>,<span class="dv">3</span>)</span>
<span id="cb373-6"><a href="#cb373-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb373-7"><a href="#cb373-7" aria-hidden="true" tabindex="-1"></a><span class="co"># With forward strategy</span></span>
<span id="cb373-8"><a href="#cb373-8" aria-hidden="true" tabindex="-1"></a>mydfNA<span class="sc">$</span></span>
<span id="cb373-9"><a href="#cb373-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with_columns</span>(</span>
<span id="cb373-10"><a href="#cb373-10" aria-hidden="true" tabindex="-1"></a>    pl<span class="sc">$</span><span class="fu">all</span>()<span class="sc">$</span><span class="fu">fill_null</span>(<span class="at">strategy =</span> <span class="st">"forward"</span>)<span class="sc">$</span>name<span class="sc">$</span><span class="fu">suffix</span>(<span class="st">"_corrected"</span>)</span>
<span id="cb373-11"><a href="#cb373-11" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 6)
┌──────┬──────┬──────┬────────────────┬────────────────┬────────────────┐
│ colA ┆ colB ┆ colC ┆ colA_corrected ┆ colB_corrected ┆ colC_corrected │
│ ---  ┆ ---  ┆ ---  ┆ ---            ┆ ---            ┆ ---            │
│ str  ┆ str  ┆ f64  ┆ str            ┆ str            ┆ f64            │
╞══════╪══════╪══════╪════════════════╪════════════════╪════════════════╡
│ a    ┆ d    ┆ 1.0  ┆ a              ┆ d              ┆ 1.0            │
│ null ┆ null ┆ null ┆ a              ┆ d              ┆ 1.0            │
│ c    ┆ null ┆ 3.0  ┆ c              ┆ d              ┆ 3.0            │
└──────┴──────┴──────┴────────────────┴────────────────┴────────────────┘</code></pre>
</div>
<div class="sourceCode cell-code" id="cb375"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With forward strategy and a limit</span></span>
<span id="cb375-2"><a href="#cb375-2" aria-hidden="true" tabindex="-1"></a>mydfNA<span class="sc">$</span></span>
<span id="cb375-3"><a href="#cb375-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with_columns</span>(</span>
<span id="cb375-4"><a href="#cb375-4" aria-hidden="true" tabindex="-1"></a>    pl<span class="sc">$</span><span class="fu">all</span>()<span class="sc">$</span><span class="fu">fill_null</span>(<span class="at">strategy =</span> <span class="st">"forward"</span>, <span class="at">limit =</span> <span class="dv">1</span>)<span class="sc">$</span>name<span class="sc">$</span><span class="fu">suffix</span>(<span class="st">"_corrected"</span>)</span>
<span id="cb375-5"><a href="#cb375-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 6)
┌──────┬──────┬──────┬────────────────┬────────────────┬────────────────┐
│ colA ┆ colB ┆ colC ┆ colA_corrected ┆ colB_corrected ┆ colC_corrected │
│ ---  ┆ ---  ┆ ---  ┆ ---            ┆ ---            ┆ ---            │
│ str  ┆ str  ┆ f64  ┆ str            ┆ str            ┆ f64            │
╞══════╪══════╪══════╪════════════════╪════════════════╪════════════════╡
│ a    ┆ d    ┆ 1.0  ┆ a              ┆ d              ┆ 1.0            │
│ null ┆ null ┆ null ┆ a              ┆ d              ┆ 1.0            │
│ c    ┆ null ┆ 3.0  ┆ c              ┆ null           ┆ 3.0            │
└──────┴──────┴──────┴────────────────┴────────────────┴────────────────┘</code></pre>
</div>
<div class="sourceCode cell-code" id="cb377"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb377-1"><a href="#cb377-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With backward strategy</span></span>
<span id="cb377-2"><a href="#cb377-2" aria-hidden="true" tabindex="-1"></a>mydfNA<span class="sc">$</span></span>
<span id="cb377-3"><a href="#cb377-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with_columns</span>(</span>
<span id="cb377-4"><a href="#cb377-4" aria-hidden="true" tabindex="-1"></a>    pl<span class="sc">$</span><span class="fu">all</span>()<span class="sc">$</span><span class="fu">fill_null</span>(<span class="at">strategy =</span> <span class="st">"backward"</span>)<span class="sc">$</span>name<span class="sc">$</span><span class="fu">suffix</span>(<span class="st">"_corrected"</span>)</span>
<span id="cb377-5"><a href="#cb377-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 6)
┌──────┬──────┬──────┬────────────────┬────────────────┬────────────────┐
│ colA ┆ colB ┆ colC ┆ colA_corrected ┆ colB_corrected ┆ colC_corrected │
│ ---  ┆ ---  ┆ ---  ┆ ---            ┆ ---            ┆ ---            │
│ str  ┆ str  ┆ f64  ┆ str            ┆ str            ┆ f64            │
╞══════╪══════╪══════╪════════════════╪════════════════╪════════════════╡
│ a    ┆ d    ┆ 1.0  ┆ a              ┆ d              ┆ 1.0            │
│ null ┆ null ┆ null ┆ c              ┆ null           ┆ 3.0            │
│ c    ┆ null ┆ 3.0  ┆ c              ┆ null           ┆ 3.0            │
└──────┴──────┴──────┴────────────────┴────────────────┴────────────────┘</code></pre>
</div>
<div class="sourceCode cell-code" id="cb379"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb379-1"><a href="#cb379-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With mean strategy only on "colC" column</span></span>
<span id="cb379-2"><a href="#cb379-2" aria-hidden="true" tabindex="-1"></a>mydfNA<span class="sc">$</span></span>
<span id="cb379-3"><a href="#cb379-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with_columns</span>(</span>
<span id="cb379-4"><a href="#cb379-4" aria-hidden="true" tabindex="-1"></a>    pl<span class="sc">$</span><span class="fu">col</span>(<span class="st">"colC"</span>)<span class="sc">$</span><span class="fu">fill_null</span>(<span class="at">strategy =</span> <span class="st">"mean"</span>)<span class="sc">$</span>name<span class="sc">$</span><span class="fu">suffix</span>(<span class="st">"_corrected"</span>)</span>
<span id="cb379-5"><a href="#cb379-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 4)
┌──────┬──────┬──────┬────────────────┐
│ colA ┆ colB ┆ colC ┆ colC_corrected │
│ ---  ┆ ---  ┆ ---  ┆ ---            │
│ str  ┆ str  ┆ f64  ┆ f64            │
╞══════╪══════╪══════╪════════════════╡
│ a    ┆ d    ┆ 1.0  ┆ 1.0            │
│ null ┆ null ┆ null ┆ 2.0            │
│ c    ┆ null ┆ 3.0  ┆ 3.0            │
└──────┴──────┴──────┴────────────────┘</code></pre>
</div>
</div>
</section>
<section id="replace-missing-values-with-an-expression" class="level3" data-number="2.14.4">
<h3 data-number="2.14.4" class="anchored" data-anchor-id="replace-missing-values-with-an-expression"><span class="header-section-number">2.14.4</span> Replace missing values with an expression</h3>
<p>Of course, you are not limited to the built-in strategies of polars =&gt; with <code>fill_null()</code> you can also use expressions to replace missing values. It works with expression from the same column and from another column.</p>
<p>Here’s some examples:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-29-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-29-1" role="tab" aria-controls="tabset-29-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-29-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-29-2" role="tab" aria-controls="tabset-29-2" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-29-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-29-3" role="tab" aria-controls="tabset-29-3" aria-selected="false">dplyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-29-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-29-4" role="tab" aria-controls="tabset-29-4" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-29-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-29-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb381"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb381-1"><a href="#cb381-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace missing values with the mean of the non-null values for that column</span></span>
<span id="cb381-2"><a href="#cb381-2" aria-hidden="true" tabindex="-1"></a>mydfNA<span class="sc">$</span></span>
<span id="cb381-3"><a href="#cb381-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with_columns</span>(</span>
<span id="cb381-4"><a href="#cb381-4" aria-hidden="true" tabindex="-1"></a>    pl<span class="sc">$</span><span class="fu">col</span>(<span class="st">"colC"</span>)<span class="sc">$</span><span class="fu">fill_null</span>(<span class="at">strategy =</span> <span class="st">"mean"</span>)<span class="sc">$</span>name<span class="sc">$</span><span class="fu">suffix</span>(<span class="st">"_corrected"</span>)</span>
<span id="cb381-5"><a href="#cb381-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 4)
┌──────┬──────┬──────┬────────────────┐
│ colA ┆ colB ┆ colC ┆ colC_corrected │
│ ---  ┆ ---  ┆ ---  ┆ ---            │
│ str  ┆ str  ┆ f64  ┆ f64            │
╞══════╪══════╪══════╪════════════════╡
│ a    ┆ d    ┆ 1.0  ┆ 1.0            │
│ null ┆ null ┆ null ┆ 2.0            │
│ c    ┆ null ┆ 3.0  ┆ 3.0            │
└──────┴──────┴──────┴────────────────┘</code></pre>
</div>
<div class="sourceCode cell-code" id="cb383"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb383-1"><a href="#cb383-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace missing values with the values from another column</span></span>
<span id="cb383-2"><a href="#cb383-2" aria-hidden="true" tabindex="-1"></a>mydfNA<span class="sc">$</span></span>
<span id="cb383-3"><a href="#cb383-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with_columns</span>(</span>
<span id="cb383-4"><a href="#cb383-4" aria-hidden="true" tabindex="-1"></a>    pl<span class="sc">$</span><span class="fu">col</span>(<span class="st">"colB"</span>)<span class="sc">$</span><span class="fu">fill_null</span>(pl<span class="sc">$</span><span class="fu">col</span>(<span class="st">"colA"</span>))<span class="sc">$</span>name<span class="sc">$</span><span class="fu">suffix</span>(<span class="st">"_corrected"</span>)</span>
<span id="cb383-5"><a href="#cb383-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 4)
┌──────┬──────┬──────┬────────────────┐
│ colA ┆ colB ┆ colC ┆ colB_corrected │
│ ---  ┆ ---  ┆ ---  ┆ ---            │
│ str  ┆ str  ┆ f64  ┆ str            │
╞══════╪══════╪══════╪════════════════╡
│ a    ┆ d    ┆ 1.0  ┆ d              │
│ null ┆ null ┆ null ┆ null           │
│ c    ┆ null ┆ 3.0  ┆ c              │
└──────┴──────┴──────┴────────────────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-29-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-29-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb385"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true" tabindex="-1"></a>mydfNA2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(mydfNA)</span>
<span id="cb385-2"><a href="#cb385-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-3"><a href="#cb385-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace missing values with the mean of the non-null values for that column</span></span>
<span id="cb385-4"><a href="#cb385-4" aria-hidden="true" tabindex="-1"></a>mydfNA2<span class="sc">$</span>colC_corrected <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(mydfNA2<span class="sc">$</span>colC), <span class="fu">mean</span>(mydfNA2<span class="sc">$</span>colC, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), mydfNA2<span class="sc">$</span>colC)</span>
<span id="cb385-5"><a href="#cb385-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-6"><a href="#cb385-6" aria-hidden="true" tabindex="-1"></a>mydfNA2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(mydfNA)</span>
<span id="cb385-7"><a href="#cb385-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace missing values with the values from another column</span></span>
<span id="cb385-8"><a href="#cb385-8" aria-hidden="true" tabindex="-1"></a>mydfNA2<span class="sc">$</span>colB_corrected <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(mydfNA2<span class="sc">$</span>colB), mydfNA2<span class="sc">$</span>colA, mydfNA2<span class="sc">$</span>colB)</span>
<span id="cb385-9"><a href="#cb385-9" aria-hidden="true" tabindex="-1"></a>mydfNA2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  colA colB colC colB_corrected
1    a    d    1              d
2 &lt;NA&gt; &lt;NA&gt;   NA           &lt;NA&gt;
3    c &lt;NA&gt;    3              c</code></pre>
</div>
</div>
</div>
<div id="tabset-29-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-29-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb387"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb387-1"><a href="#cb387-1" aria-hidden="true" tabindex="-1"></a>mydfNA2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(mydfNA)</span>
<span id="cb387-2"><a href="#cb387-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb387-3"><a href="#cb387-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace missing values with the mean of the non-null values for that column</span></span>
<span id="cb387-4"><a href="#cb387-4" aria-hidden="true" tabindex="-1"></a>mydfNA2 <span class="sc">%&gt;%</span></span>
<span id="cb387-5"><a href="#cb387-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">colC_corrected =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(colC), <span class="fu">mean</span>(mydfNA2<span class="sc">$</span>colC, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), colC))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  colA colB colC colC_corrected
1    a    d    1              1
2 &lt;NA&gt; &lt;NA&gt;   NA              2
3    c &lt;NA&gt;    3              3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb389"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb389-1"><a href="#cb389-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace missing values with the values from another column</span></span>
<span id="cb389-2"><a href="#cb389-2" aria-hidden="true" tabindex="-1"></a>mydfNA2 <span class="sc">%&gt;%</span></span>
<span id="cb389-3"><a href="#cb389-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">colB_corrected =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(colB), colA, colB))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  colA colB colC colB_corrected
1    a    d    1              d
2 &lt;NA&gt; &lt;NA&gt;   NA           &lt;NA&gt;
3    c &lt;NA&gt;    3              c</code></pre>
</div>
</div>
</div>
<div id="tabset-29-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-29-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb391"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb391-1"><a href="#cb391-1" aria-hidden="true" tabindex="-1"></a>mydfNA2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(mydfNA)</span>
<span id="cb391-2"><a href="#cb391-2" aria-hidden="true" tabindex="-1"></a>mydfNA2_dt <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(mydfNA2)</span>
<span id="cb391-3"><a href="#cb391-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb391-4"><a href="#cb391-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace missing values with the mean of the non-null values for that column</span></span>
<span id="cb391-5"><a href="#cb391-5" aria-hidden="true" tabindex="-1"></a>mydfNA2_dt[, colC_corrected <span class="sc">:</span><span class="er">=</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(colC), <span class="fu">mean</span>(mydfNA2_dt<span class="sc">$</span>colC, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), colC)]</span>
<span id="cb391-6"><a href="#cb391-6" aria-hidden="true" tabindex="-1"></a>mydfNA2_dt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     colA   colB  colC colC_corrected
   &lt;char&gt; &lt;char&gt; &lt;num&gt;          &lt;num&gt;
1:      a      d     1              1
2:   &lt;NA&gt;   &lt;NA&gt;    NA              2
3:      c   &lt;NA&gt;     3              3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb393"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb393-1"><a href="#cb393-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace missing values with the values from another column</span></span>
<span id="cb393-2"><a href="#cb393-2" aria-hidden="true" tabindex="-1"></a>mydfNA2_dt[, colB_corrected <span class="sc">:</span><span class="er">=</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(colB), colA, colB)]</span>
<span id="cb393-3"><a href="#cb393-3" aria-hidden="true" tabindex="-1"></a>mydfNA2_dt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     colA   colB  colC colC_corrected colB_corrected
   &lt;char&gt; &lt;char&gt; &lt;num&gt;          &lt;num&gt;         &lt;char&gt;
1:      a      d     1              1              d
2:   &lt;NA&gt;   &lt;NA&gt;    NA              2           &lt;NA&gt;
3:      c   &lt;NA&gt;     3              3              c</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="replace-missing-values-with-a-sequence-of-columns" class="level3" data-number="2.14.5">
<h3 data-number="2.14.5" class="anchored" data-anchor-id="replace-missing-values-with-a-sequence-of-columns"><span class="header-section-number">2.14.5</span> Replace missing values with a sequence of columns</h3>
<p>The <code>coalesce()</code> method can be used to replace missing values based on a sequence of columns.</p>
<p>Here’s an example creating a new column “col4” that has the first non-null value as we go through some columns (in order!):</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-30-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-30-1" role="tab" aria-controls="tabset-30-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-30-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-30-2" role="tab" aria-controls="tabset-30-2" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-30-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-30-3" role="tab" aria-controls="tabset-30-3" aria-selected="false">dplyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-30-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-30-4" role="tab" aria-controls="tabset-30-4" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-30-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-30-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb395"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb395-1"><a href="#cb395-1" aria-hidden="true" tabindex="-1"></a>mynewdfNA <span class="ot">&lt;-</span> pl<span class="sc">$</span><span class="fu">DataFrame</span>(</span>
<span id="cb395-2"><a href="#cb395-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">col1 =</span> <span class="fu">c</span>(<span class="cn">NA</span>,<span class="st">"y"</span>,<span class="cn">NA</span>),</span>
<span id="cb395-3"><a href="#cb395-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">col2 =</span> <span class="fu">c</span>(<span class="cn">NA</span>,<span class="st">"v"</span>,<span class="st">"w"</span>),</span>
<span id="cb395-4"><a href="#cb395-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">col3 =</span> <span class="fu">c</span>(<span class="st">"r"</span>,<span class="st">"s"</span>,<span class="cn">NA</span>)</span>
<span id="cb395-5"><a href="#cb395-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb395-6"><a href="#cb395-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-7"><a href="#cb395-7" aria-hidden="true" tabindex="-1"></a>mynewdfNA<span class="sc">$</span></span>
<span id="cb395-8"><a href="#cb395-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with_columns</span>(</span>
<span id="cb395-9"><a href="#cb395-9" aria-hidden="true" tabindex="-1"></a>    pl<span class="sc">$</span><span class="fu">coalesce</span>(<span class="st">"col1"</span>,<span class="st">"col2"</span>,<span class="st">"col3"</span>)<span class="sc">$</span><span class="fu">alias</span>(<span class="st">"col4"</span>)</span>
<span id="cb395-10"><a href="#cb395-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 4)
┌──────┬──────┬──────┬──────┐
│ col1 ┆ col2 ┆ col3 ┆ col4 │
│ ---  ┆ ---  ┆ ---  ┆ ---  │
│ str  ┆ str  ┆ str  ┆ str  │
╞══════╪══════╪══════╪══════╡
│ null ┆ null ┆ r    ┆ r    │
│ y    ┆ v    ┆ s    ┆ y    │
│ null ┆ w    ┆ null ┆ w    │
└──────┴──────┴──────┴──────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-30-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-30-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb397"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb397-1"><a href="#cb397-1" aria-hidden="true" tabindex="-1"></a>mynewdfNA2 <span class="ot">&lt;-</span>  <span class="fu">as.data.frame</span>(mynewdfNA)</span>
<span id="cb397-2"><a href="#cb397-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb397-3"><a href="#cb397-3" aria-hidden="true" tabindex="-1"></a>mynewdfNA2<span class="sc">$</span>col4 <span class="ot">&lt;-</span> <span class="fu">coalesce</span>(mynewdfNA2<span class="sc">$</span>col1, mynewdfNA2<span class="sc">$</span>col2, mynewdfNA2<span class="sc">$</span>col3)</span>
<span id="cb397-4"><a href="#cb397-4" aria-hidden="true" tabindex="-1"></a>mynewdfNA2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  col1 col2 col3 col4
1 &lt;NA&gt; &lt;NA&gt;    r    r
2    y    v    s    y
3 &lt;NA&gt;    w &lt;NA&gt;    w</code></pre>
</div>
</div>
</div>
<div id="tabset-30-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-30-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb399"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb399-1"><a href="#cb399-1" aria-hidden="true" tabindex="-1"></a>mynewdfNA2 <span class="ot">&lt;-</span>  <span class="fu">as.data.frame</span>(mynewdfNA)</span>
<span id="cb399-2"><a href="#cb399-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-3"><a href="#cb399-3" aria-hidden="true" tabindex="-1"></a>mynewdfNA2 <span class="sc">%&gt;%</span></span>
<span id="cb399-4"><a href="#cb399-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">col4 =</span> <span class="fu">coalesce</span>(col1, col2, col3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  col1 col2 col3 col4
1 &lt;NA&gt; &lt;NA&gt;    r    r
2    y    v    s    y
3 &lt;NA&gt;    w &lt;NA&gt;    w</code></pre>
</div>
</div>
</div>
<div id="tabset-30-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-30-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb401"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb401-1"><a href="#cb401-1" aria-hidden="true" tabindex="-1"></a>mynewdfNA2 <span class="ot">&lt;-</span>   <span class="fu">as.data.frame</span>(mynewdfNA)</span>
<span id="cb401-2"><a href="#cb401-2" aria-hidden="true" tabindex="-1"></a>mynewdfNA2_dt <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(mynewdfNA2)</span>
<span id="cb401-3"><a href="#cb401-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb401-4"><a href="#cb401-4" aria-hidden="true" tabindex="-1"></a>mynewdfNA2_dt[, col4 <span class="sc">:</span><span class="er">=</span> <span class="fu">fcoalesce</span>(col1, col2, col3)]</span>
<span id="cb401-5"><a href="#cb401-5" aria-hidden="true" tabindex="-1"></a>mynewdfNA2_dt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     col1   col2   col3   col4
   &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt;
1:   &lt;NA&gt;   &lt;NA&gt;      r      r
2:      y      v      s      y
3:   &lt;NA&gt;      w   &lt;NA&gt;      w</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="others-useful-methods" class="level2" data-number="2.15">
<h2 data-number="2.15" class="anchored" data-anchor-id="others-useful-methods"><span class="header-section-number">2.15</span> Others useful methods</h2>
<section id="on-series" class="level3" data-number="2.15.1">
<h3 data-number="2.15.1" class="anchored" data-anchor-id="on-series"><span class="header-section-number">2.15.1</span> On Series</h3>
<section id="change-name-of-series" class="level4" data-number="2.15.1.1">
<h4 data-number="2.15.1.1" class="anchored" data-anchor-id="change-name-of-series"><span class="header-section-number">2.15.1.1</span> Change name of Series</h4>
<p>The <code>alias()</code> method is very useful especially in method chaining operation.<br>
With R base, the syntax is longer.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-31-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-31-1" role="tab" aria-controls="tabset-31-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-31-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-31-2" role="tab" aria-controls="tabset-31-2" aria-selected="false">R base</a></li></ul>
<div class="tab-content">
<div id="tabset-31-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-31-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb403"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb403-1"><a href="#cb403-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_series</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">name =</span> <span class="st">"toto"</span>)<span class="sc">$</span><span class="fu">alias</span>(<span class="st">"titi"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 1)
┌──────┐
│ titi │
│ ---  │
│ i32  │
╞══════╡
│ 1    │
│ 2    │
│ 3    │
└──────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-31-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-31-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb405"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb405-1"><a href="#cb405-1" aria-hidden="true" tabindex="-1"></a>toto <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb405-2"><a href="#cb405-2" aria-hidden="true" tabindex="-1"></a>titi <span class="ot">&lt;-</span> toto</span>
<span id="cb405-3"><a href="#cb405-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(toto)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="reduce-boolean-series" class="level4" data-number="2.15.1.2">
<h4 data-number="2.15.1.2" class="anchored" data-anchor-id="reduce-boolean-series"><span class="header-section-number">2.15.1.2</span> Reduce Boolean Series</h4>
<p>The <code>all()</code> and <code>any()</code> methods can be used to check if all or any values in a vector evaluate to TRUE for some expression.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-32-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-32-1" role="tab" aria-controls="tabset-32-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-32-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-32-2" role="tab" aria-controls="tabset-32-2" aria-selected="false">R base</a></li></ul>
<div class="tab-content">
<div id="tabset-32-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-32-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb406"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb406-1"><a href="#cb406-1" aria-hidden="true" tabindex="-1"></a><span class="co"># all(as_polars_series(c(TRUE,TRUE))) doesn't work</span></span>
<span id="cb406-2"><a href="#cb406-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_series</span>(<span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">NA</span>))<span class="sc">$</span><span class="fu">all</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (1, 1)
┌──────┐
│      │
│ ---  │
│ bool │
╞══════╡
│ true │
└──────┘</code></pre>
</div>
<div class="sourceCode cell-code" id="cb408"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb408-1"><a href="#cb408-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_series</span>(<span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>))<span class="sc">$</span><span class="fu">all</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (1, 1)
┌───────┐
│       │
│ ---   │
│ bool  │
╞═══════╡
│ false │
└───────┘</code></pre>
</div>
<div class="sourceCode cell-code" id="cb410"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb410-1"><a href="#cb410-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_series</span>(<span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>))<span class="sc">$</span><span class="fu">all</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (1, 1)
┌──────┐
│      │
│ ---  │
│ bool │
╞══════╡
│ true │
└──────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-32-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-32-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb412"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb412-1"><a href="#cb412-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(<span class="fu">c</span>(<span class="cn">TRUE</span>,<span class="cn">TRUE</span>,<span class="cn">NA</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb414"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb414-1"><a href="#cb414-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(<span class="fu">c</span>(<span class="cn">TRUE</span>,<span class="cn">TRUE</span>,<span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb416"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb416-1"><a href="#cb416-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(<span class="fu">c</span>(<span class="cn">TRUE</span>,<span class="cn">TRUE</span>,<span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="get-data-type-of-series" class="level4" data-number="2.15.1.3">
<h4 data-number="2.15.1.3" class="anchored" data-anchor-id="get-data-type-of-series"><span class="header-section-number">2.15.1.3</span> Get data type of Series</h4>
<p>The <code>dtype()</code> method can be used to get data type of <code>Series</code>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-33-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-33-1" role="tab" aria-controls="tabset-33-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-33-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-33-2" role="tab" aria-controls="tabset-33-2" aria-selected="false">R base</a></li></ul>
<div class="tab-content">
<div id="tabset-33-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-33-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb418"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb418-1"><a href="#cb418-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_series</span>(letters)<span class="sc">$</span>dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>String</code></pre>
</div>
<div class="sourceCode cell-code" id="cb420"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb420-1"><a href="#cb420-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_series</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))<span class="sc">$</span>dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Float64</code></pre>
</div>
</div>
</div>
<div id="tabset-33-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-33-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb422"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb422-1"><a href="#cb422-1" aria-hidden="true" tabindex="-1"></a><span class="fu">infer_type</span>(letters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Utf8
string</code></pre>
</div>
<div class="sourceCode cell-code" id="cb424"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb424-1"><a href="#cb424-1" aria-hidden="true" tabindex="-1"></a><span class="fu">infer_type</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Float64
double</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Polars is strongly typed. <code>print(ls(pl$dtypes))</code> returns the full list of valid Polars types. Caution, some type names differ from what they are called in R base. See below!</p>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-34-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-34-1" role="tab" aria-controls="tabset-34-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-34-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-34-2" role="tab" aria-controls="tabset-34-2" aria-selected="false">R base</a></li></ul>
<div class="tab-content">
<div id="tabset-34-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-34-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb426"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb426-1"><a href="#cb426-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_series</span>(<span class="fu">c</span>(<span class="st">"x"</span>,<span class="st">"y"</span>,<span class="st">"z"</span>))<span class="sc">$</span>dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>String</code></pre>
</div>
<div class="sourceCode cell-code" id="cb428"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb428-1"><a href="#cb428-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_series</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>))<span class="sc">$</span>dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Float64</code></pre>
</div>
<div class="sourceCode cell-code" id="cb430"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb430-1"><a href="#cb430-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_series</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>))<span class="sc">$</span>dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Int32</code></pre>
</div>
<div class="sourceCode cell-code" id="cb432"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb432-1"><a href="#cb432-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_series</span>(<span class="fu">c</span>(<span class="cn">TRUE</span>,<span class="cn">FALSE</span>))<span class="sc">$</span>dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Boolean</code></pre>
</div>
<div class="sourceCode cell-code" id="cb434"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb434-1"><a href="#cb434-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_series</span>(<span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"a"</span>,<span class="st">"b"</span>,<span class="st">"c"</span>)))<span class="sc">$</span>dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Categorical(ordering='lexical')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb436"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb436-1"><a href="#cb436-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_series</span>(<span class="fu">Sys.Date</span>())<span class="sc">$</span>dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Date</code></pre>
</div>
<div class="sourceCode cell-code" id="cb438"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb438-1"><a href="#cb438-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_series</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="sc">$</span>dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Float64</code></pre>
</div>
</div>
</div>
<div id="tabset-34-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-34-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb440"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb440-1"><a href="#cb440-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(<span class="fu">c</span>(<span class="st">"x"</span>,<span class="st">"y"</span>,<span class="st">"z"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb442"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb442-1"><a href="#cb442-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "double"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb444"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb444-1"><a href="#cb444-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "integer"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb446"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb446-1"><a href="#cb446-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(<span class="fu">c</span>(<span class="cn">TRUE</span>,<span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "logical"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb448"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb448-1"><a href="#cb448-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(<span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"a"</span>,<span class="st">"b"</span>,<span class="st">"c"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "integer"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb450"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb450-1"><a href="#cb450-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(<span class="fu">Sys.Date</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "double"</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>To summarise the main types between Polars and R:</p>
<table class="table">
<thead>
<tr class="header">
<th>Polars</th>
<th>R Base</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>String</td>
<td>character</td>
</tr>
<tr class="even">
<td>Float64</td>
<td>double</td>
</tr>
<tr class="odd">
<td>Int32</td>
<td>integer</td>
</tr>
<tr class="even">
<td>Boolean</td>
<td>logical</td>
</tr>
<tr class="odd">
<td>Categorical</td>
<td>Factor</td>
</tr>
<tr class="even">
<td>Date</td>
<td>Date</td>
</tr>
</tbody>
</table>
<p>To learn more about Data types in Polars, see <a href="https://pola-rs.github.io/polars-book/user-guide/concepts/data-types/">here</a>.</p>
</section>
<section id="cast" class="level4" data-number="2.15.1.4">
<h4 data-number="2.15.1.4" class="anchored" data-anchor-id="cast"><span class="header-section-number">2.15.1.4</span> Cast</h4>
<p>The <code>cast()</code> method can be used to convert the data types of a column to a new one.<br>
See <a href="https://pola-rs.github.io/r-polars/man/polars_dtype.html">here</a> for the data types available with Polars.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-35-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-35-1" role="tab" aria-controls="tabset-35-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-35-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-35-2" role="tab" aria-controls="tabset-35-2" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-35-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-35-3" role="tab" aria-controls="tabset-35-3" aria-selected="false">dplyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-35-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-35-4" role="tab" aria-controls="tabset-35-4" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-35-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-35-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb452"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb452-1"><a href="#cb452-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris)<span class="sc">$</span><span class="fu">with_columns</span>(</span>
<span id="cb452-2"><a href="#cb452-2" aria-hidden="true" tabindex="-1"></a>  pl<span class="sc">$</span><span class="fu">col</span>(<span class="st">"Petal.Length"</span>)<span class="sc">$</span><span class="fu">cast</span>(pl<span class="sc">$</span>Int8), <span class="co"># The "Petal.Length" column is converted into integers</span></span>
<span id="cb452-3"><a href="#cb452-3" aria-hidden="true" tabindex="-1"></a>  pl<span class="sc">$</span><span class="fu">col</span>(<span class="st">"Species"</span>)<span class="sc">$</span><span class="fu">cast</span>(pl<span class="sc">$</span>String) <span class="co"># The "Species" column is converted into strings</span></span>
<span id="cb452-4"><a href="#cb452-4" aria-hidden="true" tabindex="-1"></a>)<span class="sc">$</span>schema</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Sepal.Length
Float64

$Sepal.Width
Float64

$Petal.Length
Int8

$Petal.Width
Float64

$Species
String</code></pre>
</div>
</div>
</div>
<div id="tabset-35-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-35-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb454"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb454-1"><a href="#cb454-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb454-2"><a href="#cb454-2" aria-hidden="true" tabindex="-1"></a>iris<span class="sc">$</span>Petal.Length <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(iris<span class="sc">$</span>Petal.Length)</span>
<span id="cb454-3"><a href="#cb454-3" aria-hidden="true" tabindex="-1"></a>iris<span class="sc">$</span>Species <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(iris<span class="sc">$</span>Species)</span>
<span id="cb454-4"><a href="#cb454-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   150 obs. of  5 variables:
 $ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...
 $ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...
 $ Petal.Length: int  1 1 1 1 1 1 1 1 1 1 ...
 $ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...
 $ Species     : int  1 1 1 1 1 1 1 1 1 1 ...</code></pre>
</div>
</div>
</div>
<div id="tabset-35-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-35-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb456"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb456-1"><a href="#cb456-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb456-2"><a href="#cb456-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span></span>
<span id="cb456-3"><a href="#cb456-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb456-4"><a href="#cb456-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Petal.Length =</span> <span class="fu">as.integer</span>(Petal.Length),</span>
<span id="cb456-5"><a href="#cb456-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Species =</span> <span class="fu">as.character</span>(Species)) <span class="sc">|&gt;</span></span>
<span id="cb456-6"><a href="#cb456-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   150 obs. of  5 variables:
 $ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...
 $ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...
 $ Petal.Length: int  1 1 1 1 1 1 1 1 1 1 ...
 $ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...
 $ Species     : chr  "setosa" "setosa" "setosa" "setosa" ...</code></pre>
</div>
</div>
</div>
<div id="tabset-35-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-35-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb458"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb458-1"><a href="#cb458-1" aria-hidden="true" tabindex="-1"></a>iris_dt[, <span class="st">`</span><span class="at">:=</span><span class="st">`</span>(<span class="at">Petal.Length =</span> <span class="fu">as.integer</span>(Petal.Length),</span>
<span id="cb458-2"><a href="#cb458-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">Species =</span> <span class="fu">as.character</span>(Species))]</span>
<span id="cb458-3"><a href="#cb458-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(iris_dt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Classes 'data.table' and 'data.frame':  150 obs. of  5 variables:
 $ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...
 $ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...
 $ Petal.Length: int  1 1 1 1 1 1 1 1 1 1 ...
 $ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...
 $ Species     : chr  "setosa" "setosa" "setosa" "setosa" ...
 - attr(*, ".internal.selfref")=&lt;externalptr&gt; </code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>When working with very large tables we can <strong>Reduce the memory footprint</strong> by modifying the number of bits allocated to an element. ⚠️</p>
</div>
</div>
<p>When performing downcasting, it is crucial to ensure that the chosen number of bits is sufficient to accommodate the largest and smallest numbers in the column.</p>
<p>A quick reminder:</p>
<table class="table">
<thead>
<tr class="header">
<th>Type</th>
<th>Range</th>
<th>Accuracy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Int8</td>
<td>-128 to +127</td>
<td></td>
</tr>
<tr class="even">
<td>Int16</td>
<td>-32768 to +32767</td>
<td></td>
</tr>
<tr class="odd">
<td>Int32</td>
<td>-2147483648 to +2147483647</td>
<td></td>
</tr>
<tr class="even">
<td>Int64</td>
<td>–2E63 to –2E63-1</td>
<td></td>
</tr>
<tr class="odd">
<td>Float32</td>
<td>-3.4E+38 to +3.4E+38</td>
<td>about 7 decimal digits</td>
</tr>
<tr class="even">
<td>Float64</td>
<td>-1.7E+308 to +1.7E+308</td>
<td>about 16 decimal digits</td>
</tr>
</tbody>
</table>
</section>
<section id="check-if-series-is-numeric" class="level4" data-number="2.15.1.5">
<h4 data-number="2.15.1.5" class="anchored" data-anchor-id="check-if-series-is-numeric"><span class="header-section-number">2.15.1.5</span> Check if Series is numeric</h4>
<p>The <code>infer_polars_dtype()</code> method can be used to find the DataType corresponding to an R object.<br>
</p>
<p>::: {.panel-tabset} ## polars</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb460"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb460-1"><a href="#cb460-1" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">as_polars_series</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb460-2"><a href="#cb460-2" aria-hidden="true" tabindex="-1"></a><span class="fu">infer_polars_dtype</span>(s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Int32</code></pre>
</div>
</div>
</section>
<section id="get-length-of-a-series" class="level4" data-number="2.15.1.6">
<h4 data-number="2.15.1.6" class="anchored" data-anchor-id="get-length-of-a-series"><span class="header-section-number">2.15.1.6</span> Get length of a Series</h4>
<p>The <code>len()</code> method can be used to get the length of a <code>Series</code>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-36-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-36-1" role="tab" aria-controls="tabset-36-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-36-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-36-2" role="tab" aria-controls="tabset-36-2" aria-selected="false">R base</a></li></ul>
<div class="tab-content">
<div id="tabset-36-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-36-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb462"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb462-1"><a href="#cb462-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_series</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)<span class="sc">$</span><span class="fu">len</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
</div>
<div id="tabset-36-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-36-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb464"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb464-1"><a href="#cb464-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="check-if-series-are-equal" class="level4" data-number="2.15.1.7">
<h4 data-number="2.15.1.7" class="anchored" data-anchor-id="check-if-series-are-equal"><span class="header-section-number">2.15.1.7</span> Check if Series are equal</h4>
<p>The <code>series_equal()</code> method can be used to check if a <code>Series</code> is equal with another <code>Series</code>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Caution, if two series are identical but one is named and the other is not then <code>series_equal()</code> returns FALSE.</p>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-37-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-37-1" role="tab" aria-controls="tabset-37-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-37-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-37-2" role="tab" aria-controls="tabset-37-2" aria-selected="false">R base</a></li></ul>
<div class="tab-content">
<div id="tabset-37-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-37-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb466"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb466-1"><a href="#cb466-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_series</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)<span class="sc">$</span><span class="fu">equals</span>(<span class="fu">as_polars_series</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb468"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb468-1"><a href="#cb468-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_series</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="at">name =</span> <span class="st">"toto"</span>)<span class="sc">$</span><span class="fu">equals</span>(<span class="fu">as_polars_series</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</div>
<div id="tabset-37-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-37-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb470"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb470-1"><a href="#cb470-1" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="convert-series-to-polars-dataframe" class="level4" data-number="2.15.1.8">
<h4 data-number="2.15.1.8" class="anchored" data-anchor-id="convert-series-to-polars-dataframe"><span class="header-section-number">2.15.1.8</span> Convert Series to Polars DataFrame</h4>
<p>The <code>to_frame()</code> method can be used to convert a <code>Series</code> to a <code>DataFrame</code>.<br>
In this case, a <code>DataFrame</code> with only one column will be created. If the <code>Series</code> is initially named then the column of the <code>DataFrame</code> will be named as such.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb472"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb472-1"><a href="#cb472-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_series</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="st">"toto"</span>)<span class="sc">$</span><span class="fu">to_frame</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 1)
┌──────┐
│ toto │
│ ---  │
│ i32  │
╞══════╡
│ 1    │
│ 2    │
│ 3    │
└──────┘</code></pre>
</div>
</div>
</section>
<section id="get-value-counts-of-a-series" class="level4" data-number="2.15.1.9">
<h4 data-number="2.15.1.9" class="anchored" data-anchor-id="get-value-counts-of-a-series"><span class="header-section-number">2.15.1.9</span> Get value Counts of a Series</h4>
<p>The <code>value_counts()</code> method can be used to get a value counts of a <code>Series</code>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-38-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-38-1" role="tab" aria-controls="tabset-38-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-38-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-38-2" role="tab" aria-controls="tabset-38-2" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-38-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-38-3" role="tab" aria-controls="tabset-38-3" aria-selected="false">dplyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-38-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-38-4" role="tab" aria-controls="tabset-38-4" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-38-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-38-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb474"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb474-1"><a href="#cb474-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_series</span>(iris<span class="sc">$</span>Species)<span class="sc">$</span><span class="fu">value_counts</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 1)
┌───────────────────┐
│                   │
│ ---               │
│ struct[2]         │
╞═══════════════════╡
│ {"versicolor",50} │
│ {"setosa",50}     │
│ {"virginica",50}  │
└───────────────────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-38-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-38-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb476"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb476-1"><a href="#cb476-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(iris<span class="sc">$</span>Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    setosa versicolor  virginica 
        50         50         50 </code></pre>
</div>
</div>
</div>
<div id="tabset-38-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-38-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb478"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb478-1"><a href="#cb478-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span></span>
<span id="cb478-2"><a href="#cb478-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Species  n
1     setosa 50
2 versicolor 50
3  virginica 50</code></pre>
</div>
</div>
</div>
<div id="tabset-38-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-38-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb480"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb480-1"><a href="#cb480-1" aria-hidden="true" tabindex="-1"></a>iris_dt[, .N, by <span class="ot">=</span> Species]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Species     N
       &lt;char&gt; &lt;int&gt;
1:     setosa    50
2: versicolor    50
3:  virginica    50</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="sum-across-series" class="level4" data-number="2.15.1.10">
<h4 data-number="2.15.1.10" class="anchored" data-anchor-id="sum-across-series"><span class="header-section-number">2.15.1.10</span> Sum across <code>Series</code></h4>
<p>The <code>sum()</code> method can be used to get a sum of a <code>Series</code>.</p>
<ul>
<li>From a single <code>Series</code>:</li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-39-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-39-1" role="tab" aria-controls="tabset-39-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-39-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-39-2" role="tab" aria-controls="tabset-39-2" aria-selected="false">R base</a></li></ul>
<div class="tab-content">
<div id="tabset-39-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-39-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb482"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb482-1"><a href="#cb482-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_series</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)<span class="sc">$</span><span class="fu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (1, 1)
┌─────┐
│     │
│ --- │
│ i32 │
╞═════╡
│ 6   │
└─────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-39-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-39-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb484"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb484-1"><a href="#cb484-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>From a <code>DataFrame</code> and a column as <strong>a string</strong>:</li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-40-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-40-1" role="tab" aria-controls="tabset-40-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-40-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-40-2" role="tab" aria-controls="tabset-40-2" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-40-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-40-3" role="tab" aria-controls="tabset-40-3" aria-selected="false">dplyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-40-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-40-4" role="tab" aria-controls="tabset-40-4" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-40-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-40-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb486"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb486-1"><a href="#cb486-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris)<span class="sc">$</span><span class="fu">select</span>(pl<span class="sc">$</span><span class="fu">sum</span>(<span class="st">"Petal.Length"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (1, 1)
┌──────────────┐
│ Petal.Length │
│ ---          │
│ f64          │
╞══════════════╡
│ 563.7        │
└──────────────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-40-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-40-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb488"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb488-1"><a href="#cb488-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(iris<span class="sc">$</span>Petal.Length)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 563.7</code></pre>
</div>
</div>
</div>
<div id="tabset-40-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-40-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb490"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb490-1"><a href="#cb490-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> <span class="fu">summarise</span>(<span class="fu">sum</span>(Petal.Length))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  sum(Petal.Length)
1             563.7</code></pre>
</div>
</div>
</div>
<div id="tabset-40-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-40-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb492"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb492-1"><a href="#cb492-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(iris_dt[, Petal.Length])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 496</code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>From a <code>DataFrame</code> and a column as <strong>an expression</strong>:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb494"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb494-1"><a href="#cb494-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris)<span class="sc">$</span><span class="fu">select</span>(pl<span class="sc">$</span><span class="fu">sum</span>(<span class="st">"Petal.Width"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (1, 1)
┌─────────────┐
│ Petal.Width │
│ ---         │
│ f64         │
╞═════════════╡
│ 179.9       │
└─────────────┘</code></pre>
</div>
</div>
<ul>
<li>From a <code>DataFrame</code> and a column as a list and <strong>sum horizontally</strong>:</li>
</ul>
<p>In this case, use <code>with_columns()</code> method.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-41-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-41-1" role="tab" aria-controls="tabset-41-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-41-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-41-2" role="tab" aria-controls="tabset-41-2" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-41-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-41-3" role="tab" aria-controls="tabset-41-3" aria-selected="false">dplyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-41-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-41-4" role="tab" aria-controls="tabset-41-4" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-41-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-41-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb496"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb496-1"><a href="#cb496-1" aria-hidden="true" tabindex="-1"></a>df_pl <span class="ot">&lt;-</span> pl<span class="sc">$</span><span class="fu">DataFrame</span>(<span class="at">col1 =</span> <span class="fu">c</span>(10L,20L), <span class="at">col2=</span> <span class="fu">c</span>(30L,40L), <span class="at">col3 =</span> <span class="fu">c</span>(40L,50L))</span>
<span id="cb496-2"><a href="#cb496-2" aria-hidden="true" tabindex="-1"></a>df_pl<span class="sc">$</span><span class="fu">with_columns</span>(pl<span class="sc">$</span><span class="fu">sum</span>(<span class="st">"col1"</span>, <span class="st">"col3"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (2, 3)
┌──────┬──────┬──────┐
│ col1 ┆ col2 ┆ col3 │
│ ---  ┆ ---  ┆ ---  │
│ i32  ┆ i32  ┆ i32  │
╞══════╪══════╪══════╡
│ 30   ┆ 30   ┆ 90   │
│ 30   ┆ 40   ┆ 90   │
└──────┴──────┴──────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-41-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-41-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb498"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb498-1"><a href="#cb498-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">col1 =</span> <span class="fu">c</span>(10L,20L), <span class="at">col2=</span> <span class="fu">c</span>(30L,40L), <span class="at">col3 =</span> <span class="fu">c</span>(40L,50L))</span>
<span id="cb498-2"><a href="#cb498-2" aria-hidden="true" tabindex="-1"></a>mysum <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(df[, <span class="fu">c</span>(<span class="st">"col1"</span>, <span class="st">"col3"</span>)])</span>
<span id="cb498-3"><a href="#cb498-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(df,mysum)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  col1 col2 col3 mysum
1   10   30   40    50
2   20   40   50    70</code></pre>
</div>
</div>
</div>
<div id="tabset-41-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-41-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb500"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb500-1"><a href="#cb500-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb500-2"><a href="#cb500-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">|&gt;</span></span>
<span id="cb500-3"><a href="#cb500-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mysum =</span> <span class="fu">sum</span>(col1,col3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
# Rowwise: 
   col1  col2  col3 mysum
  &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
1    10    30    40    50
2    20    40    50    70</code></pre>
</div>
</div>
</div>
<div id="tabset-41-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-41-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb502"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb502-1"><a href="#cb502-1" aria-hidden="true" tabindex="-1"></a>df_dt <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(df)</span>
<span id="cb502-2"><a href="#cb502-2" aria-hidden="true" tabindex="-1"></a>df_dt[, somme <span class="sc">:</span><span class="er">=</span> <span class="fu">rowSums</span>(.SD), .SDcols <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"col1"</span>, <span class="st">"col3"</span>)]</span>
<span id="cb502-3"><a href="#cb502-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(df_dt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    col1  col2  col3 somme
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;num&gt;
1:    10    30    40    50
2:    20    40    50    70</code></pre>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>From a <code>DataFrame</code> and <strong>sum horizontally</strong> some columns:</li>
</ul>
<p>An example with iris <code>Dataframe</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb504"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb504-1"><a href="#cb504-1" aria-hidden="true" tabindex="-1"></a>df_pl<span class="sc">$</span><span class="fu">with_columns</span>(</span>
<span id="cb504-2"><a href="#cb504-2" aria-hidden="true" tabindex="-1"></a>  pl<span class="sc">$</span><span class="fu">sum_horizontal</span>(<span class="st">"col1"</span>, <span class="st">"col2"</span>, <span class="st">"col3"</span>)<span class="sc">$</span><span class="fu">alias</span>(<span class="st">"sum"</span>)</span>
<span id="cb504-3"><a href="#cb504-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (2, 4)
┌──────┬──────┬──────┬─────┐
│ col1 ┆ col2 ┆ col3 ┆ sum │
│ ---  ┆ ---  ┆ ---  ┆ --- │
│ i32  ┆ i32  ┆ i32  ┆ i32 │
╞══════╪══════╪══════╪═════╡
│ 10   ┆ 30   ┆ 40   ┆ 80  │
│ 20   ┆ 40   ┆ 50   ┆ 110 │
└──────┴──────┴──────┴─────┘</code></pre>
</div>
</div>
</section>
</section>
<section id="on-dataframes" class="level3" data-number="2.15.2">
<h3 data-number="2.15.2" class="anchored" data-anchor-id="on-dataframes"><span class="header-section-number">2.15.2</span> On DataFrames</h3>
<section id="get-series-from-dataframe" class="level4" data-number="2.15.2.1">
<h4 data-number="2.15.2.1" class="anchored" data-anchor-id="get-series-from-dataframe"><span class="header-section-number">2.15.2.1</span> Get Series from DataFrame</h4>
<p>The <code>to_series()</code> method can be used to get one column from <code>DataFrame</code> as <code>Series</code>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-42-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-42-1" role="tab" aria-controls="tabset-42-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-42-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-42-2" role="tab" aria-controls="tabset-42-2" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-42-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-42-3" role="tab" aria-controls="tabset-42-3" aria-selected="false">dplyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-42-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-42-4" role="tab" aria-controls="tabset-42-4" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-42-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-42-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb506"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb506-1"><a href="#cb506-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris)<span class="sc">$</span><span class="fu">select</span>(pl<span class="sc">$</span><span class="fu">col</span>(<span class="st">"Petal.Length"</span>))<span class="sc">$</span><span class="fu">to_series</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (150, 1)
┌──────────────┐
│ Petal.Length │
│ ---          │
│ f64          │
╞══════════════╡
│ 1.4          │
│ 1.4          │
│ 1.3          │
│ 1.5          │
│ 1.4          │
│ …            │
│ 5.2          │
│ 5.0          │
│ 5.2          │
│ 5.4          │
│ 5.1          │
└──────────────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-42-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-42-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb508"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb508-1"><a href="#cb508-1" aria-hidden="true" tabindex="-1"></a>iris<span class="sc">$</span>Petal.Length</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 1.5 1.6 1.4 1.1 1.2 1.5 1.3 1.4
 [19] 1.7 1.5 1.7 1.5 1.0 1.7 1.9 1.6 1.6 1.5 1.4 1.6 1.6 1.5 1.5 1.4 1.5 1.2
 [37] 1.3 1.4 1.3 1.5 1.3 1.3 1.3 1.6 1.9 1.4 1.6 1.4 1.5 1.4 4.7 4.5 4.9 4.0
 [55] 4.6 4.5 4.7 3.3 4.6 3.9 3.5 4.2 4.0 4.7 3.6 4.4 4.5 4.1 4.5 3.9 4.8 4.0
 [73] 4.9 4.7 4.3 4.4 4.8 5.0 4.5 3.5 3.8 3.7 3.9 5.1 4.5 4.5 4.7 4.4 4.1 4.0
 [91] 4.4 4.6 4.0 3.3 4.2 4.2 4.2 4.3 3.0 4.1 6.0 5.1 5.9 5.6 5.8 6.6 4.5 6.3
[109] 5.8 6.1 5.1 5.3 5.5 5.0 5.1 5.3 5.5 6.7 6.9 5.0 5.7 4.9 6.7 4.9 5.7 6.0
[127] 4.8 4.9 5.6 5.8 6.1 6.4 5.6 5.1 5.6 6.1 5.6 5.5 4.8 5.4 5.6 5.1 5.1 5.9
[145] 5.7 5.2 5.0 5.2 5.4 5.1</code></pre>
</div>
</div>
</div>
<div id="tabset-42-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-42-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb510"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb510-1"><a href="#cb510-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span></span>
<span id="cb510-2"><a href="#cb510-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(Petal.Length)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 1.5 1.6 1.4 1.1 1.2 1.5 1.3 1.4
 [19] 1.7 1.5 1.7 1.5 1.0 1.7 1.9 1.6 1.6 1.5 1.4 1.6 1.6 1.5 1.5 1.4 1.5 1.2
 [37] 1.3 1.4 1.3 1.5 1.3 1.3 1.3 1.6 1.9 1.4 1.6 1.4 1.5 1.4 4.7 4.5 4.9 4.0
 [55] 4.6 4.5 4.7 3.3 4.6 3.9 3.5 4.2 4.0 4.7 3.6 4.4 4.5 4.1 4.5 3.9 4.8 4.0
 [73] 4.9 4.7 4.3 4.4 4.8 5.0 4.5 3.5 3.8 3.7 3.9 5.1 4.5 4.5 4.7 4.4 4.1 4.0
 [91] 4.4 4.6 4.0 3.3 4.2 4.2 4.2 4.3 3.0 4.1 6.0 5.1 5.9 5.6 5.8 6.6 4.5 6.3
[109] 5.8 6.1 5.1 5.3 5.5 5.0 5.1 5.3 5.5 6.7 6.9 5.0 5.7 4.9 6.7 4.9 5.7 6.0
[127] 4.8 4.9 5.6 5.8 6.1 6.4 5.6 5.1 5.6 6.1 5.6 5.5 4.8 5.4 5.6 5.1 5.1 5.9
[145] 5.7 5.2 5.0 5.2 5.4 5.1</code></pre>
</div>
</div>
</div>
<div id="tabset-42-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-42-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb512"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb512-1"><a href="#cb512-1" aria-hidden="true" tabindex="-1"></a>iris_dt[, <span class="fu">c</span>(Petal.Length)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 4 4 4 4 4 4 4 3 4 3 3 4 4 4 3 4 4 4 4 3 4 4 4 4
 [75] 4 4 4 5 4 3 3 3 3 5 4 4 4 4 4 4 4 4 4 3 4 4 4 4 3 4 6 5 5 5 5 6 4 6 5 6 5
[112] 5 5 5 5 5 5 6 6 5 5 4 6 4 5 6 4 4 5 5 6 6 5 5 5 6 5 5 4 5 5 5 5 5 5 5 5 5
[149] 5 5</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="get-a-r-list-from-dataframe" class="level4" data-number="2.15.2.2">
<h4 data-number="2.15.2.2" class="anchored" data-anchor-id="get-a-r-list-from-dataframe"><span class="header-section-number">2.15.2.2</span> Get a R List from DataFrame</h4>
<p>The <code>as.list()</code> function can be used to get a R List from a Polars object.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-43-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-43-1" role="tab" aria-controls="tabset-43-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-43-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-43-2" role="tab" aria-controls="tabset-43-2" aria-selected="false">R base</a></li></ul>
<div class="tab-content">
<div id="tabset-43-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-43-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb514"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb514-1"><a href="#cb514-1" aria-hidden="true" tabindex="-1"></a>mylist <span class="ot">&lt;-</span> <span class="fu">as.list</span>(<span class="fu">as_polars_df</span>(iris))</span>
<span id="cb514-2"><a href="#cb514-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mylist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Sepal.Length" "Sepal.Width"  "Petal.Length" "Petal.Width"  "Species"     </code></pre>
</div>
</div>
</div>
<div id="tabset-43-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-43-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb516"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb516-1"><a href="#cb516-1" aria-hidden="true" tabindex="-1"></a>mylist <span class="ot">&lt;-</span> <span class="fu">as.list</span>(iris)</span>
<span id="cb516-2"><a href="#cb516-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mylist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Sepal.Length" "Sepal.Width"  "Petal.Length" "Petal.Width"  "Species"     </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="get-a-slice-of-a-dataframe" class="level4" data-number="2.15.2.3">
<h4 data-number="2.15.2.3" class="anchored" data-anchor-id="get-a-slice-of-a-dataframe"><span class="header-section-number">2.15.2.3</span> Get a slice of a DataFrame</h4>
<p>The <code>slice()</code> method can be used to get a slice of a <code>DataFrame</code>.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>With Polars, numeric default is 0! Thus the equivalent to <code>slice(1,3)</code> with Polars will be <code>1:4</code> in R Base and data.table and <code>slice(1,4)</code> with dplyr.</p>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-44-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-44-1" role="tab" aria-controls="tabset-44-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-44-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-44-2" role="tab" aria-controls="tabset-44-2" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-44-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-44-3" role="tab" aria-controls="tabset-44-3" aria-selected="false">dplyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-44-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-44-4" role="tab" aria-controls="tabset-44-4" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-44-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-44-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb518"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb518-1"><a href="#cb518-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(iris)<span class="sc">$</span><span class="fu">slice</span>(<span class="dv">1</span>,<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 5)
┌──────────────┬─────────────┬──────────────┬─────────────┬─────────┐
│ Sepal.Length ┆ Sepal.Width ┆ Petal.Length ┆ Petal.Width ┆ Species │
│ ---          ┆ ---         ┆ ---          ┆ ---         ┆ ---     │
│ f64          ┆ f64         ┆ f64          ┆ f64         ┆ cat     │
╞══════════════╪═════════════╪══════════════╪═════════════╪═════════╡
│ 4.9          ┆ 3.0         ┆ 1.4          ┆ 0.2         ┆ setosa  │
│ 4.7          ┆ 3.2         ┆ 1.3          ┆ 0.2         ┆ setosa  │
│ 4.6          ┆ 3.1         ┆ 1.5          ┆ 0.2         ┆ setosa  │
└──────────────┴─────────────┴──────────────┴─────────────┴─────────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-44-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-44-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb520"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb520-1"><a href="#cb520-1" aria-hidden="true" tabindex="-1"></a>iris[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
2          4.9         3.0          1.4         0.2  setosa
3          4.7         3.2          1.3         0.2  setosa
4          4.6         3.1          1.5         0.2  setosa</code></pre>
</div>
</div>
</div>
<div id="tabset-44-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-44-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb522"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb522-1"><a href="#cb522-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span></span>
<span id="cb522-2"><a href="#cb522-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1          4.9         3.0          1.4         0.2  setosa
2          4.7         3.2          1.3         0.2  setosa
3          4.6         3.1          1.5         0.2  setosa</code></pre>
</div>
</div>
</div>
<div id="tabset-44-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-44-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb524"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb524-1"><a href="#cb524-1" aria-hidden="true" tabindex="-1"></a>iris_dt[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
          &lt;num&gt;       &lt;num&gt;        &lt;int&gt;       &lt;num&gt;  &lt;char&gt;
1:          4.9         3.0            1         0.2  setosa
2:          4.7         3.2            1         0.2  setosa
3:          4.6         3.1            1         0.2  setosa</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="get-a-structure-from-a-dataframe" class="level4" data-number="2.15.2.4">
<h4 data-number="2.15.2.4" class="anchored" data-anchor-id="get-a-structure-from-a-dataframe"><span class="header-section-number">2.15.2.4</span> Get a structure from a DataFrame</h4>
<p>The <code>to_struct()</code> method can be used to get a structure from a <code>DataFrame</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb526"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb526-1"><a href="#cb526-1" aria-hidden="true" tabindex="-1"></a>mystruc <span class="ot">&lt;-</span> <span class="fu">as_polars_df</span>(iris)<span class="sc">$</span><span class="fu">to_struct</span>()</span>
<span id="cb526-2"><a href="#cb526-2" aria-hidden="true" tabindex="-1"></a>mystruc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (150, 1)
┌───────────────────────────────┐
│                               │
│ ---                           │
│ struct[5]                     │
╞═══════════════════════════════╡
│ {5.1,3.5,1.4,0.2,"setosa"}    │
│ {4.9,3.0,1.4,0.2,"setosa"}    │
│ {4.7,3.2,1.3,0.2,"setosa"}    │
│ {4.6,3.1,1.5,0.2,"setosa"}    │
│ {5.0,3.6,1.4,0.2,"setosa"}    │
│ …                             │
│ {6.7,3.0,5.2,2.3,"virginica"} │
│ {6.3,2.5,5.0,1.9,"virginica"} │
│ {6.5,3.0,5.2,2.0,"virginica"} │
│ {6.2,3.4,5.4,2.3,"virginica"} │
│ {5.9,3.0,5.1,1.8,"virginica"} │
└───────────────────────────────┘</code></pre>
</div>
</div>
<p><code>to_struct()</code> returns a <code>Series</code> which can be converted to a R list with <code>as.vector()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb528"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb528-1"><a href="#cb528-1" aria-hidden="true" tabindex="-1"></a>mylist <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(mystruc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>ℹ `as.vector()` on a Polars Series of type struct[5] may drop some useful
  attributes.
ℹ Use `$to_r_vector()` instead for finer control of the conversion from Polars
  to R.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb530"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb530-1"><a href="#cb530-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mylist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 5
 $ Sepal.Length: num [1:150] 5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...
 $ Sepal.Width : num [1:150] 3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...
 $ Petal.Length: num [1:150] 1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...
 $ Petal.Width : num [1:150] 0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...
 $ Species     : Factor w/ 3 levels "setosa","versicolor",..: 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
</div>
</div>
<p>mylist is now a list where each element is a column of the initial DataFrame.</p>
<p>With <code>to_frame()</code> and <code>unnest()</code> methods, we can reconstruct the original DataFrame:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb532"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb532-1"><a href="#cb532-1" aria-hidden="true" tabindex="-1"></a>back_df <span class="ot">&lt;-</span> mystruc<span class="sc">$</span><span class="fu">to_frame</span>()<span class="sc">$</span><span class="fu">unnest</span>()</span>
<span id="cb532-2"><a href="#cb532-2" aria-hidden="true" tabindex="-1"></a>back_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (150, 1)
┌───────────────────────────────┐
│                               │
│ ---                           │
│ struct[5]                     │
╞═══════════════════════════════╡
│ {5.1,3.5,1.4,0.2,"setosa"}    │
│ {4.9,3.0,1.4,0.2,"setosa"}    │
│ {4.7,3.2,1.3,0.2,"setosa"}    │
│ {4.6,3.1,1.5,0.2,"setosa"}    │
│ {5.0,3.6,1.4,0.2,"setosa"}    │
│ …                             │
│ {6.7,3.0,5.2,2.3,"virginica"} │
│ {6.3,2.5,5.0,1.9,"virginica"} │
│ {6.5,3.0,5.2,2.0,"virginica"} │
│ {6.2,3.4,5.4,2.3,"virginica"} │
│ {5.9,3.0,5.1,1.8,"virginica"} │
└───────────────────────────────┘</code></pre>
</div>
</div>
</section>
<section id="drop-all-rows-that-contain-null-values" class="level4" data-number="2.15.2.5">
<h4 data-number="2.15.2.5" class="anchored" data-anchor-id="drop-all-rows-that-contain-null-values"><span class="header-section-number">2.15.2.5</span> Drop all rows that contain null values</h4>
<p>The <code>drop_nulls()</code> method can be used to drop all rows that contain null values in a <code>DataFrame</code>.</p>
<p>By default, <code>drop_nulls()</code> use all columns to drop rows:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-45-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-45-1" role="tab" aria-controls="tabset-45-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-45-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-45-2" role="tab" aria-controls="tabset-45-2" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-45-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-45-3" role="tab" aria-controls="tabset-45-3" aria-selected="false">dplyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-45-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-45-4" role="tab" aria-controls="tabset-45-4" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-45-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-45-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb534"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb534-1"><a href="#cb534-1" aria-hidden="true" tabindex="-1"></a>data_pl <span class="ot">&lt;-</span> pl<span class="sc">$</span><span class="fu">DataFrame</span>(</span>
<span id="cb534-2"><a href="#cb534-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">col1 =</span> <span class="fu">c</span>(<span class="cn">NA</span>,<span class="st">"b"</span>,<span class="st">"c"</span>),</span>
<span id="cb534-3"><a href="#cb534-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">col2 =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="cn">NA</span>)</span>
<span id="cb534-4"><a href="#cb534-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb534-5"><a href="#cb534-5" aria-hidden="true" tabindex="-1"></a>data_pl<span class="sc">$</span><span class="fu">drop_nulls</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (1, 2)
┌──────┬──────┐
│ col1 ┆ col2 │
│ ---  ┆ ---  │
│ str  ┆ f64  │
╞══════╪══════╡
│ b    ┆ 2.0  │
└──────┴──────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-45-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-45-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb536"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb536-1"><a href="#cb536-1" aria-hidden="true" tabindex="-1"></a>data_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb536-2"><a href="#cb536-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">col1 =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="st">"b"</span>, <span class="st">"c"</span>),</span>
<span id="cb536-3"><a href="#cb536-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">col2 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="cn">NA</span>)</span>
<span id="cb536-4"><a href="#cb536-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb536-5"><a href="#cb536-5" aria-hidden="true" tabindex="-1"></a>data_df[<span class="fu">complete.cases</span>(data_df), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  col1 col2
2    b    2</code></pre>
</div>
</div>
</div>
<div id="tabset-45-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-45-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb538"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb538-1"><a href="#cb538-1" aria-hidden="true" tabindex="-1"></a>data_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb538-2"><a href="#cb538-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">col1 =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="st">"b"</span>, <span class="st">"c"</span>),</span>
<span id="cb538-3"><a href="#cb538-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">col2 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="cn">NA</span>)</span>
<span id="cb538-4"><a href="#cb538-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb538-5"><a href="#cb538-5" aria-hidden="true" tabindex="-1"></a>data_df <span class="sc">%&gt;%</span></span>
<span id="cb538-6"><a href="#cb538-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">complete.cases</span>(.))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  col1 col2
1    b    2</code></pre>
</div>
</div>
</div>
<div id="tabset-45-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-45-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb540"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb540-1"><a href="#cb540-1" aria-hidden="true" tabindex="-1"></a>data_dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb540-2"><a href="#cb540-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">col1 =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="st">"b"</span>, <span class="st">"c"</span>),</span>
<span id="cb540-3"><a href="#cb540-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">col2 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="cn">NA</span>)</span>
<span id="cb540-4"><a href="#cb540-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb540-5"><a href="#cb540-5" aria-hidden="true" tabindex="-1"></a><span class="fu">na.omit</span>(data_dt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     col1  col2
   &lt;char&gt; &lt;num&gt;
1:      b     2</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>If you want, you can specify a column (or multiple columns):</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-46-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-46-1" role="tab" aria-controls="tabset-46-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-46-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-46-2" role="tab" aria-controls="tabset-46-2" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-46-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-46-3" role="tab" aria-controls="tabset-46-3" aria-selected="false">dplyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-46-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-46-4" role="tab" aria-controls="tabset-46-4" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-46-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-46-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb542"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb542-1"><a href="#cb542-1" aria-hidden="true" tabindex="-1"></a>data_pl<span class="sc">$</span><span class="fu">drop_nulls</span>(<span class="st">"col1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (2, 2)
┌──────┬──────┐
│ col1 ┆ col2 │
│ ---  ┆ ---  │
│ str  ┆ f64  │
╞══════╪══════╡
│ b    ┆ 2.0  │
│ c    ┆ null │
└──────┴──────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-46-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-46-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb544"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb544-1"><a href="#cb544-1" aria-hidden="true" tabindex="-1"></a>data_df[<span class="sc">!</span><span class="fu">is.na</span>(data_df<span class="sc">$</span>col1), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  col1 col2
2    b    2
3    c   NA</code></pre>
</div>
</div>
</div>
<div id="tabset-46-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-46-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb546"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb546-1"><a href="#cb546-1" aria-hidden="true" tabindex="-1"></a>data_df <span class="sc">|&gt;</span></span>
<span id="cb546-2"><a href="#cb546-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(col1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  col1 col2
1    b    2
2    c   NA</code></pre>
</div>
</div>
</div>
<div id="tabset-46-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-46-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb548"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb548-1"><a href="#cb548-1" aria-hidden="true" tabindex="-1"></a>data_dt[<span class="fu">complete.cases</span>(data_dt[, .SD, <span class="at">.SDcols =</span> <span class="st">"col1"</span>]), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     col1  col2
   &lt;char&gt; &lt;num&gt;
1:      b     2
2:      c    NA</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="strings-methods" class="level2" data-number="2.16">
<h2 data-number="2.16" class="anchored" data-anchor-id="strings-methods"><span class="header-section-number">2.16</span> Strings methods</h2>
<p>In polars, a lot of <strong>strings methods</strong> are useful. <a href="https://pola-rs.github.io/polars/py-polars/html/reference/series/string.html">Here</a> is the list.<br>
To use them, simply prefix them with <code>str</code>.</p>
<section id="get-substrings" class="level3" data-number="2.16.1">
<h3 data-number="2.16.1" class="anchored" data-anchor-id="get-substrings"><span class="header-section-number">2.16.1</span> Get substrings</h3>
<p>The <code>str$slice()</code> method can be used to create substrings of the string values of a <strong>Utf8 Series</strong>.</p>
<p><code>str$slice()</code> does not work like R base’s <code>substr()</code> function for finding the substring of interest: - <code>substr()</code> takes two arguments: the first and last elements; - <code>str$slice()</code> takes two arguments: the first element and the extraction length.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>With Polars, numeric default is 0! Thus the equivalent to <code>str$slice(0,3)</code> with Polars will be <code>substr(1,3)</code>.</p>
</div>
</div>
<p>Two further comments:</p>
<ul>
<li><p>If the second argument <code>length</code> is not specified, the sub-character string of interest will default to the end of the character string. For example in a <code>DataFrame</code> if <code>mycol</code> is a string column of length 4, <code>pl.col("mycol").str.slice(1)</code> is equivalent to <code>substr(mycol,2,4)</code> in dplyr.</p></li>
<li><p>The first argument accepts negative values, which means that sub-strings can be considered starting from the end. For example in a <code>DataFrame</code> if <code>mycol</code> is a string column of length 4, <code>pl.col("mycol").str.slice(-2)</code> is equivalent to <code>substr(mycol,3,4)</code> in dplyr.</p></li>
</ul>
<p>Let’s see an example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb550"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb550-1"><a href="#cb550-1" aria-hidden="true" tabindex="-1"></a>mydf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb550-2"><a href="#cb550-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">col1 =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb550-3"><a href="#cb550-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">col2 =</span> <span class="fu">c</span>(<span class="st">"One_X"</span>,<span class="st">"One_Y"</span>,<span class="st">"Two_X"</span>,<span class="st">"Two_Y"</span>)</span>
<span id="cb550-4"><a href="#cb550-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-47-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-47-1" role="tab" aria-controls="tabset-47-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-47-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-47-2" role="tab" aria-controls="tabset-47-2" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-47-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-47-3" role="tab" aria-controls="tabset-47-3" aria-selected="false">dplyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-47-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-47-4" role="tab" aria-controls="tabset-47-4" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-47-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-47-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb551"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb551-1"><a href="#cb551-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(mydf)<span class="sc">$</span><span class="fu">with_columns</span>(</span>
<span id="cb551-2"><a href="#cb551-2" aria-hidden="true" tabindex="-1"></a>  pl<span class="sc">$</span><span class="fu">col</span>(<span class="st">"col2"</span>)<span class="sc">$</span>str<span class="sc">$</span><span class="fu">slice</span>(<span class="dv">0</span>, <span class="dv">3</span>)<span class="sc">$</span><span class="fu">alias</span>(<span class="st">"level"</span>),   <span class="co"># les 3 premiers caractères</span></span>
<span id="cb551-3"><a href="#cb551-3" aria-hidden="true" tabindex="-1"></a>  pl<span class="sc">$</span><span class="fu">col</span>(<span class="st">"col2"</span>)<span class="sc">$</span>str<span class="sc">$</span><span class="fu">slice</span>(<span class="sc">-</span><span class="dv">1</span>)<span class="sc">$</span><span class="fu">alias</span>(<span class="st">"x_y"</span>)        <span class="co"># le dernier caractère</span></span>
<span id="cb551-4"><a href="#cb551-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (4, 4)
┌──────┬───────┬───────┬─────┐
│ col1 ┆ col2  ┆ level ┆ x_y │
│ ---  ┆ ---   ┆ ---   ┆ --- │
│ i32  ┆ str   ┆ str   ┆ str │
╞══════╪═══════╪═══════╪═════╡
│ 1    ┆ One_X ┆ One   ┆ X   │
│ 2    ┆ One_Y ┆ One   ┆ Y   │
│ 3    ┆ Two_X ┆ Two   ┆ X   │
│ 4    ┆ Two_Y ┆ Two   ┆ Y   │
└──────┴───────┴───────┴─────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-47-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-47-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb553"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb553-1"><a href="#cb553-1" aria-hidden="true" tabindex="-1"></a>mydf<span class="sc">$</span>level <span class="ot">&lt;-</span> <span class="fu">substr</span>(mydf<span class="sc">$</span>col2, <span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb553-2"><a href="#cb553-2" aria-hidden="true" tabindex="-1"></a>mydf<span class="sc">$</span>x_y <span class="ot">&lt;-</span> <span class="fu">substr</span>(mydf<span class="sc">$</span>col2, <span class="fu">nchar</span>(mydf<span class="sc">$</span>col2), <span class="fu">nchar</span>(mydf<span class="sc">$</span>col2))</span>
<span id="cb553-3"><a href="#cb553-3" aria-hidden="true" tabindex="-1"></a>mydf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  col1  col2 level x_y
1    1 One_X   One   X
2    2 One_Y   One   Y
3    3 Two_X   Two   X
4    4 Two_Y   Two   Y</code></pre>
</div>
</div>
</div>
<div id="tabset-47-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-47-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb555"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb555-1"><a href="#cb555-1" aria-hidden="true" tabindex="-1"></a>mydf <span class="sc">|&gt;</span></span>
<span id="cb555-2"><a href="#cb555-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">level =</span> <span class="fu">substr</span>(col2, <span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb555-3"><a href="#cb555-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">x_y =</span> <span class="fu">substr</span>(col2, <span class="fu">nchar</span>(col2), <span class="fu">nchar</span>(col2)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  col1  col2 level x_y
1    1 One_X   One   X
2    2 One_Y   One   Y
3    3 Two_X   Two   X
4    4 Two_Y   Two   Y</code></pre>
</div>
</div>
</div>
<div id="tabset-47-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-47-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb557"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb557-1"><a href="#cb557-1" aria-hidden="true" tabindex="-1"></a>mydt <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(mydf) </span>
<span id="cb557-2"><a href="#cb557-2" aria-hidden="true" tabindex="-1"></a>mydt[, <span class="fu">c</span>(<span class="st">"level"</span>, <span class="st">"x_y"</span>) <span class="sc">:</span><span class="er">=</span> .(<span class="fu">substr</span>(col2, <span class="dv">1</span>, <span class="dv">3</span>), <span class="fu">substr</span>(col2, <span class="fu">nchar</span>(col2), <span class="fu">nchar</span>(col2)))]</span>
<span id="cb557-3"><a href="#cb557-3" aria-hidden="true" tabindex="-1"></a>mydt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    col1   col2  level    x_y
   &lt;int&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt;
1:     1  One_X    One      X
2:     2  One_Y    One      Y
3:     3  Two_X    Two      X
4:     4  Two_Y    Two      Y</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="check-if-string-values-start-with-a-substring" class="level3" data-number="2.16.2">
<h3 data-number="2.16.2" class="anchored" data-anchor-id="check-if-string-values-start-with-a-substring"><span class="header-section-number">2.16.2</span> Check if string values start with a substring</h3>
<p>The <code>str$starts_with()</code> method can be used to check if string values start with a substring. It returns a <strong>Boolean</strong>.</p>
<p>Let’s see an example where we create new Boolean columns based on the start of a character string:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-48-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-48-1" role="tab" aria-controls="tabset-48-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-48-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-48-2" role="tab" aria-controls="tabset-48-2" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-48-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-48-3" role="tab" aria-controls="tabset-48-3" aria-selected="false">dplyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-48-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-48-4" role="tab" aria-controls="tabset-48-4" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-48-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-48-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb559"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb559-1"><a href="#cb559-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(mydf)<span class="sc">$</span><span class="fu">with_columns</span>(</span>
<span id="cb559-2"><a href="#cb559-2" aria-hidden="true" tabindex="-1"></a>  pl<span class="sc">$</span><span class="fu">col</span>(<span class="st">"col2"</span>)<span class="sc">$</span>str<span class="sc">$</span><span class="fu">starts_with</span>(<span class="st">"One"</span>)<span class="sc">$</span><span class="fu">alias</span>(<span class="st">"is_one"</span>),</span>
<span id="cb559-3"><a href="#cb559-3" aria-hidden="true" tabindex="-1"></a>  pl<span class="sc">$</span><span class="fu">col</span>(<span class="st">"col2"</span>)<span class="sc">$</span>str<span class="sc">$</span><span class="fu">starts_with</span>(<span class="st">"Two"</span>)<span class="sc">$</span><span class="fu">alias</span>(<span class="st">"is_two"</span>)</span>
<span id="cb559-4"><a href="#cb559-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (4, 6)
┌──────┬───────┬───────┬─────┬────────┬────────┐
│ col1 ┆ col2  ┆ level ┆ x_y ┆ is_one ┆ is_two │
│ ---  ┆ ---   ┆ ---   ┆ --- ┆ ---    ┆ ---    │
│ i32  ┆ str   ┆ str   ┆ str ┆ bool   ┆ bool   │
╞══════╪═══════╪═══════╪═════╪════════╪════════╡
│ 1    ┆ One_X ┆ One   ┆ X   ┆ true   ┆ false  │
│ 2    ┆ One_Y ┆ One   ┆ Y   ┆ true   ┆ false  │
│ 3    ┆ Two_X ┆ Two   ┆ X   ┆ false  ┆ true   │
│ 4    ┆ Two_Y ┆ Two   ┆ Y   ┆ false  ┆ true   │
└──────┴───────┴───────┴─────┴────────┴────────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-48-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-48-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb561"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb561-1"><a href="#cb561-1" aria-hidden="true" tabindex="-1"></a>mydf<span class="sc">$</span>is_one <span class="ot">&lt;-</span> <span class="fu">grepl</span>(<span class="st">"^One"</span>, mydf<span class="sc">$</span>col2)</span>
<span id="cb561-2"><a href="#cb561-2" aria-hidden="true" tabindex="-1"></a>mydf<span class="sc">$</span>is_two <span class="ot">&lt;-</span> <span class="fu">grepl</span>(<span class="st">"^Two"</span>, mydf<span class="sc">$</span>col2)</span>
<span id="cb561-3"><a href="#cb561-3" aria-hidden="true" tabindex="-1"></a>mydf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  col1  col2 level x_y is_one is_two
1    1 One_X   One   X   TRUE  FALSE
2    2 One_Y   One   Y   TRUE  FALSE
3    3 Two_X   Two   X  FALSE   TRUE
4    4 Two_Y   Two   Y  FALSE   TRUE</code></pre>
</div>
</div>
</div>
<div id="tabset-48-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-48-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb563"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb563-1"><a href="#cb563-1" aria-hidden="true" tabindex="-1"></a>mydf <span class="sc">|&gt;</span></span>
<span id="cb563-2"><a href="#cb563-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">level =</span> <span class="fu">substr</span>(col2, <span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb563-3"><a href="#cb563-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">x_y =</span> <span class="fu">substr</span>(col2, <span class="fu">nchar</span>(col2), <span class="fu">nchar</span>(col2)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  col1  col2 level x_y is_one is_two
1    1 One_X   One   X   TRUE  FALSE
2    2 One_Y   One   Y   TRUE  FALSE
3    3 Two_X   Two   X  FALSE   TRUE
4    4 Two_Y   Two   Y  FALSE   TRUE</code></pre>
</div>
</div>
</div>
<div id="tabset-48-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-48-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb565"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb565-1"><a href="#cb565-1" aria-hidden="true" tabindex="-1"></a>mydt <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(mydf) </span>
<span id="cb565-2"><a href="#cb565-2" aria-hidden="true" tabindex="-1"></a>mydt[, <span class="fu">c</span>(<span class="st">"is_one"</span>, <span class="st">"is_two"</span>) <span class="sc">:</span><span class="er">=</span> .(<span class="fu">grepl</span>(<span class="st">"^One"</span>, col2), <span class="fu">grepl</span>(<span class="st">"^Two"</span>, col2))]</span>
<span id="cb565-3"><a href="#cb565-3" aria-hidden="true" tabindex="-1"></a>mydt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    col1   col2  level    x_y is_one is_two
   &lt;int&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;lgcl&gt; &lt;lgcl&gt;
1:     1  One_X    One      X   TRUE  FALSE
2:     2  One_Y    One      Y   TRUE  FALSE
3:     3  Two_X    Two      X  FALSE   TRUE
4:     4  Two_Y    Two      Y  FALSE   TRUE</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="check-if-string-values-end-with-a-substring" class="level3" data-number="2.16.3">
<h3 data-number="2.16.3" class="anchored" data-anchor-id="check-if-string-values-end-with-a-substring"><span class="header-section-number">2.16.3</span> Check if string values end with a substring</h3>
<p>The <code>str$ends_with()</code> method can be used to check if string values start with a substring. It returns a <strong>Boolean</strong>.</p>
<p>Let’s see an example where we filter the lines of a <code>DataFrame</code> based on the start of a character string:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-49-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-49-1" role="tab" aria-controls="tabset-49-1" aria-selected="true">polars</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-49-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-49-2" role="tab" aria-controls="tabset-49-2" aria-selected="false">R base</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-49-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-49-3" role="tab" aria-controls="tabset-49-3" aria-selected="false">dplyr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-49-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-49-4" role="tab" aria-controls="tabset-49-4" aria-selected="false">data.table</a></li></ul>
<div class="tab-content">
<div id="tabset-49-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-49-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb567"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb567-1"><a href="#cb567-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_polars_df</span>(mydf)<span class="sc">$</span><span class="fu">filter</span>(</span>
<span id="cb567-2"><a href="#cb567-2" aria-hidden="true" tabindex="-1"></a>  pl<span class="sc">$</span><span class="fu">col</span>(<span class="st">"col2"</span>)<span class="sc">$</span>str<span class="sc">$</span><span class="fu">ends_with</span>(<span class="st">"X"</span>)</span>
<span id="cb567-3"><a href="#cb567-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (2, 6)
┌──────┬───────┬───────┬─────┬────────┬────────┐
│ col1 ┆ col2  ┆ level ┆ x_y ┆ is_one ┆ is_two │
│ ---  ┆ ---   ┆ ---   ┆ --- ┆ ---    ┆ ---    │
│ i32  ┆ str   ┆ str   ┆ str ┆ bool   ┆ bool   │
╞══════╪═══════╪═══════╪═════╪════════╪════════╡
│ 1    ┆ One_X ┆ One   ┆ X   ┆ true   ┆ false  │
│ 3    ┆ Two_X ┆ Two   ┆ X   ┆ false  ┆ true   │
└──────┴───────┴───────┴─────┴────────┴────────┘</code></pre>
</div>
</div>
</div>
<div id="tabset-49-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-49-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb569"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb569-1"><a href="#cb569-1" aria-hidden="true" tabindex="-1"></a>mydf[<span class="fu">substr</span>(mydf<span class="sc">$</span>col2, <span class="fu">nchar</span>(mydf<span class="sc">$</span>col2), <span class="fu">nchar</span>(mydf<span class="sc">$</span>col2)) <span class="sc">==</span> <span class="st">"X"</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  col1  col2 level x_y is_one is_two
1    1 One_X   One   X   TRUE  FALSE
3    3 Two_X   Two   X  FALSE   TRUE</code></pre>
</div>
</div>
</div>
<div id="tabset-49-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-49-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb571"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb571-1"><a href="#cb571-1" aria-hidden="true" tabindex="-1"></a>mydf <span class="sc">|&gt;</span></span>
<span id="cb571-2"><a href="#cb571-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">endsWith</span>(col2, <span class="st">"X"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  col1  col2 level x_y is_one is_two
1    1 One_X   One   X   TRUE  FALSE
2    3 Two_X   Two   X  FALSE   TRUE</code></pre>
</div>
</div>
</div>
<div id="tabset-49-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-49-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb573"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb573-1"><a href="#cb573-1" aria-hidden="true" tabindex="-1"></a>mydt <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(mydf) </span>
<span id="cb573-2"><a href="#cb573-2" aria-hidden="true" tabindex="-1"></a>mydt[<span class="fu">substr</span>(col2, <span class="fu">nchar</span>(col2), <span class="fu">nchar</span>(col2)) <span class="sc">==</span> <span class="st">"X"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    col1   col2  level    x_y is_one is_two
   &lt;int&gt; &lt;char&gt; &lt;char&gt; &lt;char&gt; &lt;lgcl&gt; &lt;lgcl&gt;
1:     1  One_X    One      X   TRUE  FALSE
2:     3  Two_X    Two      X  FALSE   TRUE</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="create-your-methods" class="level2" data-number="2.17">
<h2 data-number="2.17" class="anchored" data-anchor-id="create-your-methods"><span class="header-section-number">2.17</span> Create your methods</h2>
<p>With <code>R</code> you can create your own method/function with <code>function()</code>.<br>
Let’s try to create a R function to captue some <code>DataFrame</code> transformations.</p>
<p>Our simple function:<br>
- Takes a <code>DataFrame</code> as an input (argument <code>data</code>)<br>
- Convert Categorical columns into Strings<br>
- Make all Strings columns uppercase<br>
- And filter only the third first rows</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb575"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb575-1"><a href="#cb575-1" aria-hidden="true" tabindex="-1"></a>fn_transformation <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb575-2"><a href="#cb575-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb575-3"><a href="#cb575-3" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span></span>
<span id="cb575-4"><a href="#cb575-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert Integer columns into Float </span></span>
<span id="cb575-5"><a href="#cb575-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">with_columns</span>(</span>
<span id="cb575-6"><a href="#cb575-6" aria-hidden="true" tabindex="-1"></a>      pl<span class="sc">$</span><span class="fu">col</span>(pl<span class="sc">$</span>Int32)<span class="sc">$</span><span class="fu">cast</span>(pl<span class="sc">$</span>Float64))<span class="sc">$</span></span>
<span id="cb575-7"><a href="#cb575-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Make all Strings columns uppercase</span></span>
<span id="cb575-8"><a href="#cb575-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">with_columns</span>(</span>
<span id="cb575-9"><a href="#cb575-9" aria-hidden="true" tabindex="-1"></a>      pl<span class="sc">$</span><span class="fu">col</span>(pl<span class="sc">$</span>String)<span class="sc">$</span>str<span class="sc">$</span><span class="fu">to_uppercase</span>())<span class="sc">$</span></span>
<span id="cb575-10"><a href="#cb575-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filter only the third first rows</span></span>
<span id="cb575-11"><a href="#cb575-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>(<span class="dv">3</span>)</span>
<span id="cb575-12"><a href="#cb575-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb575-13"><a href="#cb575-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s apply our method to <code>as_polars_df(iris)</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb576"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb576-1"><a href="#cb576-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fn_transformation</span>(<span class="fu">as_polars_df</span>(mydf))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 6)
┌──────┬───────┬───────┬─────┬────────┬────────┐
│ col1 ┆ col2  ┆ level ┆ x_y ┆ is_one ┆ is_two │
│ ---  ┆ ---   ┆ ---   ┆ --- ┆ ---    ┆ ---    │
│ f64  ┆ str   ┆ str   ┆ str ┆ bool   ┆ bool   │
╞══════╪═══════╪═══════╪═════╪════════╪════════╡
│ 1.0  ┆ ONE_X ┆ ONE   ┆ X   ┆ true   ┆ false  │
│ 2.0  ┆ ONE_Y ┆ ONE   ┆ Y   ┆ true   ┆ false  │
│ 3.0  ┆ TWO_X ┆ TWO   ┆ X   ┆ false  ┆ true   │
└──────┴───────┴───────┴─────┴────────┴────────┘</code></pre>
</div>
</div>
<p>Our method <code>fn_transformation()</code> can now be re-used multiple times for example on another datasets:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb578"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb578-1"><a href="#cb578-1" aria-hidden="true" tabindex="-1"></a>Newdf <span class="ot">&lt;-</span> pl<span class="sc">$</span><span class="fu">DataFrame</span>(</span>
<span id="cb578-2"><a href="#cb578-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_categ =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"a"</span>,<span class="st">"b"</span>,<span class="st">"c"</span>)),</span>
<span id="cb578-3"><a href="#cb578-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_str =</span> <span class="fu">c</span>(<span class="st">"x"</span>,<span class="st">"y"</span>,<span class="st">"z"</span>),</span>
<span id="cb578-4"><a href="#cb578-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_num =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb578-5"><a href="#cb578-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb578-6"><a href="#cb578-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb578-7"><a href="#cb578-7" aria-hidden="true" tabindex="-1"></a><span class="fu">fn_transformation</span>(Newdf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape: (3, 3)
┌───────────┬─────────┬─────────┐
│ col_categ ┆ col_str ┆ col_num │
│ ---       ┆ ---     ┆ ---     │
│ cat       ┆ str     ┆ f64     │
╞═══════════╪═════════╪═════════╡
│ a         ┆ X       ┆ 1.0     │
│ b         ┆ Y       ┆ 2.0     │
│ c         ┆ Z       ┆ 3.0     │
└───────────┴─────────┴─────────┘</code></pre>
</div>
</div>
<p>Of course, in real life, we will create functions that are more complicated than our example.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./first_steps.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">First steps with Polars</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./import_export.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Import/Export</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>